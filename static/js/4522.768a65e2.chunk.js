"use strict";(self.webpackChunkn2_depot=self.webpackChunkn2_depot||[]).push([[1509,4522,8067],{10294:(e,t,r)=>{r.d(t,{S:()=>a});var s=r(15941),n=r(31633),i=r(20664),o=r(13927);function a(e,t,r){const a=function(e,t,r,s){const a=(e=>!Array.isArray(e[0]))(t)?(e,r)=>t[3*e+r]:(e,r)=>t[e][r],l=s?(0,n.GA)(s)/(0,n.G9)(s):1;return(0,o.lU)(e,(e,t)=>(0,i.j)(e,a(t,0)*l,a(t,1)*l,a(t,2)),r)}(l,e,t,r)?(0,o.Qj)(l):[0,0,1];return Math.abs(a[2])>Math.cos((0,s.kU)(80))?2:Math.abs(a[1])>Math.abs(a[0])?1:0}const l=(0,o.vt)()},29889:(e,t,r)=>{r.d(t,{A:()=>c,C:()=>l});var s=r(45308),n=r(44815),i=r(99785),o=r(67425),a=r(1599);function l(e,t,r,s){const a="polygon"===e.type?1:0,l="polygon"===e.type?e.rings:e.paths,{position:c,outlines:h}=(0,i.oR)(l,!!e.hasZ,a,e.spatialReference),d=(0,n.jh)(c.length),p=(0,o.au)(c,e.spatialReference,0,d,0,c,0,c.length/3,t,r,s),f=null!=p;return{lines:f?u(h,c,d):[],projectionSuccess:f,sampledElevation:p}}function c(e,t){const r="polygon"===e.type?1:0,n="polygon"===e.type?e.rings:e.paths,{position:o,outlines:l}=(0,i.oR)(n,!1,r),c=(0,s.projectBuffer)(o,e.spatialReference,0,o,t,0);for(let s=2;s<o.length;s+=3)o[s]=a.bi;return{lines:c?u(l,o):[],projectionSuccess:c}}function u(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const s=new Array;for(const{index:i,count:o}of e){if(o<=1)continue;const e=3*i,a=3*o;s.push({position:(0,n.l5)(t,3*i,3*o),mapPositions:null!=r?(0,n.l5)(r,e,a):void 0})}return s}},38983:(e,t,r)=>{function s(e,t,r){r=r||2;var s,i,a,l,c,u,d,p=t&&t.length,f=p?t[0]*r:e.length,v=n(e,0,f,r,!0),m=[];if(!v||v.next===v.prev)return m;if(p&&(v=h(e,t,v,r)),e.length>80*r){s=a=e[0],i=l=e[1];for(var y=r;y<f;y+=r)(c=e[y])<s&&(s=c),(u=e[y+1])<i&&(i=u),c>a&&(a=c),u>l&&(l=u);d=0!==(d=Math.max(a-s,l-i))?1/d:0}return o(v,m,r,s,i,d),m}function n(e,t,r,s,n){var i,o;if(n===D(e,t,r,s)>0)for(i=t;i<r;i+=s)o=O(i,e[i],e[i+1],o);else for(i=r-s;i>=t;i-=s)o=O(i,e[i],e[i+1],o);if(o&&R(o,o.next)){var a=o.next;P(o),o=a}return o}function i(e,t){if(!e)return e;t||(t=e);var r,s=e;do{if(r=!1,s.steiner||!R(s,s.next)&&0!==w(s.prev,s,s.next))s=s.next;else{var n=s.prev;if(P(s),(s=t=n)===s.next)break;r=!0}}while(r||s!==t);return t}function o(e,t,r,s,n,h,d){if(e){!d&&h&&m(e,s,n,h);for(var p,f,v=e;e.prev!==e.next;)if(p=e.prev,f=e.next,h?l(e,s,n,h):a(e))t.push(p.i/r),t.push(e.i/r),t.push(f.i/r),P(e),e=f.next,v=f.next;else if((e=f)===v){d?1===d?o(e=c(i(e),t,r),t,r,s,n,h,2):2===d&&u(e,t,r,s,n,h):o(i(e),t,r,s,n,h,1);break}}}function a(e){var t=e.prev,r=e,s=e.next;if(w(t,r,s)>=0)return!1;for(var n=e.next.next;n!==e.prev;){if(g(t.x,t.y,r.x,r.y,s.x,s.y,n.x,n.y)&&w(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function l(e,t,r,s){var n=e.prev,i=e,o=e.next;if(w(n,i,o)>=0)return!1;for(var a=n.x<i.x?n.x<o.x?n.x:o.x:i.x<o.x?i.x:o.x,l=n.y<i.y?n.y<o.y?n.y:o.y:i.y<o.y?i.y:o.y,c=n.x>i.x?n.x>o.x?n.x:o.x:i.x>o.x?i.x:o.x,u=n.y>i.y?n.y>o.y?n.y:o.y:i.y>o.y?i.y:o.y,h=y(a,l,t,r,s),d=y(c,u,t,r,s),p=e.prevZ,f=e.nextZ;p&&p.z>=h&&f&&f.z<=d;){if(p!==e.prev&&p!==e.next&&g(n.x,n.y,i.x,i.y,o.x,o.y,p.x,p.y)&&w(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,f!==e.prev&&f!==e.next&&g(n.x,n.y,i.x,i.y,o.x,o.y,f.x,f.y)&&w(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(;p&&p.z>=h;){if(p!==e.prev&&p!==e.next&&g(n.x,n.y,i.x,i.y,o.x,o.y,p.x,p.y)&&w(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;f&&f.z<=d;){if(f!==e.prev&&f!==e.next&&g(n.x,n.y,i.x,i.y,o.x,o.y,f.x,f.y)&&w(f.prev,f,f.next)>=0)return!1;f=f.nextZ}return!0}function c(e,t,r){var s=e;do{var n=s.prev,o=s.next.next;!R(n,o)&&A(n,s,s.next,o)&&M(n,o)&&M(o,n)&&(t.push(n.i/r),t.push(s.i/r),t.push(o.i/r),P(s),P(s.next),s=e=o),s=s.next}while(s!==e);return i(s)}function u(e,t,r,s,n,a){var l=e;do{for(var c=l.next.next;c!==l.prev;){if(l.i!==c.i&&x(l,c)){var u=G(l,c);return l=i(l,l.next),u=i(u,u.next),o(l,t,r,s,n,a),void o(u,t,r,s,n,a)}c=c.next}l=l.next}while(l!==e)}function h(e,t,r,s){var o,a,l,c=[];for(o=0,a=t.length;o<a;o++)(l=n(e,t[o]*s,o<a-1?t[o+1]*s:e.length,s,!1))===l.next&&(l.steiner=!0),c.push(_(l));for(c.sort(d),o=0;o<c.length;o++)r=i(r=f(c[o],r),r.next);return r}function d(e,t){return e.x-t.x}function p(e){if(e.next.prev===e)return e;let t=e;for(;;){const r=t.next;if(r.prev===t||r===t||r===e)break;t=r}return t}function f(e,t){var r=function(e,t){var r,s=t,n=e.x,i=e.y,o=-1/0;do{if(i<=s.y&&i>=s.next.y&&s.next.y!==s.y){var a=s.x+(i-s.y)*(s.next.x-s.x)/(s.next.y-s.y);if(a<=n&&a>o){if(o=a,a===n){if(i===s.y)return s;if(i===s.next.y)return s.next}r=s.x<s.next.x?s:s.next}}s=s.next}while(s!==t);if(!r)return null;if(n===o)return r;var l,c=r,u=r.x,h=r.y,d=1/0;s=r;do{n>=s.x&&s.x>=u&&n!==s.x&&g(i<h?n:o,i,u,h,i<h?o:n,i,s.x,s.y)&&(l=Math.abs(i-s.y)/(n-s.x),M(s,e)&&(l<d||l===d&&(s.x>r.x||s.x===r.x&&v(r,s)))&&(r=s,d=l)),s=s.next}while(s!==c);return r}(e,t);if(!r)return t;var s=G(r,e),n=i(r,r.next);let o=p(s);return i(o,o.next),n=p(n),p(t===r?n:t)}function v(e,t){return w(e.prev,e,t.prev)<0&&w(t.next,e,e.next)<0}function m(e,t,r,s){var n=e;do{null===n.z&&(n.z=y(n.x,n.y,t,r,s)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==e);n.prevZ.nextZ=null,n.prevZ=null,function(e){var t,r,s,n,i,o,a,l,c=1;do{for(r=e,e=null,i=null,o=0;r;){for(o++,s=r,a=0,t=0;t<c&&(a++,s=s.nextZ);t++);for(l=c;a>0||l>0&&s;)0!==a&&(0===l||!s||r.z<=s.z)?(n=r,r=r.nextZ,a--):(n=s,s=s.nextZ,l--),i?i.nextZ=n:e=n,n.prevZ=i,i=n;r=s}i.nextZ=null,c*=2}while(o>1)}(n)}function y(e,t,r,s,n){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*n)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-s)*n)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function _(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function g(e,t,r,s,n,i,o,a){return(n-o)*(t-a)-(e-o)*(i-a)>=0&&(e-o)*(s-a)-(r-o)*(t-a)>=0&&(r-o)*(i-a)-(n-o)*(s-a)>=0}function x(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&A(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&(M(e,t)&&M(t,e)&&function(e,t){var r=e,s=!1,n=(e.x+t.x)/2,i=(e.y+t.y)/2;do{r.y>i!=r.next.y>i&&r.next.y!==r.y&&n<(r.next.x-r.x)*(i-r.y)/(r.next.y-r.y)+r.x&&(s=!s),r=r.next}while(r!==e);return s}(e,t)&&(w(e.prev,e,t.prev)||w(e,t.prev,t))||R(e,t)&&w(e.prev,e,e.next)>0&&w(t.prev,t,t.next)>0)}function w(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function R(e,t){return e.x===t.x&&e.y===t.y}function A(e,t,r,s){var n=C(w(e,t,r)),i=C(w(e,t,s)),o=C(w(r,s,e)),a=C(w(r,s,t));return n!==i&&o!==a||!(0!==n||!b(e,r,t))||!(0!==i||!b(e,s,t))||!(0!==o||!b(r,e,s))||!(0!==a||!b(r,t,s))}function b(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function C(e){return e>0?1:e<0?-1:0}function M(e,t){return w(e.prev,e,e.next)<0?w(e,t,e.next)>=0&&w(e,e.prev,t)>=0:w(e,t,e.prev)<0||w(e,e.next,t)<0}function G(e,t){var r=new E(e.i,e.x,e.y),s=new E(t.i,t.x,t.y),n=e.next,i=t.prev;return e.next=t,t.prev=e,r.next=n,n.prev=r,s.next=r,r.prev=s,i.next=s,s.prev=i,s}function O(e,t,r,s){var n=new E(e,t,r);return s?(n.next=s.next,n.prev=s,s.next.prev=n,s.next=n):(n.prev=n,n.next=n),n}function P(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function E(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function D(e,t,r,s){for(var n=0,i=t,o=r-s;i<r;i+=s)n+=(e[o]-e[i])*(e[i+1]+e[o+1]),o=i;return n}r.d(t,{e:()=>s}),s.deviation=function(e,t,r,s){var n=t&&t.length,i=n?t[0]*r:e.length,o=Math.abs(D(e,0,i,r));if(n)for(var a=0,l=t.length;a<l;a++){var c=t[a]*r,u=a<l-1?t[a+1]*r:e.length;o-=Math.abs(D(e,c,u,r))}var h=0;for(a=0;a<s.length;a+=3){var d=s[a]*r,p=s[a+1]*r,f=s[a+2]*r;h+=Math.abs((e[d]-e[f])*(e[p+1]-e[d+1])-(e[d]-e[p])*(e[f+1]-e[d+1]))}return 0===o&&0===h?0:Math.abs((h-o)/o)},s.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},s=0,n=0;n<e.length;n++){for(var i=0;i<e[n].length;i++)for(var o=0;o<t;o++)r.vertices.push(e[n][i][o]);n>0&&(s+=e[n-1].length,r.holes.push(s))}return r}},40366:(e,t,r)=>{r.d(t,{F:()=>f,a:()=>y,b:()=>v});var s,n,i=r(57528),o=r(34761),a=r(13191),l=r(9392),c=r(86955),u=r(23687),h=r(12216),d=r(31432),p=r(2687);class f extends d.Y{constructor(){super(...arguments),this.origin=l.uY}}function v(){const e=new p.N5;return e.attributes.add("position","vec3"),e.outputs.add("fragColor","vec4",0),e.vertex.uniforms.add(new u.F("proj",e=>e.camera.projectionMatrix),new h.S("view",(e,t)=>(0,o.Tl)(m,t.camera.viewMatrix,e.origin))).main.add((0,c.H)(s||(s=(0,i.A)(["gl_Position = proj * view * vec4(position, 1.0);\ngl_Position.z = min(gl_Position.z, gl_Position.w);"])))),e.fragment.main.add((0,c.H)(n||(n=(0,i.A)(["fragColor = vec4(1., 0., 0., 0.);"])))),e}const m=(0,a.vt)(),y=Object.freeze(Object.defineProperty({__proto__:null,FocusAreaMaskDrawParameters:f,build:v},Symbol.toStringTag,{value:"Module"}))},50360:(e,t,r)=>{r.d(t,{Pg:()=>l,fz:()=>c,g7:()=>o,zo:()=>a});var s=r(68707),n=(r(97799),r(63331),r(56175));r(91523);const i=new n.D;function o(e,t,r){return i.execute(e,t,r,null)}function a(e,t,r){const n=i.executeMany(new s.S(e),t,r,null);return Array.from(n)}function l(e,t,r){return i.isSimpleAsFeature(e,t,r,null,null)}function c(){return i.supportsCurves()}},58067:(e,t,r)=>{r.r(t),r.d(t,{fromExtent:()=>x,fromGeometry:()=>g,fromMultipoint:()=>w,fromPoint:()=>R,fromPolygon:()=>A,fromPolyline:()=>b,fromSpatialReference:()=>C,getSpatialReference:()=>_,toExtent:()=>G,toGeometry:()=>M,toMultipoint:()=>O,toPoint:()=>P,toPolygon:()=>E,toPolyline:()=>D});var s=r(89379),n=r(26871),i=(r(21557),r(97799)),o=r(91523),a=r(63331),l=r(56175),c=r(76797),u=r(66388),h=r(19247),d=r(65215),p=r(23701),f=(r(59739),r(48045));const v="_gxVersion",m=2,y=1;function _(e){return Array.isArray(e)?e[0].spatialReference:e.spatialReference}function g(e){switch(e.type){case"point":return R(e);case"multipoint":return w(e);case"polyline":return b(e);case"polygon":return A(e);case"extent":return x(e);default:throw new Error("Unsupported geometry type: ".concat(e.type))}}function x(e){if(!e.getCacheValue(v)){const t=new o.E;t.setCoords(e.xmin,e.ymin,e.xmax,e.ymax),e.hasM&&t.setInterval(m,0,e.mmin,e.mmax),e.hasZ&&t.setInterval(y,0,e.zmin,e.zmax),e.setCacheValue(v,t)}return e.getCacheValue(v)}function w(e){if(!e.getCacheValue(v)){const s=new a.M,n=new o.P,i=e.points,l=e.hasM,c=e.hasZ,u=c?3:2;for(let e=0,o=i.length;e<o;e++){var t,r;const o=i[e];n.setXYCoords(o[0],o[1]),c&&n.setZ(null!==(t=o[2])&&void 0!==t?t:0),l&&n.setM(null!==(r=o[u])&&void 0!==r?r:NaN),s.add(n)}e.setCacheValue(v,s)}return e.getCacheValue(v)}function R(e){if(!e.getCacheValue(v)){const t=new o.P;t.setXYCoords(e.x,e.y),e.hasM&&t.setM(e.m),e.hasZ&&t.setZ(e.z),e.setCacheValue(v,t)}return e.getCacheValue(v)}function A(e){if(!e.getCacheValue(v)){const{curveRings:t,hasM:r,hasZ:s,rings:n}=e,i=(0,f.fromGeometryToGXGeometry)({curveRings:t,hasM:r,hasZ:s,rings:n});e.setCacheValue(v,i)}return e.getCacheValue(v)}function b(e){if(!e.getCacheValue(v)){const{curvePaths:t,hasM:r,hasZ:s,paths:n}=e,i=(0,f.fromGeometryToGXGeometry)({curvePaths:t,hasM:r,hasZ:s,paths:n});e.setCacheValue(v,i)}return e.getCacheValue(v)}function C(e){if(e.wkid)return(0,l.c)(e.wkid);const t=e.wkt2||e.wkt;return t?(0,l.b)(t):null}function M(e,t){if(e)switch(e.getGeometryType()){case i.G.enumPoint:return P(e,t);case i.G.enumEnvelope:return G(e,t);case i.G.enumMultiPoint:return O(e,t);case i.G.enumPolyline:return D(e,t);case i.G.enumPolygon:return E(e,t)}return null}function G(e,t){if(e.isEmpty())return null;const r=new c.A({xmin:e.getXMin(),ymin:e.getYMin(),xmax:e.getXMax(),ymax:e.getYMax(),spatialReference:t}),s=e.getDescription();if(s.hasM()){const t=e.queryInterval(m,0);r.mmin=t.vmin,r.mmax=t.vmax}if(s.hasZ()){const t=e.queryInterval(y,0);r.zmin=t.vmin,r.zmax=t.vmax}return r.setCacheValue(v,e),r}function O(e,t){if(e.isEmpty())return null;const r=e.getDescription(),s=r.hasM(),n=r.hasZ(),i=[],a=new o.P;for(let o=0,c=e.getPointCount();o<c;o++){e.getPointByVal(o,a);const t=[a.getX(),a.getY()];n&&t.push(a.getZ()),s&&t.push(a.getM()),i.push(t)}const l=new u.A({hasM:s,hasZ:n,points:i,spatialReference:t});return l.setCacheValue(v,e),l}function P(e,t){if(e instanceof n.P)return new h.A({x:e.x,y:e.y,spatialReference:t});if(e.isEmpty())return null;const r=new h.A({x:e.getX(),y:e.getY(),spatialReference:t}),s=e.getDescription();return s.hasM()&&(r.m=e.getM()),s.hasZ()&&(r.z=e.getZ()),r.setCacheValue(v,e),r}function E(e,t){if(e.isEmpty())return null;const r=d.A.fromJSON((0,s.A)({spatialReference:t},(0,f.toGeometry)(e,null)));return r.setCacheValue(v,e),r}function D(e,t){if(e.isEmpty())return null;const r=p.A.fromJSON((0,s.A)({spatialReference:t},(0,f.toGeometry)(e,null)));return r.setCacheValue(v,e),r}},68707:(e,t,r)=>{r.d(t,{G:()=>s,S:()=>n});class s{*[Symbol.iterator](){let e=this.next();for(;e;)yield e,e=this.next()}}class n extends s{constructor(e){super(),this.m_iGeom=-1,this.m_aGeoms=e?e.slice():[]}next(){if(this.m_iGeom<this.m_aGeoms.length-1){const e=this.m_aGeoms[++this.m_iGeom];return this.m_aGeoms[this.m_iGeom]=null,e}return null}tock(){return!1}getGeometryID(){return this.m_iGeom}getRank(){return 1}}},73074:(e,t,r)=>{r.d(t,{P:()=>w});var s=r(54099),n=r(20664),i=r(9392),o=r(43047),a=r(55855),l=r(45308),c=r(42294),u=r(44815),h=r(18117),d=r(12482),p=r(731),f=r(85746),v=r(1307),m=r(49296),y=r(70667),_=r(29889),g=r(442),x=r(52479);class w extends f.X{constructor(e){var t;super(e),this._attachmentOrigin=(0,h.TH)(0,0,0,null),this._attachmentOriginDirty=!0,this.events=new s.bk,this._geometry=null,this._width=1,this._color=(0,a.fA)(1,0,1,1),this._innerWidth=0,this._innerColor=(0,a.fA)(1,1,1,1),this._stipplePattern=null,this._stippleOffColor=null,this._falloff=0,this._elevationInfo=null,this._laserlineStyle=null,this._laserlineEnabled=!1,this._renderOccluded=8,this._attachmentOrigin.spatialReference=e.view.spatialReference,this._laserline=new v.o({view:e.view,isDecoration:e.isDecoration}),this.applyProperties(e),this.attached=null===(t=e.attached)||void 0===t||t}destroy(){this._laserline.destroy(),super.destroy()}createObject3DResourceFactory(e){return{view:e,createResources:e=>this._createObject3DResources(e),destroyResources:R,recreateGeometry:(e,t)=>{e.geometries.length=0,this._recreateGeometry(t,e.material,e.geometries)},forEachMaterial:(e,t)=>t(e.material)}}createDrapedResourceFactory(e){return{view:e,createResources:()=>this._createDrapedResources(),destroyResources:R,recreateGeometry:e=>{e.geometries=this._createRenderGeometriesDraped(e.material),this._attachmentOriginChanged()},forEachMaterial:(e,t)=>t(e.material)}}get _laserlineAttached(){return this.attached&&this.visible&&null!=this._laserlineStyle&&!this.isDraped&&this.laserlineEnabled}onAttachedChange(e){this._laserline.attached=this._laserlineAttached,e&&this._attachmentOriginChanged()}get isDecoration(){return this._isDecoration}set isDecoration(e){this._isDecoration=e,this._updateMaterial()}get geometry(){return this._geometry}set geometry(e){const t=this._isClosed;this._geometry=e,this.recreateGeometry(),t!==this._isClosed&&this._updateMaterial()}get width(){return this._width}set width(e){e!==this._width&&(this._width=e,this._updateMaterial())}get color(){return this._color}set color(e){(0,o.a)(e,this._color)||((0,o.d)(this._color,e),this._updateMaterial())}get innerWidth(){return this._innerWidth}set innerWidth(e){e!==this._innerWidth&&(this._innerWidth=e,this._updateMaterial())}get innerColor(){return this._innerColor}set innerColor(e){(0,o.a)(e,this._innerColor)||((0,o.d)(this._innerColor,e),this._updateMaterial())}get stipplePattern(){return this._stipplePattern}set stipplePattern(e){const t=null!=e!=(null!=this._stipplePattern);this._stipplePattern=e,t?this.recreate():this._updateMaterial()}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(e){e&&this._stippleOffColor&&(0,o.a)(e,this._stippleOffColor)||(this._stippleOffColor=e?(0,a.o8)(e):null,this._updateMaterial())}get falloff(){return this._falloff}set falloff(e){e!==this._falloff&&(this._falloff=e,this._updateMaterial())}get elevationInfo(){return this._elevationInfo}set elevationInfo(e){this._elevationInfo=e,this.recreateGeometry()}get laserlineStyle(){return this._laserlineStyle}set laserlineStyle(e){this._laserlineStyle=e,this._laserline.attached=this._laserlineAttached,null!=e&&(this._laserline.style=e)}get laserlineEnabled(){return this._laserlineEnabled}set laserlineEnabled(e){this._laserlineEnabled!==e&&(this._laserlineEnabled=e,this._laserline.attached=this._laserlineAttached)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}get attachmentOrigin(){var e;if(!this._attachmentOriginDirty)return this._attachmentOrigin;const t=null===(e=this.object3dResources.resources)||void 0===e?void 0:e.geometries;if(!t||0===t.length)return null;(0,n.j)(b,0,0,0);let r=0;for(const s of t)s.computeAttachmentOrigin(A)&&((0,n.g)(b,b,A),r++);return 0===r?null:((0,n.h)(b,b,1/r),this.view.renderCoordsHelper.fromRenderCoords(b,this._attachmentOrigin),this._attachmentOriginDirty=!1,this._attachmentOrigin)}_updateMaterial(){var e,t;null!==(e=this.object3dResources.resources)&&void 0!==e&&e.material.setParameters(this._materialParameters),null===(t=this.drapedResources.resources)||void 0===t||t.material.setParameters(this._materialParameters)}get _isClosed(){return null!=this.geometry&&"polygon"===this.geometry.type}get _materialParameters(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,stipplePreferContinuous:!1,isClosed:this._isClosed,falloff:this._falloff,innerColor:this._innerColor,innerWidth:this._innerWidth,join:"round",hasPolygonOffset:!0,renderOccluded:this._normalizedRenderOccluded,isDecoration:this.isDecoration}}get _normalizedRenderOccluded(){return this.isDraped&&8===this._renderOccluded?4:this._renderOccluded}_recreateGeometry(e,t,r){this._createRenderGeometries(t,r);for(const s of r)e.addGeometry(s);this._attachmentOriginChanged()}_attachmentOriginChanged(){this._attachmentOriginDirty=!0,this.events.emit("attachment-origin-changed")}_createObject3DResources(e){const t=new x.W(this._materialParameters,this.view.state.isGlobal),r=new Array;return this._recreateGeometry(e,t,r),{material:t,geometries:r}}_createDrapedResources(){const e=new x.W(this._materialParameters,this.view.state.isGlobal);return{material:e,geometries:this._createRenderGeometriesDraped(e)}}_createRenderGeometriesDraped(e){const{geometry:t,view:r}=this,s=r.basemapTerrain.spatialReference;return null==t||null==s?[]:(0,_.A)(t,s).lines.map(t=>{let{position:n}=t;const i={overlayInfo:{spatialReference:s,renderCoordsHelper:r.renderCoordsHelper},attributeData:{position:n},removeDuplicateStartEnd:this._isClosed};return new g.$((0,y.te)(e,i))})}calculateMapBounds(e){if(null==this.object3dResources.resources)return!1;const t=this.view.renderCoordsHelper;for(const r of this.object3dResources.resources.geometries){const s=r.attributes.get("position"),n=(0,u.jh)(s.data.length);(0,l.projectBuffer)(s.data,t.spatialReference,0,n,this.view.spatialReference,0),(0,c.Hq)(e,n)}return!0}_createRenderGeometries(e,t){var r;const s=this.geometry;if(null==s)return;const n=(0,_.C)(s,this.view.elevationProvider,this.view.renderCoordsHelper,m.F.fromElevationInfo(null!==(r=this.elevationInfo)&&void 0!==r?r:new p.A({mode:(0,d.w7)(s,null)}))),i=new Array;for(const{position:o,mapPositions:a}of n.lines){const r={mapPositions:a,attributeData:{position:o},removeDuplicateStartEnd:this._isClosed};t.push((0,y.te)(e,r)),i.push(o)}this._laserline.pathVerticalPlane=i}}function R(e){e.geometries=[]}const A=(0,i.vt)(),b=(0,i.vt)()},77176:(e,t,r)=>{r.d(t,{b:()=>i});var s=r(15941),n=r(38496);function i(e,t,r){var i;const u=Array.isArray(e),h=u?e.length/t:e.byteLength/(4*t),d=u?e:new Uint32Array(e,0,h*t),p=null!==(i=null===r||void 0===r?void 0:r.minReduction)&&void 0!==i?i:0,f=(null===r||void 0===r?void 0:r.originalIndices)||null,v=f?f.length:0,m=(null===r||void 0===r?void 0:r.componentOffsets)||null;let y=0;if(m)for(let s=0;s<m.length-1;s++){const e=m[s+1]-m[s];e>y&&(y=e)}else y=h;const _=Math.floor(1.1*y)+1;(null==c||c.length<2*_)&&(c=new Uint32Array((0,s.cU)(2*_)));for(let s=0;s<2*_;s++)c[s]=0;let g=0;const x=!!m&&!!f,w=x?v:h;let R=(0,n.my)(h);const A=new Uint32Array(v),b=1.96;let C=0!==p?Math.ceil(4*b*b/(p*p)*p*(1-p)):w,M=1,G=m?m[1]:w;for(let s=0;s<w;s++){if(s===C){const e=1-g/s;if(e+b*Math.sqrt(e*(1-e)/s)<p)return null;C*=2}if(s===G){for(let e=0;e<2*_;e++)c[e]=0;if(f)for(let e=m[M-1];e<m[M];e++)A[e]=R[f[e]];G=m[++M]}const e=x?f[s]:s,r=e*t,n=l(d,r,t);let i=n%_,a=g;for(;0!==c[2*i+1];){if(c[2*i]===n){const e=c[2*i+1]-1;if(o(d,r,e*t,t)){a=R[e];break}}i++,i>=_&&(i-=_)}a===g&&(c[2*i]=n,c[2*i+1]=e+1,g++),R[e]=a}if(0!==p&&1-g/h<p)return null;if(x){for(let e=m[M-1];e<A.length;e++)A[e]=R[f[e]];R=(0,n.uW)(A)}const O=u?new Array(g):new Uint32Array(g*t);g=0;for(let s=0;s<w;s++)R[s]===g&&(a(d,(x?f[s]:s)*t,O,g*t,t),g++);if(f&&!x){const e=new Uint32Array(v);for(let t=0;t<e.length;t++)e[t]=R[f[t]];R=(0,n.uW)(e)}return{buffer:Array.isArray(O)?O:O.buffer,indices:R,uniqueCount:g}}function o(e,t,r,s){for(let n=0;n<s;n++)if(e[t+n]!==e[r+n])return!1;return!0}function a(e,t,r,s,n){for(let i=0;i<n;i++)r[s+i]=e[t+i]}function l(e,t,r){let s=0;for(let n=0;n<r;n++)s=e[t+n]+s|0,s=s+(s<<11)+(s>>>2)|0;return s>>>0}let c=null},80069:(e,t,r)=>{r.d(t,{F:()=>p,a:()=>v,b:()=>f});var s,n=r(57528),i=r(75540),o=r(73398),a=r(21390),l=r(86955),c=r(72790),u=r(70367),h=r(31432),d=r(2687);class p extends h.Y{constructor(){super(...arguments),this.effect=0,this.fadeFactor=(0,i.v)(1)}}function f(){const e=new d.N5;return e.include(o.c),e.outputs.add("fragColor","vec4",0),e.fragment.uniforms.add(new u.N("colorTexture",e=>e.color),new u.N("focusArea",e=>e.focusArea),new c.c("focusAreaEffectMode",e=>e.effect),new a.m("fadeFactor",e=>e.fadeFactor.value)).main.add((0,l.H)(s||(s=(0,n.A)(["\n      float mask = texture( focusArea, uv, 0.0 ).r;\n      vec4 color = texture( colorTexture, uv, 0.0 );\n      vec4 colorDeSaturate = vec4(color.r * 0.25 + color.g * 0.5 + color.b * 0.25);\n      if (focusAreaEffectMode == ",") {\n        fragColor = mask > 0.0 ? color : mix(color, 0.55 * colorDeSaturate + 0.45, fadeFactor);\n      } else {\n        fragColor = mask > 0.0 ? color : mix(color, 0.33 * color, fadeFactor);\n      }\n  "])),l.H.int(0))),e}const v=Object.freeze(Object.defineProperty({__proto__:null,FocusAreaColorPassParameters:p,build:f},Symbol.toStringTag,{value:"Module"}))},83457:(e,t,r)=>{r.d(t,{fz:()=>a,g7:()=>i,zo:()=>o});var s=r(68707);const n=new(r(20265).O);function i(e,t,r,s){return n.execute(e,t,r,s,null)}function o(e,t,r,i){const o=n.executeMany(new s.S(e),t,r,i,null);return Array.from(o)}function a(){return n.supportsCurves()}},85746:(e,t,r)=>{r.d(t,{X:()=>v});var s=r(6326),n=r(91967),i=r(5632),o=r(46053),a=(r(81806),r(76460),r(47249),r(87990));class l{constructor(e){this._resourceFactory=e,this._resources=null,this._visible=!0,this._attached=!1,this._renderGroup=2}destroy(){this._destroyResources()}get resources(){var e;return null===(e=this._resources)||void 0===e?void 0:e.external}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this._syncGeometriesToRenderer())}get attached(){return this._attached}set attached(e){e!==this._attached&&(this._attached=e,this._createOrDestroyResources())}get renderGroup(){return this._renderGroup}set renderGroup(e){var t;this._renderGroup=e;const r=null===(t=this._resources)||void 0===t?void 0:t.layerView;r&&(r.renderGroup=e)}recreate(){this.attached&&this._createResources()}recreateGeometry(){this._resourceFactory.recreateGeometry?null!=this._resources&&(this._ensureRenderGeometriesRemoved(),this._resourceFactory.recreateGeometry(this._resources.external),this._syncGeometriesToRenderer()):this.recreate()}forEachMaterial(e){this._resources&&this._resourceFactory.forEachMaterial(this._resources.external,e)}_createOrDestroyResources(){this._attached?null==this._resources&&this._createResources():this._destroyResources()}_createResources(){this._destroyResources();const e=this._resourceFactory.createResources(),t=new c({view:this._resourceFactory.view,renderGroup:this._renderGroup}),r=this._resourceFactory.view.overlayManager;this._resources={layerView:t,external:e,geometriesAdded:!1},r&&(this._resources.drapeSourceRenderer=r.registerGeometryDrapeSource(t)),this._syncGeometriesToRenderer()}_destroyResources(){if(null==this._resources)return;this._ensureRenderGeometriesRemoved();const e=this._resourceFactory.view.overlayManager;e&&e.unregisterDrapeSource(this._resources.layerView),this._resourceFactory.destroyResources(this._resources.external),this._resources=null}_syncGeometriesToRenderer(){this._visible?this._ensureRenderGeometriesAdded():this._ensureRenderGeometriesRemoved()}_ensureRenderGeometriesRemoved(){var e;null!=(null===(e=this._resources)||void 0===e?void 0:e.drapeSourceRenderer)&&this._resources.geometriesAdded&&(this._resources.drapeSourceRenderer.removeGeometries(this._resources.external.geometries,1),this._resources.geometriesAdded=!1)}_ensureRenderGeometriesAdded(){var e;null!=(null===(e=this._resources)||void 0===e?void 0:e.drapeSourceRenderer)&&(this._resources.geometriesAdded||(this._resources.drapeSourceRenderer.addGeometries(this._resources.external.geometries,1),this._resources.geometriesAdded=!0))}}let c=class extends((0,i.sA)(n.A)){constructor(e){super(e),this.drapeSourceType=1,this.updatePolicy=1,this.renderGroup=2}};(0,s.Cg)([(0,o.MZ)({constructOnly:!0})],c.prototype,"view",void 0),(0,s.Cg)([(0,o.MZ)({readOnly:!0})],c.prototype,"drapeSourceType",void 0),(0,s.Cg)([(0,o.MZ)()],c.prototype,"renderGroup",void 0),c=(0,s.Cg)([(0,a.$)("esri.views.3d.interactive.visualElements.DrapedVisualElementResources")],c);var u=r(69230),h=r(68134),d=r(37046),p=r(8918);class f{constructor(e){this._resourceFactory=e,this._resources=null,this._visible=!0,this._attached=!1}destroy(){this._destroyResources()}get object(){return null!=this._resources?this._resources.object:null}get resources(){return null!=this._resources?this._resources.external:null}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this._syncVisible())}get attached(){return this._attached}set attached(e){e!==this._attached&&(this._attached=e,this._createOrDestroyResources())}recreate(){this.attached&&this._createResources()}recreateGeometry(){if(!this._resourceFactory.recreateGeometry)return void this.recreate();const e=this._resourceFactory.view.stage;if(null==this._resources||!e)return;const t=this._resources.object;t.removeAllGeometries(),this._resourceFactory.recreateGeometry(this._resources.external,t,this._resources.layer)}forEachMaterial(e){this._resources&&this._resourceFactory.forEachMaterial(this._resources.external,e)}_createOrDestroyResources(){this._attached?this._resources||this._createResources():this._destroyResources()}_createResources(){this._destroyResources();const e=this._resourceFactory,t=e.view,r=t.stage;if(!r)return;const s=new p.x(r,{pickable:!1,updatePolicy:1}),n=new d.B({castShadow:!1}),i=e.createResources(n,s);s.add(n);const o=e.cameraChanged,a=o?(0,h.wB)(()=>t.state.camera,e=>o(e),h.Vh):null;this._resources={layer:s,object:n,external:i,cameraHandle:a},this._syncVisible()}_destroyResources(){var e;null!=this._resources&&(this._resources.layer.destroy(),this._resources.object.dispose(),null!==(e=this._resources.cameraHandle)&&void 0!==e&&e.remove(),this._resourceFactory.destroyResources(this._resources.external),this._resources=null)}_syncVisible(){null!=this._resources&&(this._resources.object.visible=this._visible)}}class v extends u.B{constructor(e){var t;super(e),this._isDraped=!1,this.object3dResources=new f(this.createObject3DResourceFactory(e.view)),this.drapedResources=new l(this.createDrapedResourceFactory(e.view)),this.isDraped=null!==(t=e.isDraped)&&void 0!==t&&t}get isDraped(){return this._isDraped}set isDraped(e){e!==this._isDraped&&(this._isDraped=e,this.object3dResources.attached=this.attached&&!e,this.drapedResources.attached=this.attached&&e)}get renderGroup(){return this.drapedResources.renderGroup}set renderGroup(e){this.drapedResources.renderGroup=e}createResources(){this.object3dResources.attached=!this._isDraped,this.drapedResources.attached=this._isDraped}destroyResources(){this.object3dResources.attached=!1,this.drapedResources.attached=!1}recreate(){this.object3dResources.recreate(),this.drapedResources.recreate()}recreateGeometry(){this.object3dResources.recreateGeometry(),this.drapedResources.recreateGeometry()}destroy(){this.object3dResources.destroy(),this.drapedResources.destroy(),super.destroy()}updateVisibility(e){this.object3dResources.visible=e,this.drapedResources.visible=e}forEachMaterial(e){var t,r;null!==(t=this.object3dResources)&&void 0!==t&&t.forEachMaterial(e),null===(r=this.drapedResources)||void 0===r||r.forEachMaterial(e)}}},94522:(e,t,r)=>{r.r(t),r.d(t,{FocusAreasView:()=>te});var s=r(6326),n=r(91967),i=r(18690),o=r(19276),a=r(50076),l=r(76460),c=r(43927),u=r(68134),h=r(31633),d=r(46053),p=(r(81806),r(87990)),f=r(38983),v=r(13191),m=r(9392),y=r(34111),_=r(19247),g=r(56611),x=r(83457),w=r(50360),R=r(58067),A=r(5809),b=r(44815),C=r(14556),M=r(38496),G=r(45136),O=r(49296),P=r(16266),E=r(36423),D=r(87925),S=r(89379),Z=(r(47249),r(90364)),F=r(36451),V=r(80069),j=r(16506),k=r(59246),T=r(11850),z=r(57162);class N extends k.w{constructor(e,t){super(e,t,new j.$(V.a,()=>r.e(1345).then(r.bind(r,81345))),T.Nx)}initializePipeline(){return(0,z.Ey)({colorWrite:z.kn})}}var I=r(93345);let q=class extends F.A{constructor(e){super((0,S.A)((0,S.A)({},e),{},{view:e.focusAreasView.view})),this.consumes={required:[Z.OG.FOCUSAREA_COLOR,Z.OG.FOCUSAREA]},this.produces=Z.OG.FOCUSAREA_COLOR,this._fadeDirection=0,this._passParameters=new V.F}precompile(){this.techniques.precompile(N)}fadeOut(e){this.removeAllHandles(),this._startTime=null,this._fadeDirection=1,this.addHandles((0,u.wB)(()=>this._passParameters.fadeFactor.value,t=>{0===t&&(this.removeAllHandles(),e())})),this.requestRender(2)}render(e){var t,r,s;const n=this.techniques.get(N),i=e.find(e=>{let{name:t}=e;return t===this.produces});if(!n.compiled)return this.requestRender(1),i;const o=this.focusAreasView.style,a=this.bindParameters,l=a.camera,c=l.fullViewport[2],u=l.fullViewport[3];null!==(t=this._startTime)&&void 0!==t||(this._startTime=null===(r=this.view.stage)||void 0===r?void 0:r.renderer.renderContext.time);const h=this.view.qualitySettings.fadeDuration,d=h>0?Math.min(h,(null===(s=this.view.stage)||void 0===s?void 0:s.renderer.renderContext.time)-this._startTime)/h:1,p=e.find(e=>{let{name:t}=e;return t===Z.OG.FOCUSAREA}),f=this.fboCache.acquire(c,u,this.produces),v=this.renderingContext;return v.bindFramebuffer(f.fbo),this._passParameters.color=i.getTexture(),this._passParameters.focusArea=p.getTexture(),this._passParameters.effect=H[o],this._passParameters.fadeFactor.value=0===this._fadeDirection?d:1-d,v.bindTechnique(n,a,this._passParameters),v.screen.draw(),f.attachDepth(i.getAttachment(I.nI)),d<1&&this.requestRender(2),f}};(0,s.Cg)([(0,d.MZ)()],q.prototype,"consumes",void 0),(0,s.Cg)([(0,d.MZ)()],q.prototype,"produces",void 0),(0,s.Cg)([(0,d.MZ)({constructOnly:!0})],q.prototype,"focusAreasView",void 0),q=(0,s.Cg)([(0,p.$)("esri.views.3d.webgl-engine.effects.focusArea.FocusAreaColorNode")],q);const H={bright:0,dark:1};var W=r(40366),U=r(75757);class B extends k.w{constructor(e,t){super(e,t,new j.$(W.a,()=>r.e(5698).then(r.bind(r,55698))),(0,U.Xk)(T.SL))}initializePipeline(){return(0,z.Ey)({colorWrite:z.kn,depthTest:{func:515}})}}var $=r(69008),L=r(31432),X=r(9243);let Y=class extends F.A{constructor(e){super((0,S.A)((0,S.A)({},e),{},{view:e.focusAreasView.view})),this.consumes={required:[Z.hM.TRANSPARENT]},this.produces=Z.OG.FOCUSAREA,this._vaos=new Array,this._counts=new Array,this._origins=new Array,this._maskParameters=new W.F}initialize(){this.updateGeometries()}destroy(){this._vaos.forEach(e=>e.dispose()),this._vaos.length=this._counts.length=this._origins.length=0}precompile(){this.techniques.precompile(B)}render(e){const t=this.techniques.get(B),r=this.bindParameters,s=r.camera,n=s.fullViewport[2],i=s.fullViewport[3];if(!t.compiled||!this._vaos)return void this.requestRender(1);const o=e.find(e=>{let{name:t}=e;return t===Z.hM.TRANSPARENT}),a=this.renderingContext,l=this.fboCache.acquire(n,i,Z.OG.FOCUSAREA,2);this.view.stage.renderer.occludedRequiresStencil?(l.acquireDepth(13),a.blitFramebuffer(o.fbo,l.fbo,256)):l.attachDepth(o.getAttachment(I.nI)),a.bindFramebuffer(l.fbo),a.setClearColor(0,0,0,1),a.clear(17408),a.setViewport(0,0,n,i);const c=a.bindTechnique(t,r);a.setFaceCullingEnabled(!1),a.setStencilTestEnabled(!0),a.setStencilOpSeparate(1028,7680,34055,7680),a.setStencilOpSeparate(1029,7680,34056,7680),a.setDepthWriteEnabled(!1);for(let u=0;u<this._vaos.length;u++){const e=this._vaos[u],t=this._counts[u];this._maskParameters.origin=this._origins[u],c.bindDraw(r,L.m,this._maskParameters),a.bindVAO(e),a.setDepthTestEnabled(!0),a.setStencilWriteMask(255),a.setStencilFunction(519,0,255),a.setColorMask(!1,!1,!1,!1),a.drawArrays(I.WR.TRIANGLES,0,t),a.setDepthTestEnabled(!1),a.setStencilWriteMask(0),a.setStencilFunction(517,0,255),a.setColorMask(!0,!0,!0,!0),a.drawArrays(I.WR.TRIANGLES,0,t)}return l}updateGeometries(){this.view.stage&&(this._vaos.forEach(e=>e.dispose()),this._vaos.length=this._counts.length=this._origins.length=0,this.focusAreasView.volumes.forEach(e=>{const t=new Array;let r=0,s=0;e.geometryVolumes.forEach(e=>{const n=e.indicesBottom;r+=n.length;for(let r=0;r<n.length;r++)t.push(e.positions[3*(n[r]-1)]),t.push(e.positions[3*(n[r]-1)+1]),t.push(e.positions[3*(n[r]-1)+2]);const i=e.indicesExtruded;s+=i.length;for(let r=0;r<i.length;r++)t.push(e.positions[3*i[r]]),t.push(e.positions[3*i[r]+1]),t.push(e.positions[3*i[r]+2])});const n=new $.Z(this.renderingContext,new X.R(this.renderingContext,T.SL,new Float32Array(t)));this._vaos.push(n),this._counts.push(r+s),this._origins.push(e.origin)}),this.requestRender(1))}};(0,s.Cg)([(0,d.MZ)()],Y.prototype,"consumes",void 0),(0,s.Cg)([(0,d.MZ)()],Y.prototype,"produces",void 0),(0,s.Cg)([(0,d.MZ)({constructOnly:!0})],Y.prototype,"focusAreasView",void 0),Y=(0,s.Cg)([(0,p.$)("esri.views.3d.webgl-engine.effects.focusArea.FocusAreaMaskNode")],Y);var J=r(69539),Q=r(30726),K=r(73074);let ee=class extends n.A{constructor(e){super(e)}initialize(){this.addHandles([(0,u.wB)(()=>this.area.enabled,()=>this._ensureElement(),u.Vh),(0,u.wB)(()=>{var e;return null===(e=this.area.outline)||void 0===e?void 0:e.color},e=>this._updateColor(e),u.Vh),(0,u.wB)(()=>this.area.geometries,e=>this._updateGeometries(e),u.Vh)])}destroy(){this.removeAllHandles(),this._outlineElement=(0,Q.pR)(this._outlineElement)}_ensureElement(){var e,t,r;this.area.enabled&&null!==(e=this.area.outline)&&void 0!==e&&e.color?null!==(t=this._outlineElement)&&void 0!==t||(this._outlineElement=new K.P({view:this.view,geometry:this._mergePolygons(this.area.geometries),isDraped:!0,attached:!0,isDecoration:!1,color:J.A.toUnitRGBA(null===(r=this.area.outline)||void 0===r?void 0:r.color),renderOccluded:4,width:3})):this._outlineElement=(0,Q.pR)(this._outlineElement)}_updateGeometries(e){this._ensureElement(),this._outlineElement&&(this._outlineElement.geometry=this._mergePolygons(e))}_updateColor(e){this._ensureElement(),this._outlineElement&&e&&(this._outlineElement.color=J.A.toUnitRGBA(e))}_mergePolygons(e){if(!e||0===e.length)return null;const t=e.at(0).clone();return t.rings.length=0,e.forEach(e=>t.rings.push(...e.rings)),t}};(0,s.Cg)([(0,d.MZ)({constructOnly:!0})],ee.prototype,"view",void 0),(0,s.Cg)([(0,d.MZ)({constructOnly:!0})],ee.prototype,"area",void 0),ee=(0,s.Cg)([(0,p.$)("esri.views.3d.webgl-engine.effects.focusArea.FocusAreaOutlineItem")],ee);let te=class extends n.A{constructor(e){super(e),this._volumes=new Map,this._elevationContext=new O.F,this._outlineMap=new o.A}initialize(){this.addHandles([(0,u.wB)(()=>{var e;return{polygons:this.polygons,ready:null===(e=this.view.basemapTerrain)||void 0===e?void 0:e.ready}},e=>{let{polygons:t,ready:r}=e;r&&this._updateVolumes(t)},u.Vh)]),this._outlineMap=(0,c.L)(()=>{var e;return null===(e=this.areas)||void 0===e?void 0:e.areas},e=>new ee({area:e,view:this.view}),{recycleItems:!0})}destroy(){this.removeAllHandles(),this._outlineMap.destroy()}get areas(){var e;return null===(e=this.view.map)||void 0===e?void 0:e.focusAreas}get enabledAreas(){var e,t;return null!==(e=null===(t=this.areas)||void 0===t?void 0:t.areas.toArray().filter(e=>{let{enabled:t}=e;return t}))&&void 0!==e?e:[]}get style(){var e,t;return null!==(e=null===(t=this.areas)||void 0===t?void 0:t.style)&&void 0!==e?e:"bright"}get polygons(){return this.enabledAreas.reduce((e,t)=>e.concat(t.geometries.toArray()),new Array)}containsGeometry(e){if(0===this.polygons.length)return!0;const t=new _.A(e);return this.polygons.some(e=>e.contains(t))}_updateVolumes(e){this._extrude(e),this._ensureRenderNodes()}_extrude(e){var t;if(!this.view.renderCoordsHelper||(0,i.aI)(Array.from(this._volumes.keys()),e))return;const r=this.view.renderCoordsHelper,s=(0,m.vt)(),n=1===r.viewingMode,o=(0,v.vt)(),c=(0,v.vt)(),u=this.view.spatialReference,d=(0,R.fromSpatialReference)(u),p=(0,y.tO)(u).radius/C.$O.radius,_=(0,h.UW)(5e5*p,"meters",u,!0);n||r.worldUpAtPosition([0,0,0],s);const O=new Map;for(const i of e){const e=this._volumes.get(i);if(e)O.set(i,e);else try{var S;const e=u.equals(i.spatialReference)?i:(0,g.project)(i,u),t=Math.max(e.extent.width,e.extent.height),a=(0,h.PQ)(t,u,"meters",!0),l=Math.max(5*a,2e4*p),v=n?p/10:p,m=this._reduceGeometryHeight(e,l,v),y=(0,E.W$)(m);if(null==y)continue;const C=(0,R.fromPolygon)(m),Z=null!==(S=(0,w.g7)(C,d,!1))&&void 0!==S?S:C,F=(0,x.g7)(Z,_,0,0),V=(0,R.toPolygon)(F,u);if(null==V)continue;(0,A.l)(u,[y.x,y.y,0],o,r.spatialReference),c[12]=-o[12],c[13]=-o[13],c[14]=-o[14];const j=(0,D.C8)(V,this.view.elevationProvider,r,this._elevationContext),{polygons:k,mapPositions:T,position:z}=j,N=new Array,I=new re(N,[o[12],o[13],o[14]]);for(const r of k){const e=r.count,t=(0,f.e)(r.mapPositions,r.holeIndices,3);if(0===t.length)continue;const i=t.length,o=6*e,a=o+i,u=(0,b.jh)(3*o),h=(0,M.my)(a),d=(0,M.my)(i);(0,P.K)(z,T,t,r,u,null,null,null,h,d,l,s,n),(0,G.t)(u,u,c);const p=new se(u,d,h,l);N.push(p)}O.set(i,I)}catch(Z){l.A.getLogger(this).error(new a.A("focusareasview:projection-failed","Failed to project focus area geometry to view spatial reference",{geometry:i,error:Z}))}}this._volumes=O,0!==this.volumes.size&&(null===(t=this._maskRenderNode)||void 0===t||t.updateGeometries())}_ensureRenderNodes(){var e,t;if(this.view.stage)if(0===this.volumes.size){const{_maskRenderNode:e,_colorRenderNode:t}=this;this._maskRenderNode=this._colorRenderNode=null,null===t||void 0===t||t.fadeOut(()=>{null!==e&&void 0!==e&&e.destroy(),null===t||void 0===t||t.destroy()})}else null!==(e=this._maskRenderNode)&&void 0!==e||(this._maskRenderNode=new Y({focusAreasView:this})),null!==(t=this._colorRenderNode)&&void 0!==t||(this._colorRenderNode=new q({focusAreasView:this})),this.view.stage.renderView.requestRender()}_reduceGeometryHeight(e,t,r){const s=-12e5*r,n=Math.max(-t/2,s),i=e.rings.map(e=>e.map(e=>[e[0],e[1],n])),o=e.clone();return o.rings=i,o.hasZ=!0,o}get volumes(){return this._volumes}};(0,s.Cg)([(0,d.MZ)()],te.prototype,"_volumes",void 0),(0,s.Cg)([(0,d.MZ)({constructOnly:!0})],te.prototype,"view",void 0),te=(0,s.Cg)([(0,p.$)("esri.views.3d.FocusAreasView")],te);class re{constructor(e,t){this.geometryVolumes=e,this.origin=t}}class se{constructor(e,t,r,s){this.positions=e,this.indicesBottom=t,this.indicesExtruded=r,this.height=s}}},99785:(e,t,r)=>{r.d(t,{lO:()=>c,oR:()=>u});var s=r(38983),n=r(5262),i=r(44815),o=r(38496),a=r(10294),l=r(77176);function c(e){const t=u(e.rings,e.hasZ,1,e.spatialReference),r=new Array;let n=0,a=0;for(const l of t.polygons){const e=l.count,c=l.index,u=(0,i.l5)(t.position,3*c,3*e),h=l.holeIndices.map(e=>e-c),d=(0,o.uW)((0,s.e)(u,h,3));r.push({position:u,faces:d}),n+=u.length,a+=d.length}const c=function(e,t,r){if(1===e.length)return e[0];const s=(0,i.jh)(t),n=new Array(r);let a=0,l=0,c=0;for(const i of e){for(let e=0;e<i.position.length;e++)s[a++]=i.position[e];for(const e of i.faces)n[l++]=e+c;c=a/3}return{position:s,faces:(0,o.uW)(n)}}(r,n,a),h=Array.isArray(c.position)?(0,l.b)(c.position,3,{originalIndices:c.faces}):(0,l.b)(c.position.buffer,6,{originalIndices:c.faces});return c.position=(0,i.xm)(new Float64Array(h.buffer)),c.faces=h.indices,c}function u(e,t,r,s){const n=e.length,o=new Array(n),a=new Array(n),l=new Array(n);let c=0;for(let i=0;i<n;++i)c+=e[i].length;let u=0,p=0,f=0;const v=(0,i.jh)(3*c);let m=0;for(let i=n-1;i>=0;i--){const c=e[i],y=1===r&&d(c,t,s);if(y&&1!==n)o[u++]=c;else{let e=c.length;for(let t=0;t<u;++t)e+=o[t].length;const r={index:m,pathLengths:new Array(u+1),count:e,holeIndices:new Array(u)};r.pathLengths[0]=c.length,c.length>0&&(l[f++]={index:m,count:c.length}),m=y?h(c,c.length-1,-1,v,m,c.length,t):h(c,0,1,v,m,c.length,t);for(let s=0;s<u;++s){const e=o[s];r.holeIndices[s]=m,r.pathLengths[s+1]=e.length,e.length>0&&(l[f++]={index:m,count:e.length}),m=h(e,0,1,v,m,e.length,t)}u=0,r.count>0&&(a[p++]=r)}}for(let i=0;i<u;++i){const e=o[i];e.length>0&&(l[f++]={index:m,count:e.length}),m=h(e,0,1,v,m,e.length,t)}return a.length=p,l.length=f,{position:v,polygons:a,outlines:l}}function h(e,t,r,s,n,i,o){n*=3;for(let a=0;a<i;++a){const i=e[t];s[n++]=i[0],s[n++]=i[1],s[n++]=o&&i[2]?i[2]:0,t+=r}return n/3}function d(e,t,r){if(!t)return!(0,n.$3)(e);const s=e.length-1;switch((0,a.S)(e,s,r)){case 0:return!(0,n.$3)(e,1,2);case 1:return!(0,n.$3)(e,0,2);case 2:return!(0,n.$3)(e,0,1)}}}}]);
//# sourceMappingURL=4522.768a65e2.chunk.js.map