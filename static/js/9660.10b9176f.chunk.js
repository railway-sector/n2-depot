"use strict";(self.webpackChunkn2_depot=self.webpackChunkn2_depot||[]).push([[2274,9660],{10600:(e,t,i)=>{i.d(t,{A:()=>s});var r=i(27106);function s(e){return function(){return new o(e.apply(this,arguments))}}function o(e){var t,i;function s(t,i){try{var n=e[t](i),l=n.value,a=l instanceof r.A;Promise.resolve(a?l.v:l).then(function(i){if(a){var r="return"===t?"return":"next";if(!l.k||i.done)return s(r,i);i=e[r](i).value}o(n.done?"return":"normal",i)},function(e){s("throw",e)})}catch(e){o("throw",e)}}function o(e,r){switch(e){case"return":t.resolve({value:r,done:!0});break;case"throw":t.reject(r);break;default:t.resolve({value:r,done:!1})}(t=t.next)?s(t.key,t.arg):i=null}this._invoke=function(e,r){return new Promise(function(o,n){var l={key:e,arg:r,resolve:o,reject:n,next:null};i?i=i.next=l:(t=i=l,s(e,r))})},"function"!=typeof e.return&&(this.return=void 0)}o.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},o.prototype.next=function(e){return this._invoke("next",e)},o.prototype.throw=function(e){return this._invoke("throw",e)},o.prototype.return=function(e){return this._invoke("return",e)}},14835:(e,t,i)=>{i.d(t,{w:()=>Z});var r=i(53986),s=i(6326),o=i(69539),n=i(91967),l=i(59784),a=i(46053),c=(i(81806),i(76460),i(47249),i(87990)),u=i(35925);const h=["colors"],d=["colors"],p=["colors"],v=["colors"],y=["colors"],g=["colors"],f=.3;function m(e,t){t&&Object.assign(e,t)}class _{constructor(e){this.height=90,this.coneHeight=40,this.coneWidth=23,this.width=3,this.renderOccluded=16,this.color=e.accent}}class w{constructor(e){let{colors:t}=e,i=(0,r.A)(e,h);this.size=11,this.outlineSize=1,this.collisionPadding=9,this.color=t.accent,this.outlineColor=t.outline,this.renderOccluded=16,this.hoverOutlineColor=t.selectedOutline,m(this,i)}applyColor(e){this._apply(this.color,e)}applyOutline(e){this._apply(this.outlineColor,e)}applyHoverOutline(e){this._apply(this.hoverOutlineColor,e)}_apply(e,t){t.setParameters({color:(0,l.QP)(e),renderOccluded:this.renderOccluded})}}class C{constructor(e){let{colors:t}=e,i=(0,r.A)(e,d);this.size=40,this.height=.2,this.offset=.25,this.collisionPadding=2,this.renderOccluded=2,this.minSquaredEdgeLength=900,this.color=(0,l._L)(t.accent,.5),this.hoverColor=t.accent,m(this,i)}applyColor(e){this._apply(this.color,e)}applyHover(e){this._apply(this.hoverColor,e)}_apply(e,t){t.setParameters({color:(0,l.QP)(e),renderOccluded:this.renderOccluded})}}class M{constructor(e){this.vertex=new w({colors:e,color:e.accent,outlineColor:e.outline}),this.edge=new w({colors:e,color:(0,l.Vl)((0,l._L)(e.accent,2/3),.5),outlineColor:(0,l._L)(e.outline,.5),size:8,collisionPadding:8}),this.selected=new w({colors:e,color:e.selected,outlineColor:e.outline}),this.edgeOffset=new C({colors:e})}}class b{constructor(e){let{colors:t}=e,i=(0,r.A)(e,p);this.width=1.5,this.stipplePattern=(0,u.wk)(3.3),this.falloff=0,this.innerWidth=1.5,this.renderOccluded=4,this.color=t.selected,this.stippleOffColor=t.outline,this.innerColor=t.selected,m(this,i)}apply(e){e.color=(0,l.QP)(this.color),e.width=this.width,e.stipplePattern=this.stipplePattern,e.stippleOffColor=(0,l.QP)(this.stippleOffColor),e.falloff=this.falloff,e.innerWidth=this.innerWidth,e.innerColor=(0,l.QP)(this.innerColor),e.renderOccluded=this.renderOccluded}}class R{constructor(e){let{colors:t}=e,i=(0,r.A)(e,v);this.size=4,this.outlineSize=1,this.shape="square",this.color=t.selected,this.outlineColor=t.outline,m(this,i)}apply(e){e.color=(0,l.QP)(this.color),e.size=this.size,e.outlineSize=this.outlineSize,e.outlineColor=(0,l.QP)(this.outlineColor),e.primitive=this.shape}}class x{constructor(e){let{colors:t}=e,i=(0,r.A)(e,y);this.innerWidth=1,this.glowWidth=8,this.glowFalloff=8,this.globalAlpha=f,this.globalAlphaContrastBoost=1.5,this.radius=3,this.innerColor=t.selected,this.glowColor=t.accent,this.heightFillColor=t.accent,m(this,i)}apply(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const i={glowColor:o.A.toUnitRGB(this.glowColor),glowFalloff:this.glowFalloff,glowWidth:this.glowWidth,innerColor:o.A.toUnitRGB(this.innerColor),innerWidth:this.innerWidth,globalAlpha:this.globalAlpha*t*this.glowColor.a,globalAlphaContrastBoost:this.globalAlphaContrastBoost,intersectsLineRadius:this.radius};"style"in e?e.style=i:e.laserlineStyle=i}}class P{constructor(e){this.outline=new b({colors:e,color:e.stippleOff,renderOccluded:8,stippleOffColor:e.stippleOn,innerWidth:0}),this.staged=new b({colors:e,color:e.stippleOn,renderOccluded:8,innerColor:e.stagedSolid,stippleOffColor:e.stippleOff}),this.shadowStyle=new x({colors:e,globalAlpha:f,glowColor:e.accent,glowFalloff:8,glowWidth:8,innerColor:e.selected,innerWidth:1})}}class S{constructor(e){this.outline=new R({colors:e,color:e.selected,outlineColor:e.outline,outlineSize:1,shape:"circle",size:4}),this.shadowStyle=new x({colors:e,globalAlpha:f,glowColor:e.accent,glowFalloff:1.5,glowWidth:6,innerColor:e.selected,innerWidth:1,radius:2})}}class A extends b{constructor(e){let{colors:t}=e,i=(0,r.A)(e,g);super({colors:t}),this.extensionType=2,m(this,i)}}class E{constructor(e){this.laserlineAlphaMultiplier=1.5,this.heightPlaneAngleCutoff=20,this.lineObjects=new P(e),this.pointObjects=new S(e),this.heightPlane=new x({colors:e,globalAlpha:f,glowColor:e.accent,glowFalloff:8,glowWidth:8,innerColor:e.selected,innerWidth:1}),this.heightBox=new x({colors:e,globalAlpha:f,glowColor:e.accent,glowFalloff:8,glowWidth:8,innerColor:e.selected,innerWidth:0,heightFillColor:e.accent}),this.zVerticalLine=new A({colors:e,color:(0,l._L)(e.accent,.5),falloff:2,innerColor:(0,l._L)(e.selected,0),renderOccluded:4,stipplePattern:null,width:5,extensionType:2})}}let Z=class extends n.A{constructor(e){super(e)}get colors(){const e=this.getTheme().accentColor,t=e.a;return{accent:e,contrast:(0,l.bJ)(e),selected:o.A.fromArray([255,255,255,t]),selectedOutline:o.A.fromArray([255,255,255,t]),staged:o.A.fromArray([12,207,255,t]),stagedSolid:o.A.fromArray([12,207,255,1]),outline:o.A.fromArray([0,0,0,.5*t]),stippleOn:o.A.fromArray([255,255,255,1]),stippleOff:o.A.fromArray([0,0,0,.5])}}get visualElements(){return new E(this.colors)}get manipulators(){return new M(this.colors)}get zManipulator(){return new _(this.colors)}};(0,s.Cg)([(0,a.MZ)()],Z.prototype,"colors",null),(0,s.Cg)([(0,a.MZ)()],Z.prototype,"visualElements",null),(0,s.Cg)([(0,a.MZ)()],Z.prototype,"manipulators",null),(0,s.Cg)([(0,a.MZ)()],Z.prototype,"zManipulator",null),(0,s.Cg)([(0,a.MZ)()],Z.prototype,"getTheme",void 0),Z=(0,s.Cg)([(0,c.$)("esri.views.3d.interactive.editingTools.settings")],Z)},19495:(e,t,i)=>{function r(e){var t,i,r,o=2;for("undefined"!=typeof Symbol&&(i=Symbol.asyncIterator,r=Symbol.iterator);o--;){if(i&&null!=(t=e[i]))return t.call(e);if(r&&null!=(t=e[r]))return new s(t.call(e));i="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}function s(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then(function(e){return{value:e,done:t}})}return s=function(e){this.s=e,this.n=e.next},s.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var i=this.s.return;return void 0===i?Promise.resolve({value:e,done:!0}):t(i.apply(this.s,arguments))},throw:function(e){var i=this.s.return;return void 0===i?Promise.reject(e):t(i.apply(this.s,arguments))}},new s(e)}i.d(t,{A:()=>r})},19747:(e,t,i)=>{i.d(t,{c:()=>o});var r=i(31633),s=i(44568);function o(e){var t,i,o,n,l;const a="metric";if(null==e)return a;const c=e.map,u=null!==(t=c&&"portalItem"in c?null===(i=c.portalItem)||void 0===i?void 0:i.portal:null)&&void 0!==t?t:s.A.getDefault();switch(null!==(o=null===(n=u.user)||void 0===n?void 0:n.units)&&void 0!==o?o:u.units){case a:return a;case"english":return"imperial"}return null!==(l=(0,r.jM)(e.spatialReference))&&void 0!==l?l:a}},27106:(e,t,i)=>{function r(e,t){this.v=e,this.k=t}i.d(t,{A:()=>r})},31867:(e,t,i)=>{i.r(t),i.d(t,{default:()=>St});var r=i(6326),s=i(46053),o=(i(81806),i(76460),i(47249),i(87990)),n=i(72205);function l(e,t){let i,r=!1;return function(){for(var s=arguments.length,o=new Array(s),n=0;n<s;n++)o[n]=arguments[n];const l=e.apply(this,o);return r&&void 0!==i&&null!==t&&void 0!==t&&t(i,l)?i:(r=!0,i=l,l)}}var a=i(85361),c=i(53084),u=i(30726),h=i(68134),d=i(31633),p=i(20664),v=i(9392),y=i(34111),g=i(95925),f=i(62078),m=i(88220),_=i(96342),w=i(92690);function C(e){var t,i;return null!==(t=null===e||void 0===e||null===(i=e.map)||void 0===i||null===(i=i.allLayers)||void 0===i?void 0:i.toArray().filter(e=>("graphics"!==e.type||!e.internal)&&e.visible).map(e=>e.uid))&&void 0!==t?t:[]}var M=i(91967),b=i(54901);let R={noDataValue:-5e5,defaultQueryOptions:()=>({noDataValue:R.noDataValue,demResolution:"auto",maximumAutoTileRequests:150,ignoreInvisibleLayers:!0,signal:null}),updateThrottleMillis:100,delayAfterPreviewMillis:500,defaultDemResolution:(0,d.oU)(10,"centimeters","meters"),densificationMaxSamples:3e3,largeChartSamples:1e4,maxTotalSamples:1e5,maxChartRatio:300,minSlopeSampleDistance:10,formatPrecision:1,profileLinesUpdateThrottleMillis:100,hoveredPointsStyle:{size:14,borderStyle:"solid",borderWidth:3,borderColor:"#ffffff",boxShadow:"0px 0px 0px 5px rgba(255,255,255,0.2)"}};function x(){return R}const P={progress:1,hasZ:!1,samples:[],statistics:null,spatialReference:null};var S=i(69098),A=i(56002),E=i(19247),Z=i(89379),D=i(56218),k=i(10600),G=i(18690),T=i(15941),O=i(50346),V=i(66388),I=i(5262),z=i(80963),L=i(50076);class F extends L.A{constructor(e,t,i){super(e,t,i),this.name="unknown",this.name=e}}class U extends F{constructor(){super("too-complex","The input geometry has too many points.")}}class j extends F{constructor(){super("invalid-geometry","The input geometry is invalid.")}}class W extends F{constructor(){super("elevation-query-error","Error querying elevation from provider.")}}class H extends F{constructor(){super("unknown","Unknown error.")}}var q=i(19555),B=i(23701),N=i(56611),$=i(13312),Q=i(7137),J=i(12482);async function X(e,t,r,s,o,n,l){let a,c,u;const h=e.spatialReference,p=h.isGeographic||h.isWebMercator;let v=0;if(!p){const{execute:t}=await i.e(9227).then(i.bind(i,89227));(0,O.Te)(l),v=t(e,{unit:"meters"}),(0,O.Te)(l)}const y=1/(0,d.GA)(s);if(p){await(0,N.initializeProjection)([{source:h,dest:s},{source:h,dest:$.A.WGS84}],l);const i=function(e){return(0,Q.TT)(e.spatialReference)?e:(0,N.project)(e,$.A.WGS84)}(e);a=(0,Q.l1)([i],"meters")[0];const d=Y(a,o);if(ye(e,a,d)>n)throw new U;const p=K(i,t,r);({densifiedPath:c,distances:u}=function(e,t,i){const{hasZ:r}=e;return le(e,t,i,ae,r?he:ue)}(p,d,y)),c=(0,N.project)(c,s)}else{await(0,N.initializeProjection)([{source:h,dest:s}],l),a=v;const i=Y(a,o);if(ye(e,a,i)>n)throw new U;const d=K(e,t,r);({densifiedPath:c,distances:u}=function(e,t,i){const{hasZ:r}=e;return le(e,t,i,ce,r?pe:de)}(d,i,y)),(0,O.Te)(l),c=(0,N.project)(c,s)}return{densifiedPath:c,pathLength:a*y,distances:u}}function Y(e,t){const i=e/t.densificationMaxSamples;return Math.max(t.samplingDistance,i)}function K(e,t,i){if(null==t)return ee(e);const r=e.spatialReference,s=t.mode,o=(0,J.Ze)(t,r);let n=null;switch(i.type){case"2d":n=function(e,t,i){let{hasZ:r}=e;return"absolute-height"===t?r?e=>{let[t,r,s]=e;return[t,r,s+i]}:e=>{let[t,r]=e;return[t,r,i]}:null}(e,s,o);break;case"3d":n=function(e,t,i,r){let{spatialReference:s,hasZ:o}=e,{elevationProvider:n}=r;const l=(e,t,i,r)=>{var o;return null!==(o=null===n||void 0===n?void 0:n.getElevation(e,t,i,s,r))&&void 0!==o?o:0};switch(t){case"on-the-ground":return e=>{let[t,i]=e;return[t,i,l(t,i,0,"ground")]};case"absolute-height":return o?e=>{let[t,r,s]=e;return[t,r,s+i]}:e=>{let[t,r]=e;return[t,r,i]};case"relative-to-ground":return o?e=>{let[t,r,s]=e;return[t,r,s+l(t,r,s,"ground")+i]}:e=>{let[t,r]=e;return[t,r,l(t,r,0,"ground")+i]};case"relative-to-scene":return o?e=>{let[t,r,s]=e;return[t,r,s+l(t,r,s,"scene")+i]}:e=>{let[t,r]=e;return[t,r,l(t,r,0,"scene")+i]};default:return null}}(e,s,o,i)}return null==n?ee(e):new B.A({hasZ:!0,hasM:!1,spatialReference:r,paths:te(e.paths,n)})}function ee(e){return e.hasZ?new B.A({hasZ:!1,hasM:!1,spatialReference:e.spatialReference,paths:te(e.paths,e=>{let[t,i]=e;return[t,i]})}):e}function te(e,t){const i=e.length,r=new Array(i);for(let s=0;s<i;++s){const i=e[s],o=i.length,n=new Array(i.length);r[s]=n;for(let e=0;e<o;++e)n[e]=t(i[e])}return r}function ie(e){return se(e)&&e.paths.some(e=>e.length>1)}function re(e){return function(e){return oe(e)&&se(null===e||void 0===e?void 0:e.geometry)}(e)&&ie(e.geometry)}function se(e){return!oe(e)&&null!=e&&"polyline"===e.type}function oe(e){return null!=e&&"geometry"in e}function ne(e){const t=null===e||void 0===e?void 0:e.layer;return null!=t&&"graphics"===t.type&&t.internal}function le(e,t,i,r,s){const{spatialReference:o,hasZ:n}=e,l={from:null,to:null,distance:0,azimuth:0,reverseAzimuth:0,spatialReference:o,metersPerSR:(0,d.GA)(o)},a=[],c=[];let u=0;for(let h=0;h<e.paths.length;++h){const o=e.paths[h],n=new Array,d=new Array;let p=0;for(let e=1;e<o.length;++e){const a=o[e-1],c=o[e],h=r(l,a,c);let v;for(v=p;v<h.distance&&!(0,T.Io)(v,h.distance);v+=t)n.push(s(h,v)),d.push((u+v)*i);p=v-h.distance,u+=h.distance,n.push(c),d.push(u*i)}a[h]=n,c[h]=d}return{densifiedPath:new B.A({spatialReference:o,hasZ:n,paths:a}),distances:c}}function ae(e,t,i){return e.distance=0,(0,Q._3)(e,t,i,e.spatialReference),e.from=t,e.to=i,e}function ce(e,t,i){return e.from=t,e.to=i,e.distance=(0,q.Io)(i,t)*e.metersPerSR,e}function ue(e,t){let{from:i,azimuth:r,spatialReference:s}=e;return(0,Q.vN)([0,0],i,r,t,s)}function he(e,t){let{from:i,to:r,azimuth:s,distance:o,spatialReference:n}=e;const l=t/o,a=[0,0,(0,T.Cc)(i[2],r[2],l)];return(0,Q.vN)(a,i,s,t,n),a}function de(e,t){let{from:i,to:r,distance:s}=e;return(0,q.Cc)([0,0],i,r,t/s)}function pe(e,t){let{from:i,to:r,distance:s}=e;return(0,p.l)([0,0,0],i,r,t/s)}function ve(e){return e.paths.reduce((e,t)=>e+t.length,0)}function ye(e,t,i){return ve(e)+Math.floor(t/i)+Math.max(0,e.paths.reduce(e=>1+e,0)-1)}function ge(e,t){const i=e.length;if(0===i)return null;const r=e[0],s=r.sampledZ;let o=s,n=s,l=0,a=0,c=null,u=null,h=null!=s?s:0,p=0,v=0,y=null!=s?1:0,g=0,f=0;const m=(0,d.GA)(t),_=(0,d.G9)(t),w=x().minSlopeSampleDistance/m,C=2*w,M=new we,b=new we,R=()=>{S(),M.copy(b),b.reset()},P=(e,t)=>{R(),e>0&&e-M.start<=C&&(e=M.start+w),b.restart(e,t)},S=()=>{if(M.isHole||b.isHole)return;const e=b.avgElevation-M.avgElevation,t=b.start-M.start,i=e*_,r=t*m,s=(0,d.oU)(Math.atan2(i,r),"radians","degrees");s>0?(p+=s,c=me(c,s),g++):s<0&&(v-=s,u=me(u,-s),f++)};null!=r.sampledZ&&P(r.distance,r.sampledZ);for(let d=1;d<i;++d){const t=e[d-1],i=e[d],r=i.sampledZ;if(null==r){b.isHole||R();continue}y++,h+=r,o=fe(o,r),n=me(n,r),b.isHole||i.distance-b.start>=w?P(i.distance,r):b.insert(r);const s=t.sampledZ;if(null!=s){const e=r-s;e>0?l+=e:e<0&&(a-=e)}}return R(),0===y?null:{maxDistance:e[i-1].distance,minElevation:o,maxElevation:n,avgElevation:0===y?null:h/y,elevationGain:l,elevationLoss:a,maxPositiveSlope:c,maxNegativeSlope:u,avgPositiveSlope:0===g?null:p/g,avgNegativeSlope:0===f?null:v/f}}function fe(e,t){return null==t?e:null!=e?Math.min(e,t):t}function me(e,t){return null==t?e:null!=e?Math.max(e,t):t}function _e(e,t){return null!=e&&null!=t?e*t:null}class we{constructor(){this._start=0,this._totalElevation=0,this._sampleCount=0}get avgElevation(){return this._totalElevation/this._sampleCount}get isHole(){return 0===this._sampleCount}get start(){return this._start}copy(e){this._start=e._start,this._sampleCount=e._sampleCount,this._totalElevation=e._totalElevation}reset(){this._start=0,this._sampleCount=0,this._totalElevation=0}restart(e,t){this._start=e,this._sampleCount=1,this._totalElevation=t}insert(e){++this._sampleCount,this._totalElevation+=e}}function Ce(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(e>=t)return i;if(i.push(e),t-e<2)return i;const r=t-1;i.push(r);const s=Me(e+1,r);for(;;){const e=s.next();if(e.done)break;i.push(e.value)}return i}function*Me(e,t){if(e>=t)return;const i=e+Math.floor((t-e)/2);yield i;const r=Me(e,i),s=Me(i+1,t);for(;;){const e=r.next(),t=s.next();if(e.done&&t.done)break;e.done||(yield e.value),t.done||(yield t.value)}}var be=i(27243),Re=i(59752);function xe(){return xe=(0,k.A)(function*(e,t){var i;const{view:r,geometry:s,elevationInfo:o,providers:n,options:l}=e,a=r.spatialReference;if(!a||null==s||!ie(s))throw new j;const c=n.length;if(0===c)return null;const u=Math.round(l.maxTotalSamples/c);if(ve(s)>u)throw new U;const h=yield(0,D.A)(X(s,o,r,a,l,u,t));(0,O.Te)(t);let d=0;const p=new Array(c),v=new Array(c);for(let f=0;f<c;f++){const i=Ze(h);p[f]=i,d+=i.samples.length;const r=(0,Z.A)((0,Z.A)({},e),{},{provider:n[f],result:i,densificationResult:h});v[f]=Pe(r,t)[Symbol.iterator]()}if(d>l.maxTotalSamples)throw new U;const y=yield(0,D.A)(Promise.all(v.map(e=>{const t=e.next();return!0===t.done?Promise.resolve(null):t.value})));(0,O.Te)(t);for(let f=0;f<c;f++)p[f]=y[f];yield p,yield(0,D.A)((0,O.Pl)(null!==(i=e.delayAfterPreview)&&void 0!==i?i:x().delayAfterPreviewMillis,null,t.signal)),(0,O.Te)(t);const g=[];try{let e;do{e=!1;for(let t=0;t<c;t++){const i=v[t].next();!1===i.done&&(g.push({resultPromise:i.value,index:t}),e=!0)}}while(e)}finally{v.forEach(e=>{var t;return null===(t=e.return)||void 0===t?void 0:t.call(e)})}for(const{resultPromise:f,index:m}of g)p[m]=yield(0,D.A)(f),(0,O.Te)(t),yield p;for(const f of p)null!=f&&(f.progress=1);yield p}),xe.apply(this,arguments)}function*Pe(e,t){const{densificationResult:i}=e,r=(0,Z.A)((0,Z.A)({},e),{},{abortOptions:t,densificationResult:i}),s=Ce(0,r.result.samples.length),o=s.slice(0,r.provider.numSamplesForPreview);yield Se(r,o,!0);const n=(0,G.Ho)(s,r.provider.numSamplesPerChunk);for(const l of n)yield Se(r,l,!1)}async function Se(e,t,i){let{densificationResult:r,result:s,provider:o,queue:n,abortOptions:l,cache:a}=e;const{densifiedPath:c,pathLength:u}=r,h=s.spatialReference,{samples:d}=s,p=[];for(let v=0;v<t.length;v++){const e=d[t[v]];p[v]=[...e.coordinate]}try{return await n.push({geometry:new V.A({spatialReference:h,points:p,hasZ:c.hasZ}),provider:o,indices:t,preview:i,result:s,parameters:(0,Z.A)((0,Z.A)({},x().defaultQueryOptions()),{},{minDemResolution:i?Math.round(u/o.numSamplesForPreview):Math.round(u/d.length),cache:a})},l),(0,Z.A)({},s)}catch(Y){return(0,O.zf)(Y)?null:P}}function Ae(e){return new be.F({priority:Re.W6.ELEVATION_PROFILE,concurrency:1,scheduler:e,process:async e=>{(0,O.Te)(e.parameters);try{await async function(e){let{geometry:t,provider:i,indices:r,preview:s,result:o,parameters:n}=e;if(0===r.length)return;const l=(await async function(e,t,i){try{return await e.queryElevation(t,i)}catch(s){throw new W}}(i,t,n)).geometry,{hasZ:a,points:c}=l,u=n.noDataValue,{samples:h}=o;for(let d=0;d<r.length;d++){const e=h[r[d]];if(e.isHole)continue;const t=a?c[d][2]:null;null===t||t===u?e.sampledZ=null:(o.hasZ=!0,e.sampledZ=t),e.sampled=!0}(function(e){const t=e.length-1;let i=0;for(let r=1;r<=t;r++)(e[r].sampled||r===t)&&(Ee(e,i,r),i=r)})(h),o.progress=s?0:o.progress+r.length/h.length,o.statistics=ge(o.samples,o.spatialReference)}(e)}catch(t){(0,O.jH)(t)}}})}function Ee(e,t,i){if(i-t===1)return;const r=e[t],s=r.sampledZ,o=e[i],n=o.sampledZ;if(null==s||null==n){for(let r=t+1;r<i;r++)e[r].sampledZ=null;return}const l=r.distance,a=o.distance-l;for(let c=t+1;c<i;c++){const t=e[c],i=(t.distance-l)/a;t.sampledZ=(0,T.Cc)(s,n,i)}}function Ze(e){let{densifiedPath:t,distances:i}=e;const r=t.spatialReference,s=(0,z.Vp)(r),o=t.paths,n=o.length,l=[];let a=null,c=0;for(let u=0;u<n;u++){const e=o[u],t=e.length,r=i[u];for(let i=0;i<t;i++){const t=e[i],o=r[i];s&&(t[0]=(0,I.N6)(t[0],s.valid[0],s.valid[1])),a&&0===i&&De(l,a,t,c,o),l.push(ke(t,o)),a=t,c=o}}return{progress:0,samples:l,hasZ:!1,statistics:null,spatialReference:r}}function De(e,t,i,r,s){e.push(Ge(t,r)),e.push(Ge(i,s))}function ke(e,t){return{coordinate:e,distance:t,sampledZ:null,sampled:!1,isHole:!1}}function Ge(e,t){return{coordinate:e,distance:t,sampledZ:null,sampled:!0,isHole:!0}}function Te(e){return e>.999999?1:e}function Oe(e,t,i){return null==e?null:(0,d.oU)(e*t,"meters",i)}function Ve(e,t,i){return null==e?null:(0,d.oU)(e*t,"meters",i)}let Ie=class extends S.Pw{constructor(e){super(e),this._getSamplesMemoized=(0,A.B)((e,t)=>function(e,t){if(null==e||null==t)return null;const{samples:i,spatialReference:r}=e,{distance:s,elevation:o}=t,n=(0,d.GA)(r),l=(0,d.G9)(r),a=i.length,c=new Array(a);for(let u=0;u<a;++u){const e=i[u],t=e.sampledZ,r=e.coordinate;c[u]={x:r[0],y:r[1],z:t,distance:Oe(e.distance,n,s),elevation:Ve(t,l,o)}}return c}(e,t)),this._getStatisticsMemoized=(0,A.B)((e,t)=>function(e,t){if(null==e||null==t||null==e.statistics||null==e.spatialReference)return null;const{distance:i,elevation:r}=t,{statistics:s,spatialReference:o}=e,n=(0,d.GA)(o),l=(0,d.G9)(o);return{maxDistance:Oe(s.maxDistance,n,i),minElevation:Ve(s.minElevation,l,r),maxElevation:Ve(s.maxElevation,l,r),avgElevation:Ve(s.avgElevation,l,r),elevationGain:Ve(s.elevationGain,l,r),elevationLoss:Ve(s.elevationLoss,l,r),maxPositiveSlope:s.maxPositiveSlope,maxNegativeSlope:s.maxNegativeSlope,avgPositiveSlope:s.avgPositiveSlope,avgNegativeSlope:s.avgNegativeSlope}}(e,t)),this.rawResult=null}get available(){const{computation:e}=this;return e.profile.enabled&&e.available}get profile(){return this.computation.profile}get progress(){return Te(null!=this.rawResult&&this.computation.profile.enabled?this.rawResult.progress:0)}get samples(){return this._getSamplesMemoized(this.rawResult,this.computation.controller.effectiveDisplayUnits)}get statistics(){return this._getStatisticsMemoized(this.rawResult,this.computation.controller.effectiveDisplayUnits)}get hoveredPoint(){if(!this.computation.profile.enabled)return null;const e=this.computation.controller.analysisViewData.hoveredPosition;if(null==e)return null;const{rawResult:t,samples:i}=this;if(null==i||null==t)return null;const r=i.length;if(0===r)return null;const s=function(e,t,i){if(!e||0===e.length)return;const r=e.length-1,s=e[0];if(t<=i(s))return s;const o=e[r];if(t>=i(o))return o;let n=0,l=0,a=r;for(;n<a;){l=n+Math.floor((a-n)/2);const s=e[l],o=i(s);if(o===t)return s;if(t<o){if(l>0){const r=e[l-1],n=i(r);if(t>n)return t-n>=o-t?s:r}a=l}else{if(l<r){const r=e[l+1],n=i(r);if(t<n)return t-o>=n-t?r:s}n=l+1}}return e[l]}(i,e*i[r-1].distance,e=>e.distance);if(null==s)return null;const{x:o,y:n,z:l}=s;return null==l?null:new E.A({x:o,y:n,z:l,spatialReference:t.spatialReference})}};(0,r.Cg)([(0,s.MZ)()],Ie.prototype,"available",null),(0,r.Cg)([(0,s.MZ)({readOnly:!0})],Ie.prototype,"profile",null),(0,r.Cg)([(0,s.MZ)({readOnly:!0})],Ie.prototype,"progress",null),(0,r.Cg)([(0,s.MZ)()],Ie.prototype,"samples",null),(0,r.Cg)([(0,s.MZ)()],Ie.prototype,"statistics",null),(0,r.Cg)([(0,s.MZ)({constructOnly:!0})],Ie.prototype,"computation",void 0),(0,r.Cg)([(0,s.MZ)()],Ie.prototype,"rawResult",void 0),(0,r.Cg)([(0,s.MZ)()],Ie.prototype,"hoveredPoint",null),Ie=(0,r.Cg)([(0,o.$)("esri.views.analysis.ElevationProfile.ElevationProfileResult")],Ie);let ze=class extends M.A{constructor(e){super(e),this.result=new Ie({computation:this}),this.numSamplesForPreview=30,this.numSamplesPerChunk=200}initialize(){this.addHandles([(0,h.wB)(()=>{const{geometry:e,elevationInfo:t}=this.controller.analysis;return[e,t]},()=>this.onInvalidate(this),h.OH)])}setResult(e){this.result.rawResult=e}clearResult(){this.setResult(null)}get progress(){return this.result.progress}get hoveredPoint(){return this.result.hoveredPoint}get available(){return!0}get minDemResolution(){return x().defaultDemResolution}};(0,r.Cg)([(0,s.MZ)({constructOnly:!0})],ze.prototype,"controller",void 0),(0,r.Cg)([(0,s.MZ)({constructOnly:!0})],ze.prototype,"profile",void 0),(0,r.Cg)([(0,s.MZ)({constructOnly:!0})],ze.prototype,"onInvalidate",void 0),(0,r.Cg)([(0,s.MZ)()],ze.prototype,"result",void 0),(0,r.Cg)([(0,s.MZ)({readOnly:!0})],ze.prototype,"progress",null),(0,r.Cg)([(0,s.MZ)()],ze.prototype,"hoveredPoint",null),(0,r.Cg)([(0,s.MZ)()],ze.prototype,"available",null),(0,r.Cg)([(0,s.MZ)()],ze.prototype,"numSamplesForPreview",void 0),(0,r.Cg)([(0,s.MZ)()],ze.prototype,"numSamplesPerChunk",void 0),(0,r.Cg)([(0,s.MZ)({readOnly:!0})],ze.prototype,"minDemResolution",null),ze=(0,r.Cg)([(0,o.$)("esri.views.analysis.ElevationProfile.ElevationProfileLineComputation")],ze);let Le=class extends ze{constructor(){super(...arguments),this.type="scene",this.numSamplesForPreview=50,this.numSamplesPerChunk=25,this._getStableElevationDependencies=l(()=>{var e;const t=this._view;return t?{view:t,stationary:t.stationary,geometry:null===(e=this.controller)||void 0===e?void 0:e.analysis.geometry,visibleLayerIds:this._getStableLayerIds(),maxIntersectionDistance:this._maxIntersectionDistance,intersectOptions:this._intersectOptions,spatialReference:this._getStableSpatialReference()}:null},c.gh),this._getStableSpatialReference=l(()=>{var e;return null===(e=this._view)||void 0===e?void 0:e.spatialReference},u.CM),this._getStableLayerIds=l(()=>C(this._view),c.gh),this._getStablePointCloudLayers=l(()=>{const e=this._view;return e?e.allLayerViews.toArray().filter(e=>{var t;return"point-cloud"===(null===(t=e.layer)||void 0===t?void 0:t.type)}).map(e=>e.layer):[]},c.gh),this._vecA=(0,v.vt)(),this._vecB=(0,v.vt)(),this._ray=(0,g.vt)()}get minDemResolution(){var e;const t=this._view;if(!t)return null;const i=null===(e=t.pointsOfInterest)||void 0===e||null===(e=e.focus)||void 0===e?void 0:e.worldUnitsPerContentPixel;return null==i?null:i*(0,d.G9)(t.spatialReference)}initialize(){const e=()=>this.onInvalidate(this);return this.addHandles([(0,h.wB)(()=>this._queryElevationDependencies,e,h.OH),this.controller.onElevationChange(e)])}async queryElevation(e,t){let{noDataValue:i,signal:r}=t;const s=this._queryElevationDependencies;if(null==s)throw new Error("".concat(this.declaredClass,": no dependencies"));const o=this._intersector;if(null==o)throw new Error("".concat(this.declaredClass,": no view"));const{intersectOptions:n,view:l,spatialReference:a}=s,c=l.renderCoordsHelper,u=l.sceneIntersectionHelper,h=this._vecA,d=this._vecA,v=this._vecB,y=this._ray;if(!a)return{geometry:e,noDataValue:i};const m=await f.q.fromGeometry(e).project(a,r);if(!m)return{geometry:e,noDataValue:i};const _=m.coordinates,w=_.length;for(let f=0;f<w;++f){var C;const e=_[f];(0,p.j)(v,e.x,e.y,null!==(C=e.z)&&void 0!==C?C:0),c.toRenderCoords(v,a,v),c.setAltitude(h,2e5,v);const t=(0,g.Cr)(h,v,y);u.computeIntersection(t,o,!0,n);const r=Fe(s,o.results.all);r?(r.getIntersectionPoint(d),c.fromRenderCoords(d,d,a),e.z=d[2]):e.z=i}return{geometry:m.export(),noDataValue:i}}get _queryElevationDependencies(){return this._getStableElevationDependencies()}get _intersectOptions(){const e=this._view;if(!e||e.destroyed)return{};const{include:t,exclude:i}=this.profile;return(0,m.ZD)(e,{include:t,exclude:[...this._pointCloudLayers,...(0,a.xZ)(i)?i:i?[i]:[]]})}get _pointCloudLayers(){return this._getStablePointCloudLayers()}get _view(){const e=this.controller.view;return"3d"===e.type?e:null}get _maxIntersectionDistance(){const e=this._view;return null!==e&&void 0!==e&&e.renderCoordsHelper?(0,y.tO)(e.spatialReference).radius/e.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY}get _intersector(){const e=this._view;if(!e)return null;const t=new _.n(e.state.viewingMode),i=t.options;return i.hud=!1,i.invisibleTerrain=!1,i.backfacesTerrain=!1,i.selectionMode=!1,i.store=2,t}};function Fe(e,t){let{intersectOptions:i,maxIntersectionDistance:r,view:s}=e;const o=i.graphics,n=!((null===o||void 0===o||!o.include)&&(null===o||void 0===o||!o.exclude));for(const l of t)if(l.withinDistance(r)){if(n){const e=(0,w.Gy)(l,s);if(null!=e&&!(0,m.tW)(o,e))continue}return l}return null}(0,r.Cg)([(0,s.MZ)({readOnly:!0})],Le.prototype,"minDemResolution",null),(0,r.Cg)([(0,s.MZ)()],Le.prototype,"_queryElevationDependencies",null),(0,r.Cg)([(0,s.MZ)()],Le.prototype,"_intersectOptions",null),(0,r.Cg)([(0,s.MZ)()],Le.prototype,"_pointCloudLayers",null),(0,r.Cg)([(0,s.MZ)()],Le.prototype,"_view",null),(0,r.Cg)([(0,s.MZ)()],Le.prototype,"_maxIntersectionDistance",null),(0,r.Cg)([(0,s.MZ)()],Le.prototype,"_intersector",null),Le=(0,r.Cg)([(0,o.$)("esri.views.3d.analysis.ElevationProfile.ElevationProfileLineSceneComputation")],Le);var Ue=i(43927),je=i(14835),We=i(73074);let He=class extends M.A{constructor(e){super(e),this._visualElementHandle=null}initialize(){this._settings=new je.w({getTheme:()=>this.view.effectiveTheme}),this.addHandles(function(e){return(0,b.vE)([(0,h.wB)(()=>{const{analysis:t,sketchGraphic:i,toolState:r,visible:s}=e.analysisViewData,{geometryVisualizationVisible:o}=t.viewOptions;return{geometryVisualizationVisible:o,geometry:t.geometry,sketchGraphic:i,toolState:r,visible:s}},t=>{let{geometryVisualizationVisible:i,sketchGraphic:r,toolState:s,visible:o}=t;if(e.remove(),o)return i&&null!=r&&"reshaping"!==s&&"sketching"!==s?e.show(r):void 0},h.pc)])}({analysisViewData:this.analysisViewData,remove:()=>this._remove(),show:e=>this._show(e)}))}destroy(){this._remove()}get updating(){return!1}_remove(){this._visualElementHandle=(0,u.xt)(this._visualElementHandle)}_show(e){this._remove();const{view:t}=this,i=new We.P({view:t,geometry:this.analysisViewData.analysis.geometry,attached:!1,renderOccluded:8,isDecoration:!0}),r=[(0,h.wB)(()=>this.analysisViewData.analysis.elevationInfo,e=>{i.elevationInfo=e,i.isDraped="on-the-ground"===(0,J.wF)(!0,e)},h.pc),(0,h.wB)(()=>this.analysisViewData.analysis.geometry,e=>{i.geometry=e}),t.maskOccludee(e),(0,b.DQ)(i)];this._settings.visualElements.lineObjects.outline.apply(i),i.attached=!0,this._visualElementHandle=(0,b.vE)(r)}};(0,r.Cg)([(0,s.MZ)({constructOnly:!0})],He.prototype,"view",void 0),(0,r.Cg)([(0,s.MZ)({constructOnly:!0})],He.prototype,"analysisViewData",void 0),(0,r.Cg)([(0,s.MZ)()],He.prototype,"updating",null),He=(0,r.Cg)([(0,o.$)("esri.views.3d.analysis.ElevationProfile.ElevationProfileGeometryVisualization3D")],He);var qe=i(69539),Be=i(79468),Ne=i(55855),$e=i(48384);let Qe=class extends M.A{constructor(e){super(e),this._updateGeometryThrottled=(0,Be.n)(e=>{if(!e)return;const{samples:t,spatialReference:i}=e,r=null!=t&&t.length>0;this._visualElement.geometry=r?function(e,t){null!==e&&void 0!==e||(e=[]);const i=e.length-1,r=[];let s=[];for(let o=0;o<=i;o++){const{x:t,y:n,z:l}=e[o];null!=l&&s.push([t,n,l]),o!==i&&null!=l||!s.length||(r.push(s),s=[])}return(0,$e.LZ)(r,t,!0)}(t,i):null},x().profileLinesUpdateThrottleMillis)}initialize(){this._visualElement=new We.P({view:this.view,elevationInfo:J.qt,innerWidth:0,innerColor:(0,Ne.fA)(0,0,0,0),width:3,falloff:0,renderOccluded:16,isDecoration:!0}),this.addHandles([(0,h.wB)(()=>{var e;return{color:null===(e=this._result)||void 0===e?void 0:e.computation.profile.color,visible:this._effectiveVisible}},e=>{let{color:t,visible:i}=e;t&&(this._visualElement.color=(0,Ne.ci)(qe.A.toUnitRGBA(t))),this._visualElement.visible=i},h.pc),(0,h.wB)(()=>this.analysisViewData.analysis.geometry,()=>{this._visualElement.geometry=null},h.pc),(0,h.wB)(()=>this._geometryUpdateParameters,e=>this._updateGeometryThrottled(e),h.pc),this._updateGeometryThrottled])}destroy(){this._visualElement.destroy()}get updating(){return this._updateGeometryThrottled.hasPendingUpdates()}get _result(){return this.getResult()}get _effectiveVisible(){const{analysisViewData:e,_result:t}=this;return e.visible&&null!=t&&t.available&&t.computation.profile.viewOptions.lineVisible}get _geometryUpdateParameters(){var e;return this._effectiveVisible&&1!==this.analysisViewData.progress?null:{samples:null===(e=this._result)||void 0===e?void 0:e.samples,spatialReference:this.view.spatialReference}}};(0,r.Cg)([(0,s.MZ)()],Qe.prototype,"view",void 0),(0,r.Cg)([(0,s.MZ)()],Qe.prototype,"analysisViewData",void 0),(0,r.Cg)([(0,s.MZ)()],Qe.prototype,"getResult",void 0),(0,r.Cg)([(0,s.MZ)()],Qe.prototype,"updating",null),(0,r.Cg)([(0,s.MZ)()],Qe.prototype,"_result",null),(0,r.Cg)([(0,s.MZ)()],Qe.prototype,"_effectiveVisible",null),(0,r.Cg)([(0,s.MZ)()],Qe.prototype,"_geometryUpdateParameters",null),Qe=(0,r.Cg)([(0,o.$)("esri.views.3d.analysis.ElevationProfile.ElevationProfileLineVisualization3D")],Qe);var Je=i(19276);let Xe=class extends M.A{constructor(e){super(e),this.position=null,this.color=new qe.A("#ffffff"),this.element=function(){const e=document.createElement("div"),{size:t,borderStyle:i,borderColor:r,borderWidth:s,boxShadow:o}=x().hoveredPointsStyle,{style:n}=e;return n.display="block",n.position="absolute",n.top="0",n.left="0",n.contain="strict",n.boxSizing="border-box",n.width="".concat(t,"px"),n.height="".concat(t,"px"),n.marginTop="-".concat(t/2,"px"),n.marginLeft="-".concat(t/2,"px"),n.border="".concat(i," ").concat(s,"px ").concat(r),n.borderRadius="".concat(t,"px"),n.boxShadow=o,e}()}initialize(){var e;this.addHandles([(0,h.wB)(()=>this._screenLocation,e=>{e&&(this.element.style.transform="translate(".concat(e.x,"px, ").concat(e.y,"px)"))},h.pc),(0,h.wB)(()=>this.color.toCss(),e=>{this.element.style.background=e},h.pc)]),null===(e=this.view.surface)||void 0===e||e.appendChild(this.element)}destroy(){this.element.remove()}get _screenLocation(){const{position:e,view:t}=this;"3d"===t.type?(t.commitProperty("size"),t.commitProperty("camera")):t.commitProperty("center");const i=null===t||void 0===t?void 0:t.spatialReference,r=i?(0,N.projectOrLoad)(e,i).geometry:null;return r&&null!==t&&void 0!==t&&t.ready?t.toScreen(r):null}};(0,r.Cg)([(0,s.MZ)()],Xe.prototype,"position",void 0),(0,r.Cg)([(0,s.MZ)({type:qe.A})],Xe.prototype,"color",void 0),(0,r.Cg)([(0,s.MZ)()],Xe.prototype,"view",void 0),(0,r.Cg)([(0,s.MZ)()],Xe.prototype,"_screenLocation",null),Xe=(0,r.Cg)([(0,o.$)("esri.views.analysis.ElevationProfile.ElevationProfileHoveredPointVisualization")],Xe);let Ye=class extends M.A{constructor(e){super(e),this._hoveredPoints=new Je.A}initialize(){const{analysisViewData:e}=this,{analysis:t}=e;this.addHandles([(0,h.wB)(()=>{const{hoveredPoints:i,visible:r,updating:s}=e;return r?s?null:i.map((e,i)=>{const r=t.profiles.at(i);return!0===(null===r||void 0===r?void 0:r.viewOptions.hoveredPointVisible)&&null!=e?{hoveredPoint:e,color:r.color}:null}).filter(e=>!!e):[]},e=>this._update(e),h.pc),(0,h.wB)(()=>t.geometry,()=>this._update([]),h.pc)])}destroy(){this._hoveredPoints.drain(e=>e.destroy())}get updating(){return!1}_update(e){if(!e)return;const{view:t,_hoveredPoints:i}=this,r=e.length;for(;i.length>r;){var s;null===(s=i.pop())||void 0===s||s.destroy()}for(;i.length<r;){const e=new Xe({view:t});i.push(e)}for(let o=0;o<r;++o){const t=e[o],s=i.at(r-1-o);s.position=t.hoveredPoint,s.color=t.color}}};(0,r.Cg)([(0,s.MZ)()],Ye.prototype,"view",void 0),(0,r.Cg)([(0,s.MZ)()],Ye.prototype,"analysisViewData",void 0),(0,r.Cg)([(0,s.MZ)()],Ye.prototype,"_hoveredPoints",void 0),(0,r.Cg)([(0,s.MZ)()],Ye.prototype,"updating",null),Ye=(0,r.Cg)([(0,o.$)("esri.views.analysis.ElevationProfile.ElevationProfileHoveredPointsVisualization")],Ye);let Ke=class extends M.A{constructor(e){super(e)}initialize(){const{view:e,analysisViewData:t}=this;this._hoveredPointsVisualization=new Ye({view:e,analysisViewData:t}),this._geometryVisualization=new He({view:e,analysisViewData:t}),this._lineVisualizations=(0,Ue.L)(()=>this.analysisViewData.analysis.profiles,i=>new Qe({view:e,analysisViewData:t,getResult:()=>t.results.find(e=>e.computation.profile===i)}))}destroy(){this._geometryVisualization.destroy(),this._hoveredPointsVisualization.destroy(),this._lineVisualizations.destroy()}get updating(){return this._geometryVisualization.updating||this._lineVisualizations.some(e=>e.updating)}};(0,r.Cg)([(0,s.MZ)()],Ke.prototype,"view",void 0),(0,r.Cg)([(0,s.MZ)()],Ke.prototype,"analysisViewData",void 0),(0,r.Cg)([(0,s.MZ)()],Ke.prototype,"updating",null),Ke=(0,r.Cg)([(0,o.$)("esri.views.3d.analysis.ElevationProfile.ElevationProfileVisualization3D")],Ke);var et=i(19495),tt=i(98773),it=i(53521),rt=i(71630),st=i(19747),ot=i(731);let nt=class extends M.A{constructor(e){super(e),this.error=null,this._getStableEffectiveUnits=l(()=>{var e,t;const i=function(e){let t=null,i=null,r=null;for(const s of e){if(null==s)continue;const{statistics:e,spatialReference:o}=s;if(null==e)continue;const n=(0,d.GA)(o);t=me(t,_e(e.maxDistance,n));const l=(0,d.G9)(o);r=fe(r,_e(e.minElevation,l)),i=me(i,_e(e.maxElevation,l))}return{minDistance:0,maxDistance:null!==t&&void 0!==t?t:0,minElevation:null!==r&&void 0!==r?r:0,maxElevation:null!==i&&void 0!==i?i:0}}(this._activeComputations.map(e=>e.result.rawResult)),r=this.analysis.displayUnits,s=(0,st.c)(this.view);return{distance:(0,d.Vs)(i.maxDistance,"meters",null!==(e=r.distance)&&void 0!==e?e:s),elevation:(0,d.jE)(i.maxElevation,"meters",null!==(t=r.elevation)&&void 0!==t?t:s)}},c.gh),this._updateTask=null,this._queue=null,this._currentTileCache=null,this._parametersPerComputation=new Map,this._getStableUpdateParameters=l(()=>{var e;return{stationary:null===(e=this.view.stationary)||void 0===e||e,activeComputations:this._activeComputations,generationParameters:this._generationParameters}},c.gh),this._getStableGenerationParameters=l(()=>{const{view:e,analysis:t}=this;return null!==e&&void 0!==e&&e.ready&&this._queue?{view:e,geometry:t.geometry,geometryIsValid:t.valid,elevationInfo:this.elevationInfo,queue:this._queue,cache:this._tileCache,options:this._options,slicePlane:"3d"===e.type?e.slice.plane:null}:null},c.gh),this._getStableElevationInfo=l(()=>{var e;return null!==(e=this.analysis.elevationInfo)&&void 0!==e?e:lt},u.CM),this._getStableOptions=l(()=>{var e;const{densificationMaxSamples:t,defaultDemResolution:i,maxTotalSamples:r}=x();let s=null!==(e=this._minDemResolution)&&void 0!==e?e:i;return s=parseFloat(s.toFixed(2)),{samplingDistance:s,densificationMaxSamples:Math.round(t/this._activeComputations.length),maxTotalSamples:r}},c.gh),this._updateThrottled=(0,Be.n)(e=>this._update(e),x().updateThrottleMillis)}initialize(){this._computationsCollection=(0,Ue.L)(()=>this.analysis.profiles,e=>this.computationFactory.create({controller:this,profile:e,onInvalidate:e=>this._invalidateComputation(e)}),{recycleItems:!0}),this.addHandles([this._computationsCollection.on("change",()=>{this._parametersPerComputation.clear(),this._updateThrottled(this._updateParameters)}),(0,h.wB)(()=>this._updateParameters,e=>this._updateThrottled(e),h.pc),this._updateThrottled]);const e="3d"===this.view.type?this.view.resourceController:void 0;this._queue=Ae(null===e||void 0===e?void 0:e.scheduler),null===e||void 0===e||e.addUpdatingObject(this)}destroy(){var e;this._abortUpdate(),this._parametersPerComputation.clear(),null!==(e=this._computationsCollection)&&void 0!==e&&e.destroy(),this._queue=(0,u.pR)(this._queue),this._currentTileCache=(0,u.pR)(this._currentTileCache)}get effectiveDisplayUnits(){return this._getStableEffectiveUnits()}get progress(){let e=0,t=0;for(const i of this._activeComputations)e++,t+=i.progress;return Te(e>0?t/e:0)}get updating(){var e;const{progress:t}=this,i=!(null===(e=this._queue)||void 0===e||!e.updating),r=this._updateThrottled.hasPendingUpdates(),s=null!=this._updateTask&&!this._updateTask.finished;return i||r||s||t>0&&t<1}get results(){return this._computations.map(e=>e.result)}get statistics(){return function(e){const t=e.filter(G.Ru),i=t.length;if(0===i)return null;const r=t[0];if(1===i)return r;let s=r.maxDistance,o=r.minElevation,n=r.maxElevation,l=r.maxPositiveSlope,a=r.maxNegativeSlope;for(let c=1;c<t.length;++c){const e=t[c];s=me(s,e.maxDistance),o=fe(o,e.minElevation),n=me(n,e.maxElevation),l=me(l,e.maxPositiveSlope),a=me(a,e.maxNegativeSlope)}return{maxDistance:s,minElevation:o,maxElevation:n,avgElevation:null,elevationGain:null,elevationLoss:null,maxPositiveSlope:l,maxNegativeSlope:a,avgPositiveSlope:null,avgNegativeSlope:null}}(this._activeComputations.map(e=>e.result.statistics))}get hoveredPoints(){return this._computations.map(e=>e.hoveredPoint)}onElevationChange(e){const{view:t}=this;return"3d"===(null===t||void 0===t?void 0:t.type)?(0,h.on)(()=>t.elevationProvider,"elevation-change",e,{onListenerAdd:e,onListenerRemove:e}):(0,b.hA)()}get _tileCache(){this._currentTileCache=(0,u.pR)(this._currentTileCache);const e=this.view;if("3d"===(null===e||void 0===e?void 0:e.type)){var t;const i=null===(t=e.basemapTerrain)||void 0===t?void 0:t.elevationQueryCache;if(null!=i)return i}return null==this._currentTileCache&&(this._currentTileCache=new rt.E(new it.q(20971520))),this._currentTileCache}get _computations(){var e,t;return null!==(e=null===(t=this._computationsCollection)||void 0===t?void 0:t.toArray())&&void 0!==e?e:[]}get _activeComputations(){return this._computations.filter(e=>e.profile.enabled&&e.available)}get _minDemResolution(){const e=this._minDemResolutions;return e.length>0?(0,G.jk)(e):null}get _minDemResolutions(){const e=[];for(const{minDemResolution:t}of this._activeComputations)null!=t&&e.push(t);return e}get _updateParameters(){return this._getStableUpdateParameters()}get _generationParameters(){return this._getStableGenerationParameters()}get elevationInfo(){return this._getStableElevationInfo()}get _options(){return this._getStableOptions()}_update(e){let{stationary:t,activeComputations:i,generationParameters:r}=e;this._abortUpdate(),t&&(null!=r?this._updateTask=(0,tt.UT)(async e=>{this.error=null;const t=i.filter(e=>!this._isComputationValid(e,r));try{if(!r.geometryIsValid)throw new j;const i=function(e,t){return xe.apply(this,arguments)}((0,Z.A)((0,Z.A)({},r),{},{providers:t}),{signal:e});let u=!1;var s,o=!1,n=!1;try{for(var l,a=(0,et.A)(i);o=!(l=await a.next()).done;o=!1){const i=l.value;(0,O.Te)(e),u||(this._clearInvalidResults(r),u=!0);for(let e=0;e<t.length;e++)t[e].setResult(i[e])}}catch(c){n=!0,s=c}finally{try{o&&null!=a.return&&await a.return()}finally{if(n)throw s}}for(const e of t)this._parametersPerComputation.set(e,r)}catch(u){(0,O.QP)(u),this._abortUpdate(),this.error=u instanceof F?u:new H,t.forEach(e=>{e.clearResult()})}}):this._clearResults())}_abortUpdate(){this._updateTask=(0,u.DC)(this._updateTask)}_isComputationValid(e,t){return this._parametersPerComputation.has(e)&&this._parametersPerComputation.get(e)===t}_invalidateComputation(e){this._parametersPerComputation.delete(e),this._updateThrottled(this._updateParameters)}_clearInvalidResults(e){for(const t of this._computations)this._isComputationValid(t,e)||(t.clearResult(),this._parametersPerComputation.delete(t))}_clearResults(){for(const e of this._computations)e.clearResult(),this._parametersPerComputation.delete(e)}};(0,r.Cg)([(0,s.MZ)({constructOnly:!0})],nt.prototype,"analysis",void 0),(0,r.Cg)([(0,s.MZ)({constructOnly:!0})],nt.prototype,"analysisViewData",void 0),(0,r.Cg)([(0,s.MZ)({constructOnly:!0})],nt.prototype,"computationFactory",void 0),(0,r.Cg)([(0,s.MZ)({constructOnly:!0})],nt.prototype,"view",void 0),(0,r.Cg)([(0,s.MZ)()],nt.prototype,"error",void 0),(0,r.Cg)([(0,s.MZ)({readOnly:!0})],nt.prototype,"effectiveDisplayUnits",null),(0,r.Cg)([(0,s.MZ)()],nt.prototype,"progress",null),(0,r.Cg)([(0,s.MZ)()],nt.prototype,"updating",null),(0,r.Cg)([(0,s.MZ)()],nt.prototype,"results",null),(0,r.Cg)([(0,s.MZ)()],nt.prototype,"statistics",null),(0,r.Cg)([(0,s.MZ)()],nt.prototype,"hoveredPoints",null),(0,r.Cg)([(0,s.MZ)()],nt.prototype,"_updateTask",void 0),(0,r.Cg)([(0,s.MZ)()],nt.prototype,"_queue",void 0),(0,r.Cg)([(0,s.MZ)()],nt.prototype,"_tileCache",null),(0,r.Cg)([(0,s.MZ)()],nt.prototype,"_computationsCollection",void 0),(0,r.Cg)([(0,s.MZ)()],nt.prototype,"_computations",null),(0,r.Cg)([(0,s.MZ)()],nt.prototype,"_activeComputations",null),(0,r.Cg)([(0,s.MZ)({readOnly:!0})],nt.prototype,"_minDemResolution",null),(0,r.Cg)([(0,s.MZ)()],nt.prototype,"_minDemResolutions",null),(0,r.Cg)([(0,s.MZ)()],nt.prototype,"_updateParameters",null),(0,r.Cg)([(0,s.MZ)()],nt.prototype,"_generationParameters",null),(0,r.Cg)([(0,s.MZ)()],nt.prototype,"elevationInfo",null),(0,r.Cg)([(0,s.MZ)()],nt.prototype,"_options",null),nt=(0,r.Cg)([(0,o.$)("esri.views.analysis.ElevationProfile.ElevationProfileController")],nt);const lt=new ot.A((0,Z.A)({},J.qt));var at=i(97153);function ct(e){var t;if(null==e)return null;if((0,at.Q)(e))return ut(e);const i=e.tileInfo;if(null==i)return null;const r=null===(t=i.lods)||void 0===t?void 0:t.at(-1);return null==r?null:r.resolution*(0,d.GA)(i.spatialReference)}function ut(e){var t;if(null==e)return null;const i=e.layers.items.map(ht).filter(G.Ru);return null!==(t=(0,G.jk)(i))&&void 0!==t?t:null}function ht(e){return e&&"tileInfo"in e?ct(e):null}let dt=class extends ze{constructor(){super(...arguments),this.type="ground",this.numSamplesForPreview=50,this.numSamplesPerChunk=1e3,this._getStableQueryElevationDependencies=l(()=>({ground:this._ground,groundLayers:this._getStableGroundLayers()}),c.gh),this._getStableGroundLayers=l(()=>{var e;return null===(e=this._ground)||void 0===e||null===(e=e.layers)||void 0===e?void 0:e.toArray()},c.gh)}get minDemResolution(){return ut(this._ground)}get available(){var e;return!0===(null===(e=this._ground)||void 0===e?void 0:e.layers.some(e=>e.visible))}initialize(){this.addHandles([(0,h.wB)(()=>this._queryElevationDependencies,()=>this.onInvalidate(this))])}async queryElevation(e,t){const i=this._queryElevationDependencies;if(null==i)throw new Error("".concat(this.declaredClass,": no dependencies"));const{ground:r}=i;if(null==r)throw new Error("No ground configured in the view");const s=await r.queryElevation(e,t),o=(0,d.G9)(e.spatialReference),n=(0,d.G9)(r.layers.at(0).spatialReference);if(o!==n){const e=s.geometry;e.points=e.points.map(e=>{let[i,r,s]=e;return[i,r,s===t.noDataValue?s:s*n/o]})}return s}get _queryElevationDependencies(){return this._getStableQueryElevationDependencies()}get _ground(){var e;return null===(e=this.controller.view)||void 0===e||null===(e=e.map)||void 0===e?void 0:e.ground}};(0,r.Cg)([(0,s.MZ)()],dt.prototype,"minDemResolution",null),(0,r.Cg)([(0,s.MZ)()],dt.prototype,"available",null),(0,r.Cg)([(0,s.MZ)()],dt.prototype,"_queryElevationDependencies",null),(0,r.Cg)([(0,s.MZ)()],dt.prototype,"_ground",null),dt=(0,r.Cg)([(0,o.$)("esri.views.analysis.ElevationProfile.ElevationProfileLineGroundComputation")],dt);let pt=class extends ze{constructor(){super(...arguments),this.type="input",this.numSamplesForPreview=50,this.numSamplesPerChunk=500,this._getStableElevationDependencies=l(()=>{const{view:e}=this.controller;if(!e)return null;const t=this._getStableElevationInfo();return{view:e,stationary:!this._requiresElevationAlignment||e.stationary,elevationInfo:t,visibleLayerIds:this._getStableLayerIds(),spatialReference:this._getStableSpatialReference()}},c.gh),this._getStableElevationInfo=l(()=>this.controller.elevationInfo,u.CM),this._getStableSpatialReference=l(()=>{var e;return null===(e=this.controller.view)||void 0===e?void 0:e.spatialReference},u.CM),this._getStableLayerIds=l(()=>{const{view:e}=this.controller;return"3d"!==e.type?[]:C(e)},c.gh)}initialize(){const e=()=>this.onInvalidate(this);this.addHandles([(0,h.wB)(()=>this._queryElevationDependencies,e,h.OH),this.controller.onElevationChange(e)])}async queryElevation(e,t){let{noDataValue:i,signal:r}=t;const s=this._queryElevationDependencies;if(null==s)throw new Error("".concat(this.declaredClass,": no dependencies"));const{view:o,spatialReference:n}=s;if(this._requiresElevationAlignment&&"3d"===o.type&&n){const t=await f.q.fromGeometry(e).project(n,r);if(!t)return{geometry:e,noDataValue:i};const s=o.elevationProvider;return t.coordinates.forEach(e=>{var t;e.z=null!==(t=s.getElevation(e.x,e.y,0,n,"ground"))&&void 0!==t?t:0}),{geometry:t.export(),noDataValue:i}}return{geometry:e,noDataValue:i}}get _requiresElevationAlignment(){var e;return"on-the-ground"===(null===(e=this.controller.elevationInfo)||void 0===e?void 0:e.mode)&&"3d"===this.controller.view.type}get _queryElevationDependencies(){return this._getStableElevationDependencies()}};(0,r.Cg)([(0,s.MZ)()],pt.prototype,"_queryElevationDependencies",null),pt=(0,r.Cg)([(0,o.$)("esri.views.analysis.ElevationProfile.ElevationProfileLineInputComputation")],pt);let vt=class extends ze{constructor(){super(...arguments),this.type="query",this.numSamplesForPreview=50,this.numSamplesPerChunk=500}get minDemResolution(){return ct(this.profile.source)}get available(){const{source:e}=this.profile;return!!e&&(null==e.visible||e.visible)&&(null==e.layers||e.layers.some(e=>e.visible))}initialize(){this.addHandles((0,h.wB)(()=>this.profile.source,()=>this.onInvalidate(this),h.OH))}queryElevation(e,t){if(!this.profile.source)throw new Error("No source configured for the elevation profile line");return this.profile.source.queryElevation(e,t)}};(0,r.Cg)([(0,s.MZ)({readOnly:!0})],vt.prototype,"minDemResolution",null),(0,r.Cg)([(0,s.MZ)()],vt.prototype,"available",null),vt=(0,r.Cg)([(0,o.$)("esri.views.analysis.ElevationProfile.ElevationProfileLineQueryComputation")],vt);var yt=i(39356),gt=i(19451),ft=i(63733),mt=i(89465),_t=i(7246),wt=i(2144),Ct=i(57308),Mt=i(81335),bt=i(18279);let Rt=class extends M.A{constructor(e){super(e),this._sketchViewModels=new Je.A,this._updatingHandles=new gt.U,this._operationManager=new wt.b}initialize(){const{view:e}=this;this._graphicsLayer=new ft.A({listMode:"hide",internal:!0}),this.addHandles([(0,h.wB)(()=>({map:e.map,internalGraphicsLayer:this._graphicsLayer,state:this.state,geometryVisualizationVisible:this._analysis.viewOptions.geometryVisualizationVisible,visible:this.analysisViewData.visible}),e=>{let{map:t,internalGraphicsLayer:i,state:r,geometryVisualizationVisible:s,visible:o}=e;!function(e,t){t&&(t.removeFromParent(),null===e||void 0===e||e.add(t))}(t,i);const n=this.sketchGraphic;switch(n&&(n.visible=o),r){case"idle":case"reshaping-disabled":n&&!s&&(n.visible=!1),this._operationManager.stop(),this._ensureUpdatedSketchGraphic();break;case"reshaping":(0,O.QZ)(this._startReshape());break;case"awaiting-sketch":this.analysisViewData.interactive=!0}},h.pc),(0,h.wB)(()=>this._analysis.elevationInfo,e=>{this._graphicsLayer.elevationInfo=e},h.pc)])}destroy(){var e;this._operationManager.destroy(),this._sketchViewModels.drain(e=>(0,u.pR)(e));const t=this._graphicsLayer;null!==(e=this.view.map)&&void 0!==e&&e.remove(t),t.destroy()}get sketchGraphic(){return this._get("sketchGraphic")}set sketchGraphic(e){e!==this._get("sketchGraphic")&&(this._set("sketchGraphic",e),this._updateAnalysisFromSketchGraphic())}get state(){const{visible:e,interactive:t}=this.analysisViewData;if(!e)return"idle";switch(this._operationManager.currentOperationType){case"place":return this._sketching?"sketching":"awaiting-sketch";case"pick-feature":return"picking";default:return this._analysis.geometry?t?"reshaping":"reshaping-disabled":"idle"}}get updating(){return this._sketchViewModels.some(e=>e.updating)||this._updatingHandles.updating}get _sketching(){return this._sketchViewModels.some(e=>e.createGraphic===this.sketchGraphic)}get _analysis(){return this.analysisViewData.analysis}get _lineSymbol(){return function(e){if("2d"===e){const e={type:"CIMSolidStroke",enable:!0,capStyle:"Butt",joinStyle:"Round",width:1.5};return new mt.A({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[(0,Z.A)((0,Z.A)({},e),{},{effects:[{type:"CIMGeometricEffectDashes",dashTemplate:[5,4],lineDashEnding:"FullGap",controlPointEnding:"NoConstraint"}],color:[0,0,0,255]}),(0,Z.A)((0,Z.A)({},e),{},{color:[255,255,255,255]})]}}})}return new _t.A({color:[0,0,0,0]})}(this.view.type)}place(e){return this._operationManager.start("place",async t=>{const i=this._createSketchViewModel(),r=this._analysis.clone();this._ensureUpdatedSketchGraphic();const s=this.sketchGraphic,o=this._analysis.elevationInfo,n=(0,b.hA)(()=>{this.sketchGraphic===s&&(this._graphicsLayer.elevationInfo=o)}),l=i.on("create",e=>{switch(e.state){case"start":this._graphicsLayer.removeAll(),this.sketchGraphic=e.graphic,this._analysis.elevationInfo=this._graphicsLayer.elevationInfo;break;case"active":this._updateAnalysisFromSketchGraphic();break;case"complete":this.sketchGraphic&&(this._updateAnalysisFromSketchGraphic(),this._addSketchGraphic(this.sketchGraphic)),t.stop();break;case"cancel":t.stop()}});t.handles.push(l,(0,b.hA)(()=>(l.remove(),i.destroy(),this._sketchViewModels.remove(i),this._updateAnalysisFromSketchGraphic(),this._analysis.valid?(0,O.G4)(e)||r.equals(this._analysis)?t.reject():void t.resolve({}):(this._clear(),t.reject()))),n),this._graphicsLayer.elevationInfo=xt,await this._updatingHandles.addPromise((0,O.QZ)(i.create("polyline")))},e)}async pickFeature(e){return this._operationManager.start("pick-feature",async e=>{const{view:t}=this;t.closePopup();let i=null;e.handles.push(t.on("immediate-click",r=>{r.defer(async()=>{var s;null!==(s=i)&&void 0!==s&&s.abort(),i=(0,tt.UT)(async i=>{const{results:s}=await t.hitTest(r);(0,O.Te)(i);let o=null;for(const e of s)if("graphic"===e.type&&re(e.graphic)&&!ne(e.graphic)){o=e.graphic;break}o?(r.preventDefault(),r.stopPropagation(),this.sketchGraphic=null,this._analysis.geometry=o.geometry,this._analysis.elevationInfo=new ot.A((0,Z.A)({},(0,J.bh)(o))),e.resolve({feature:o}),e.stop()):e.reject()}),await i.promise})},Ct.oj.TOOL),t.on("key-down",t=>{(0,Mt.$X)(t)&&(e.reject(),e.stop())},Ct.oj.TOOL),t.acquireCursor("crosshair","high"),(0,b.hA)(()=>{var t;null!==(t=i)&&void 0!==t&&t.abort(),e.reject()})),t.focus()},e)}_startReshape(){const e=this._createSketchViewModel();return this._sketchViewModels.add(e),this._operationManager.start("reshape",async t=>{const i=()=>{const t=this._ensureUpdatedSketchGraphic();return t?this._updatingHandles.addPromise(e.update(t,{tool:"reshape"})):Promise.resolve()};if(!this._ensureUpdatedSketchGraphic())return;const r=e.on("update",e=>{this._updateAnalysisFromSketchGraphic(),"complete"===e.state&&("reshaping"===this.state?(0,O.QZ)(i()):t.resolve())});t.handles.push(r,(0,b.hA)(()=>{r.remove(),this._sketchViewModels.remove(e),e.destroy(),t.resolve()})),await i()})}_createSketchViewModel(){return new bt.A({layer:this._graphicsLayer,view:this.view,defaultCreateOptions:{mode:"click",hasZ:!0},updateOnGraphicClick:!1,defaultUpdateOptions:{enableMoveAllGraphics:!1,enableRotation:!1,enableScaling:!1,enableZ:!1,highlightOptions:{enabled:!1},multipleSelectionEnabled:!1,reshapeOptions:{shapeOperation:"none"},toggleToolOnClick:!1,tool:"reshape"},polylineSymbol:this._lineSymbol,activeLineSymbol:this._lineSymbol})}_ensureUpdatedSketchGraphic(){var e;const{geometry:t}=this._analysis;if(!t)return this.sketchGraphic=null,this._graphicsLayer.removeAll(),null;const i=null!==(e=this.sketchGraphic)&&void 0!==e?e:this.sketchGraphic=new yt.A({symbol:this._lineSymbol,geometry:t});return i.geometry=t,this._addSketchGraphic(i),i}_addSketchGraphic(e){const{graphics:t}=this._graphicsLayer;t.includes(e)||t.add(e),1!==t.length&&t.removeMany(t.filter(t=>t!==e))}_clear(){this.sketchGraphic=null,this._analysis.clear()}_updateAnalysisFromSketchGraphic(){var e;let t=null===(e=this.sketchGraphic)||void 0===e?void 0:e.geometry;se(t)||(t=null);const i=this._analysis;i.geometry!==t&&(i.geometry=t)}};(0,r.Cg)([(0,s.MZ)({constructOnly:!0})],Rt.prototype,"analysisViewData",void 0),(0,r.Cg)([(0,s.MZ)({constructOnly:!0})],Rt.prototype,"view",void 0),(0,r.Cg)([(0,s.MZ)()],Rt.prototype,"sketchGraphic",null),(0,r.Cg)([(0,s.MZ)({nonNullable:!0})],Rt.prototype,"state",null),(0,r.Cg)([(0,s.MZ)()],Rt.prototype,"updating",null),(0,r.Cg)([(0,s.MZ)()],Rt.prototype,"_sketching",null),(0,r.Cg)([(0,s.MZ)()],Rt.prototype,"_analysis",null),(0,r.Cg)([(0,s.MZ)()],Rt.prototype,"_lineSymbol",null),Rt=(0,r.Cg)([(0,o.$)("esri.views.analysis.ElevationProfile.ElevationProfileTool")],Rt);const xt=new ot.A({mode:"on-the-ground",offset:0});let Pt=class extends n.P{constructor(e){super(e),this.type="elevation-profile-view-3d",this.analysis=null,this.hoveredPosition=null}initialize(){const{analysis:e,view:t}=this;this._controller=new nt({analysis:e,analysisViewData:this,view:t,computationFactory:{create:e=>{switch(e.profile.type){case"ground":return new dt(e);case"input":return new pt(e);case"query":return new vt(e);case"scene":return new Le(e)}}}}),this._visualization=new Ke({view:t,analysisViewData:this}),this._sketchTool=new Rt({view:t,analysisViewData:this})}destroy(){var e,t,i;null!==(e=this._controller)&&void 0!==e&&e.destroy(),null!==(t=this._visualization)&&void 0!==t&&t.destroy(),null===(i=this._sketchTool)||void 0===i||i.destroy()}get effectiveDisplayUnits(){var e,t;return null!==(e=null===(t=this._controller)||void 0===t?void 0:t.effectiveDisplayUnits)&&void 0!==e?e:{distance:"meters",elevation:"meters"}}get error(){var e;return null===(e=this._controller)||void 0===e?void 0:e.error}get hoveredPoints(){var e,t;return null!==(e=null===(t=this._controller)||void 0===t?void 0:t.hoveredPoints)&&void 0!==e?e:[]}get interactive(){return super.interactive}set interactive(e){super.interactive=e}get progress(){var e,t;return null!==(e=null===(t=this._controller)||void 0===t?void 0:t.progress)&&void 0!==e?e:0}get results(){var e,t;return null!==(e=null===(t=this._controller)||void 0===t?void 0:t.results)&&void 0!==e?e:[]}get statistics(){var e;return null===(e=this._controller)||void 0===e?void 0:e.statistics}get updating(){var e,t,i;return!0===(null===(e=this._controller)||void 0===e?void 0:e.updating)||!0===(null===(t=this._visualization)||void 0===t?void 0:t.updating)||!0===(null===(i=this._sketchTool)||void 0===i?void 0:i.updating)}get visible(){return super.visible}set visible(e){super.visible=e}get sketchGraphic(){var e;return null===(e=this._sketchTool)||void 0===e?void 0:e.sketchGraphic}get toolState(){var e,t;return null!==(e=null===(t=this._sketchTool)||void 0===t?void 0:t.state)&&void 0!==e?e:"idle"}place(e){return this._sketchTool.place(e)}pickFeature(e){return this._sketchTool.pickFeature(e)}};(0,r.Cg)([(0,s.MZ)({readOnly:!0})],Pt.prototype,"type",void 0),(0,r.Cg)([(0,s.MZ)({constructOnly:!0,nonNullable:!0})],Pt.prototype,"analysis",void 0),(0,r.Cg)([(0,s.MZ)({readOnly:!0})],Pt.prototype,"effectiveDisplayUnits",null),(0,r.Cg)([(0,s.MZ)({readOnly:!0})],Pt.prototype,"error",null),(0,r.Cg)([(0,s.MZ)()],Pt.prototype,"hoveredPosition",void 0),(0,r.Cg)([(0,s.MZ)()],Pt.prototype,"hoveredPoints",null),(0,r.Cg)([(0,s.MZ)({readOnly:!0})],Pt.prototype,"progress",null),(0,r.Cg)([(0,s.MZ)({readOnly:!0})],Pt.prototype,"results",null),(0,r.Cg)([(0,s.MZ)({readOnly:!0})],Pt.prototype,"statistics",null),(0,r.Cg)([(0,s.MZ)({readOnly:!0})],Pt.prototype,"updating",null),(0,r.Cg)([(0,s.MZ)()],Pt.prototype,"sketchGraphic",null),(0,r.Cg)([(0,s.MZ)()],Pt.prototype,"toolState",null),(0,r.Cg)([(0,s.MZ)()],Pt.prototype,"_controller",void 0),(0,r.Cg)([(0,s.MZ)()],Pt.prototype,"_visualization",void 0),(0,r.Cg)([(0,s.MZ)()],Pt.prototype,"_sketchTool",void 0),Pt=(0,r.Cg)([(0,o.$)("esri.views.3d.analysis.ElevationProfileAnalysisView3D")],Pt);const St=Pt},35925:(e,t,i)=>{i.d(t,{Xq:()=>l,wk:()=>n});const r={dash:[4,3],dot:[1,3],"long-dash":[8,3],"short-dash":[4,1],"short-dot":[1,1]},s={dash:r.dash,"dash-dot":[...r.dash,...r.dot],dot:r.dot,"long-dash":r["long-dash"],"long-dash-dot":[...r["long-dash"],...r.dot],"long-dash-dot-dot":[...r["long-dash"],...r.dot,...r.dot],none:null,"short-dash":r["short-dash"],"short-dash-dot":[...r["short-dash"],...r["short-dot"]],"short-dash-dot-dot":[...r["short-dash"],...r["short-dot"],...r["short-dot"]],"short-dot":r["short-dot"],solid:null},o=8;function n(e){return{pattern:[e,e],pixelRatio:2}}function l(e){return"style"===(null===e||void 0===e?void 0:e.type)?function(e){return null!=e?function(e,t){return null==e?e:{pattern:e.slice(),pixelRatio:t}}(s[e],o):null}(e.style):null}},42151:(e,t,i)=>{i.d(t,{E5:()=>d,ZP:()=>g});var r=i(18690),s=i(94967),o=i(99809),n=i(60008),l=i(4336),a=i(20664),c=i(9392),u=i(19247);function h(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return null!=i?[e,t,i]:[e,t]}function d(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return null!=i?{x:e,y:t,z:i}:{x:e,y:t}}class p{constructor(e){this.spatialReference=e}mapToLocalMultiple(e){return e.map(e=>this.mapToLocal(e)).filter(r.Ru)}get doUnnormalization(){return!1}}class v extends p{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super(t),this._defaultZ=i,this.transform=(0,o.vt)(),this.transformInv=(0,o.vt)(),this.transform=(0,o.o8)(e),(0,s.B8)(this.transformInv,this.transform)}makeMapPoint(e,t){return h(e,t,this._defaultZ)}mapToLocal(e){return d(this.transform[0]*e[0]+this.transform[2]*e[1]+this.transform[4],this.transform[1]*e[0]+this.transform[3]*e[1]+this.transform[5])}localToMap(e){return h(this.transformInv[0]*e.x+this.transformInv[2]*e.y+this.transformInv[4],this.transformInv[1]*e.x+this.transformInv[3]*e.y+this.transformInv[5],this._defaultZ)}}class y extends p{constructor(e,t){super(e.spatialReference),this.view=e,this.defaultZ=null,this.pWS=(0,c.vt)(),this.tangentFrameUpWS=(0,c.vt)(),this.tangentFrameRightWS=(0,c.vt)(),this.tangentFrameForwardWS=(0,c.vt)(),this.localFrameRightWS=(0,c.vt)(),this.localFrameUpWS=(0,c.vt)(),this.worldToLocalTransform=(0,l.vt)(),this.localToWorldTransform=(0,l.vt)(),this.scale=1,this.scale=e.resolution,this.referenceMapPoint=t,this.defaultZ=t.hasZ?t.z:null;const i=e.state.camera.viewRight;this.view.renderCoordsHelper.toRenderCoords(this.referenceMapPoint,this.pWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,0,this.tangentFrameRightWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,1,this.tangentFrameUpWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,2,this.tangentFrameForwardWS);const r=(0,c.vt)();(0,a.h)(r,this.tangentFrameForwardWS,(0,a.f)(i,this.tangentFrameForwardWS)),(0,a.e)(this.localFrameRightWS,i,r),(0,a.n)(this.localFrameRightWS,this.localFrameRightWS),(0,a.i)(this.localFrameUpWS,this.tangentFrameForwardWS,this.localFrameRightWS),(0,n.Yc)(this.worldToLocalTransform,this.localFrameRightWS,this.tangentFrameRightWS),(0,n.B8)(this.localToWorldTransform,this.worldToLocalTransform)}get doUnnormalization(){return"global"===this.view.viewingMode}makeMapPoint(e,t){return h(e,t,this.defaultZ)}mapToLocal(e){const t=(0,c.vt)();this.view.renderCoordsHelper.toRenderCoords(new u.A({x:e[0],y:e[1],spatialReference:this.spatialReference}),t),(0,a.v)(t,t,this.worldToLocalTransform);const i=this.view.renderCoordsHelper.fromRenderCoords(t,new u.A({spatialReference:this.view.spatialReference}));return null!=i?d(i.x/this.scale,i.y/this.scale):null}localToMap(e){const t=(0,c.vt)();this.view.renderCoordsHelper.toRenderCoords(new u.A({x:e.x*this.scale,y:e.y*this.scale,spatialReference:this.spatialReference}),t),(0,a.v)(t,t,this.localToWorldTransform);const i=this.view.renderCoordsHelper.fromRenderCoords(t,new u.A({spatialReference:this.view.spatialReference}));return null!=i?h(i.x,i.y,this.defaultZ):null}}function g(e,t){if("2d"===e.type)return new v(e.state.transform,e.spatialReference,t.length>2?t[2]:null);if("3d"===e.type){const i=t.length>2?new u.A({x:t[0],y:t[1],z:t[2],spatialReference:e.spatialReference}):new u.A({x:t[0],y:t[1],spatialReference:e.spatialReference});return new y(e,i)}return null}},48384:(e,t,i)=>{i.d(t,{zV:()=>L,zd:()=>F,eq:()=>E,N6:()=>D,LZ:()=>Z,_T:()=>G,GF:()=>k});var r,s=i(18690),o=i(53084),n=i(31633),l=i(20664),a=i(9392),c=i(6326),u=i(46053),h=(i(81806),i(76460),i(47249),i(87990)),d=i(34111),p=i(19247),v=i(65215),y=i(13312),g=i(7137),f=i(45417),m=i(85996);let _=r=class extends v.A{constructor(e){super(e),this.center=null,this.geodesic=!1,this.numberOfPoints=60,this.radius=1e3,this.radiusUnit="meters"}initialize(){var e;const t=this.center,i=this.numberOfPoints;if(this.hasZ=null!==(e=null===t||void 0===t?void 0:t.hasZ)&&void 0!==e&&e,0!==this.rings.length||!t)return;const r=(0,n.oU)(this.radius,this.radiusUnit,"meters"),s=t.spatialReference;let o,l="geographic";if(s.isWebMercator?l="webMercator":(null!=(s.wkid&&m.A[s.wkid])||(s.wkt2||s.wkt)&&(0,n.x1)(s.wkt2||s.wkt))&&(l="projected"),this.geodesic){let e;switch(l){case"webMercator":e=(0,f.ci)(t);break;case"projected":console.error("Creating a geodesic circle requires the center to be specified in web mercator or geographic coordinate system");break;case"geographic":e=t}o=this._createGeodesicCircle(e,r,i),"webMercator"===l&&(o=(0,f.Gh)(o))}else{let e;"webMercator"===l||"projected"===l?e=r/(0,n.Ao)(t.spatialReference):"geographic"===l&&(e=(0,n.vl)(r,"meters",(0,d.tO)(t.spatialReference).radius)),o=this._createPlanarCircle(t,e,i)}this.spatialReference=o.spatialReference,this.addRing(o.rings[0])}clone(){const{center:e,numberOfPoints:t,radius:i,radiusUnit:s,geodesic:o}=this;return new r({center:null===e||void 0===e?void 0:e.clone(),numberOfPoints:t,radius:i,radiusUnit:s,geodesic:o})}_createGeodesicCircle(e,t,i){const r=[],s=[e.x,e.y];for(let n=0;n<360;n+=360/i){var o;const i=this.hasZ?[0,0,null!==(o=e.z)&&void 0!==o?o:0]:[0,0];(0,g.vN)(i,s,n,t,y.A.WGS84),r.push(i)}return r.push(r[0]),new v.A({rings:[r]})}_createPlanarCircle(e,t,i){const r=[],s=2*Math.PI/i;for(let n=0;n<i;++n){var o;const i=s*n,l=[e.x+Math.cos(-i)*t,e.y+Math.sin(-i)*t];this.hasZ&&l.push(null!==(o=e.z)&&void 0!==o?o:0),r.push(l)}return r.push(r[0]),new v.A({spatialReference:e.spatialReference,rings:[r]})}};(0,c.Cg)([(0,u.MZ)({type:p.A})],_.prototype,"center",void 0),(0,c.Cg)([(0,u.MZ)()],_.prototype,"geodesic",void 0),(0,c.Cg)([(0,u.MZ)()],_.prototype,"numberOfPoints",void 0),(0,c.Cg)([(0,u.MZ)()],_.prototype,"radius",void 0),(0,c.Cg)([(0,u.MZ)()],_.prototype,"radiusUnit",void 0),_=r=(0,c.Cg)([(0,h.$)("esri.geometry.Circle")],_);const w=_;var C=i(66388),M=i(23701),b=i(1736),R=i(78496),x=i(5262),P=i(80963),S=i(42151);function A(e,t){const i=new p.A({x:e[0],y:e[1],spatialReference:t});return e.length>2&&(i.z=e[2]),i}function E(e,t){return new C.A({points:e,spatialReference:t})}function Z(e,t,i){const r=new M.A({paths:e,spatialReference:t});return i&&(0,x._7)(r),r}function D(e,t,i){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const n=(0,o.o8)(e);n.forEach(e=>{const t=e[0],i=e[e.length-1];(0,s.aI)(t,i)&&1!==e.length||e.push(e[0])});let l=new v.A({rings:n,spatialReference:t});return l.rings.forEach(e=>{(0,x.$3)(e)||e.reverse()}),i&&(0,x._7)(l),r&&!(0,R.i)(l)&&(0,P.fn)(t)&&(l=(0,R.e)(l)||l),l}function k(e,t,i){const r=t.mapToLocalMultiple(e),o=[],n={x:r[0].x,y:r[0].y},l=r[1].x,a=r[1].y,c=Math.round(l-n.x),u=Math.round(a-n.y),h=Math.max(Math.abs(c),Math.abs(u));if(i){const e={x:n.x+h,y:n.y+h},t={x:n.x-h,y:n.y-h};o.push((0,S.E5)(e.x,t.y),(0,S.E5)(t.x,t.y),(0,S.E5)(t.x,e.y),(0,S.E5)(e.x,e.y))}else{const e={x:c>0?n.x+h:n.x-h,y:u>0?n.y+h:n.y-h};o.push((0,S.E5)(n.x,n.y),(0,S.E5)(e.x,n.y),(0,S.E5)(e.x,e.y),(0,S.E5)(n.x,e.y))}return T(D([o.map(e=>t.localToMap(e)).filter(s.Ru)],t.spatialReference,t.doUnnormalization,!0),o,t)}function G(e,t,i){let r=t.mapToLocalMultiple(e);if(1===r.length){const e=48,t=r[0];r=[(0,S.E5)(t.x-e,t.y+e),(0,S.E5)(t.x+e,t.y-e),(0,S.E5)(t.x+e,t.y-e),(0,S.E5)(t.x-e,t.y+e)]}const o=[],n={x:r[0].x,y:r[0].y},l={x:r[1].x,y:r[1].y};if(i){const e=Math.round(l.x-n.x),t=Math.round(l.y-n.y);o.push((0,S.E5)(n.x-e,n.y-t),(0,S.E5)(l.x,n.y-t),(0,S.E5)(l.x,l.y),(0,S.E5)(n.x-e,l.y))}else o.push((0,S.E5)(n.x,n.y),(0,S.E5)(l.x,n.y),(0,S.E5)(l.x,l.y),(0,S.E5)(n.x,l.y));return T(D([o.map(e=>t.localToMap(e)).filter(s.Ru)],t.spatialReference,t.doUnnormalization,!0),o,t)}function T(e,t,i){const r=O(t[3],t[2],i),s=O(t[1],t[2],i),o=O(t[0],t[1],i),n=O(t[0],t[3],i);return{geometry:e,midpoints:null!=r&&null!=s&&null!=o&&null!=n?{top:r,right:s,bottom:o,left:n}:null}}function O(e,t,i){I[0]=e.x,I[1]=e.y,I[2]=0,z[0]=t.x,z[1]=t.y,z[2]=0,(0,l.l)(I,I,z,.5),V.x=I[0],V.y=z[1],V.z=z[2];const r=i.localToMap(V);return null!=r?A(r,i.spatialReference):null}const V=(0,S.E5)(0,0,0),I=(0,a.vt)(),z=(0,a.vt)();function L(e,t,i,r){const s=t.mapToLocalMultiple(e);let o=null,l=null;if(i)o=s[0],l=s[1];else{const e=s[0],t=s[1],i=Math.round(t.x-e.x),r=Math.round(t.y-e.y),n=Math.max(Math.abs(i),Math.abs(r));o=(0,S.E5)(i>0?e.x+n/2:e.x-n/2,r>0?e.y+n/2:e.y-n/2),l=(0,S.E5)(Math.abs(i)>Math.abs(r)?o.x-n/2:o.x,Math.abs(i)>Math.abs(r)?o.y:o.y-n/2)}const a=t.localToMap(o),c=t.localToMap(l);if(null==a||null==c)return null;t.doUnnormalization&&(0,x.JM)([[a,c]],t.spatialReference);const u=A(a,t.spatialReference),h=A(c,t.spatialReference),d=(0,n.GA)(t.spatialReference);let p=0;if((0,P.fn)(t.spatialReference))p=d*(0,b.e)(u,h);else{const e=o.x-l.x,t=o.y-l.y;p=d*Math.sqrt(e*e+t*t)*(r||1)}const v=new w({center:u,radius:p,radiusUnit:"meters",spatialReference:t.spatialReference});return{geometry:D(v.rings,v.spatialReference,!1),center:u,edge:h}}function F(e,t,i){const r=t.mapToLocalMultiple(e),o=r[0],n=r[1],l=Math.round(n.x-o.x),a=Math.round(n.y-o.y),c=(0,S.E5)(i?o.x:o.x+l/2,i?o.y:o.y+a/2),u=i?l:l/2,h=i?a:a/2,d=[],p=2*Math.PI/60;function v(e){const t=Math.cos(e),i=Math.sin(e);return(0,S.E5)(u*t+c.x,h*i+c.y)}for(let s=0;s<60;s++)d.push(v(s*p));d.push(d[0]);const{spatialReference:y,doUnnormalization:g}=t,f=D([d.map(e=>t.localToMap(e)).filter(s.Ru)],y,g,!1),m=t.localToMap(v(Math.PI/2)),_=t.localToMap(v(0)),w=t.localToMap(v(-Math.PI/2)),C=t.localToMap(v(Math.PI));return{geometry:f,midpoints:null!=m&&null!=_&&null!=w&&null!=C?{top:A(m,y),right:A(_,y),bottom:A(w,y),left:A(C,y)}:null}}},50360:(e,t,i)=>{i.d(t,{Pg:()=>a,fz:()=>c,g7:()=>n,zo:()=>l});var r=i(68707),s=(i(97799),i(63331),i(56175));i(91523);const o=new s.D;function n(e,t,i){return o.execute(e,t,i,null)}function l(e,t,i){const s=o.executeMany(new r.S(e),t,i,null);return Array.from(s)}function a(e,t,i){return o.isSimpleAsFeature(e,t,i,null,null)}function c(){return o.supportsCurves()}},56218:(e,t,i)=>{i.d(t,{A:()=>s});var r=i(27106);function s(e){return new r.A(e,0)}},72205:(e,t,i)=>{i.d(t,{P:()=>u});var r=i(6326),s=(i(76460),i(81806),i(47249),i(50076),i(87990)),o=i(54099),n=i(54901),l=i(91291),a=i(46053);let c=class extends((0,l.g)(o.nJ)){constructor(){super(...arguments),this.parent=null,this._userInteractive=!1,this._interactiveViewModelCount=0}get interactive(){return this._interactiveViewModelCount>0||this._userInteractive}set interactive(e){this._userInteractive=e}get updating(){return!1}get visible(){var e,t;return null===(e=(null===(t=this.parent)||void 0===t?void 0:t.visible)&&!this.parent.suspended)||void 0===e||e}set visible(e){this._overrideIfSome("visible",e)}forceInteractive(){return this._interactiveViewModelCount++,(0,n.hA)(()=>this._interactiveViewModelCount--)}};(0,r.Cg)([(0,a.MZ)({constructOnly:!0})],c.prototype,"parent",void 0),(0,r.Cg)([(0,a.MZ)({constructOnly:!0})],c.prototype,"view",void 0),(0,r.Cg)([(0,a.MZ)({type:Boolean})],c.prototype,"interactive",null),(0,r.Cg)([(0,a.MZ)()],c.prototype,"_userInteractive",void 0),(0,r.Cg)([(0,a.MZ)({readOnly:!0})],c.prototype,"updating",null),(0,r.Cg)([(0,a.MZ)()],c.prototype,"visible",null),(0,r.Cg)([(0,a.MZ)()],c.prototype,"_interactiveViewModelCount",void 0),c=(0,r.Cg)([(0,s.$)("esri.views.analysis.AnalysisView")],c);let u=class extends c{};u=(0,r.Cg)([(0,s.$)("esri.views.3d.analysis.AnalysisView3D")],u)},78496:(e,t,i)=>{i.d(t,{a:()=>n,b:()=>a,e:()=>o,i:()=>l,s:()=>c});var r=i(50360),s=i(58067);function o(e){const t=(0,s.getSpatialReference)(e);return(0,s.toGeometry)((0,r.g7)((0,s.fromGeometry)(e),(0,s.fromSpatialReference)(t),!1),t)}function n(e){const t=e.map(s.fromGeometry),i=(0,s.getSpatialReference)(e);return(0,r.zo)(t,(0,s.fromSpatialReference)(i),!1).map(e=>(0,s.toGeometry)(e,i))}function l(e){return(0,r.Pg)((0,s.fromGeometry)(e),(0,s.fromSpatialReference)((0,s.getSpatialReference)(e)),!1)}const a=(0,r.fz)(),c=Object.freeze(Object.defineProperty({__proto__:null,execute:o,executeMany:n,isSimple:l,supportsCurves:a},Symbol.toStringTag,{value:"Module"}))},79468:(e,t,i)=>{i.d(t,{n:()=>s});var r=i(75540);function s(e,t,i,s){let o=null,n=1e3;"number"==typeof t?(n=t,s=i):(o=null!==t&&void 0!==t?t:null,n=i);const l=(0,r.v)(0);let a;const c=()=>{l.value=0,e.apply(s,a)},u=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];o&&o.apply(s,t),a=t,n?l.value||(l.value=setTimeout(c,n)):c()};return u.remove=()=>{l.value&&(clearTimeout(l.value),l.value=0)},u.forceUpdate=()=>{l.value&&(clearTimeout(l.value),c())},u.hasPendingUpdates=()=>!!l.value,u}},85746:(e,t,i)=>{i.d(t,{X:()=>y});var r=i(6326),s=i(91967),o=i(5632),n=i(46053),l=(i(81806),i(76460),i(47249),i(87990));class a{constructor(e){this._resourceFactory=e,this._resources=null,this._visible=!0,this._attached=!1,this._renderGroup=2}destroy(){this._destroyResources()}get resources(){var e;return null===(e=this._resources)||void 0===e?void 0:e.external}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this._syncGeometriesToRenderer())}get attached(){return this._attached}set attached(e){e!==this._attached&&(this._attached=e,this._createOrDestroyResources())}get renderGroup(){return this._renderGroup}set renderGroup(e){var t;this._renderGroup=e;const i=null===(t=this._resources)||void 0===t?void 0:t.layerView;i&&(i.renderGroup=e)}recreate(){this.attached&&this._createResources()}recreateGeometry(){this._resourceFactory.recreateGeometry?null!=this._resources&&(this._ensureRenderGeometriesRemoved(),this._resourceFactory.recreateGeometry(this._resources.external),this._syncGeometriesToRenderer()):this.recreate()}forEachMaterial(e){this._resources&&this._resourceFactory.forEachMaterial(this._resources.external,e)}_createOrDestroyResources(){this._attached?null==this._resources&&this._createResources():this._destroyResources()}_createResources(){this._destroyResources();const e=this._resourceFactory.createResources(),t=new c({view:this._resourceFactory.view,renderGroup:this._renderGroup}),i=this._resourceFactory.view.overlayManager;this._resources={layerView:t,external:e,geometriesAdded:!1},i&&(this._resources.drapeSourceRenderer=i.registerGeometryDrapeSource(t)),this._syncGeometriesToRenderer()}_destroyResources(){if(null==this._resources)return;this._ensureRenderGeometriesRemoved();const e=this._resourceFactory.view.overlayManager;e&&e.unregisterDrapeSource(this._resources.layerView),this._resourceFactory.destroyResources(this._resources.external),this._resources=null}_syncGeometriesToRenderer(){this._visible?this._ensureRenderGeometriesAdded():this._ensureRenderGeometriesRemoved()}_ensureRenderGeometriesRemoved(){var e;null!=(null===(e=this._resources)||void 0===e?void 0:e.drapeSourceRenderer)&&this._resources.geometriesAdded&&(this._resources.drapeSourceRenderer.removeGeometries(this._resources.external.geometries,1),this._resources.geometriesAdded=!1)}_ensureRenderGeometriesAdded(){var e;null!=(null===(e=this._resources)||void 0===e?void 0:e.drapeSourceRenderer)&&(this._resources.geometriesAdded||(this._resources.drapeSourceRenderer.addGeometries(this._resources.external.geometries,1),this._resources.geometriesAdded=!0))}}let c=class extends((0,o.sA)(s.A)){constructor(e){super(e),this.drapeSourceType=1,this.updatePolicy=1,this.renderGroup=2}};(0,r.Cg)([(0,n.MZ)({constructOnly:!0})],c.prototype,"view",void 0),(0,r.Cg)([(0,n.MZ)({readOnly:!0})],c.prototype,"drapeSourceType",void 0),(0,r.Cg)([(0,n.MZ)()],c.prototype,"renderGroup",void 0),c=(0,r.Cg)([(0,l.$)("esri.views.3d.interactive.visualElements.DrapedVisualElementResources")],c);var u=i(69230),h=i(68134),d=i(37046),p=i(8918);class v{constructor(e){this._resourceFactory=e,this._resources=null,this._visible=!0,this._attached=!1}destroy(){this._destroyResources()}get object(){return null!=this._resources?this._resources.object:null}get resources(){return null!=this._resources?this._resources.external:null}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this._syncVisible())}get attached(){return this._attached}set attached(e){e!==this._attached&&(this._attached=e,this._createOrDestroyResources())}recreate(){this.attached&&this._createResources()}recreateGeometry(){if(!this._resourceFactory.recreateGeometry)return void this.recreate();const e=this._resourceFactory.view.stage;if(null==this._resources||!e)return;const t=this._resources.object;t.removeAllGeometries(),this._resourceFactory.recreateGeometry(this._resources.external,t,this._resources.layer)}forEachMaterial(e){this._resources&&this._resourceFactory.forEachMaterial(this._resources.external,e)}_createOrDestroyResources(){this._attached?this._resources||this._createResources():this._destroyResources()}_createResources(){this._destroyResources();const e=this._resourceFactory,t=e.view,i=t.stage;if(!i)return;const r=new p.x(i,{pickable:!1,updatePolicy:1}),s=new d.B({castShadow:!1}),o=e.createResources(s,r);r.add(s);const n=e.cameraChanged,l=n?(0,h.wB)(()=>t.state.camera,e=>n(e),h.Vh):null;this._resources={layer:r,object:s,external:o,cameraHandle:l},this._syncVisible()}_destroyResources(){var e;null!=this._resources&&(this._resources.layer.destroy(),this._resources.object.dispose(),null!==(e=this._resources.cameraHandle)&&void 0!==e&&e.remove(),this._resourceFactory.destroyResources(this._resources.external),this._resources=null)}_syncVisible(){null!=this._resources&&(this._resources.object.visible=this._visible)}}class y extends u.B{constructor(e){var t;super(e),this._isDraped=!1,this.object3dResources=new v(this.createObject3DResourceFactory(e.view)),this.drapedResources=new a(this.createDrapedResourceFactory(e.view)),this.isDraped=null!==(t=e.isDraped)&&void 0!==t&&t}get isDraped(){return this._isDraped}set isDraped(e){e!==this._isDraped&&(this._isDraped=e,this.object3dResources.attached=this.attached&&!e,this.drapedResources.attached=this.attached&&e)}get renderGroup(){return this.drapedResources.renderGroup}set renderGroup(e){this.drapedResources.renderGroup=e}createResources(){this.object3dResources.attached=!this._isDraped,this.drapedResources.attached=this._isDraped}destroyResources(){this.object3dResources.attached=!1,this.drapedResources.attached=!1}recreate(){this.object3dResources.recreate(),this.drapedResources.recreate()}recreateGeometry(){this.object3dResources.recreateGeometry(),this.drapedResources.recreateGeometry()}destroy(){this.object3dResources.destroy(),this.drapedResources.destroy(),super.destroy()}updateVisibility(e){this.object3dResources.visible=e,this.drapedResources.visible=e}forEachMaterial(e){var t,i;null!==(t=this.object3dResources)&&void 0!==t&&t.forEachMaterial(e),null===(i=this.drapedResources)||void 0===i||i.forEachMaterial(e)}}},99809:(e,t,i)=>{function r(){return[1,0,0,1,0,0]}function s(e){return[e[0],e[1],e[2],e[3],e[4],e[5]]}i.d(t,{o8:()=>s,vt:()=>r});const o=[1,0,0,1,0,0];Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:o,clone:s,create:r,fromValues:function(e,t,i,r,s,o){return[e,t,i,r,s,o]}},Symbol.toStringTag,{value:"Module"}))}}]);
//# sourceMappingURL=9660.10b9176f.chunk.js.map