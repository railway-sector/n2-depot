"use strict";(self.webpackChunkn2_depot=self.webpackChunkn2_depot||[]).push([[4838],{10231:(e,t,i)=>{i.d(t,{i:()=>n});class n{constructor(e,t,i,n,s){this.toMapSpace=e,this.transform=t,this.obb=i,this.geometry=n,this.elevationAlignable=s}}},14303:(e,t,i)=>{i.d(t,{A:()=>v});var n,s=i(6326),r=i(42553),o=i(53084),a=i(62754),l=i(46053),p=(i(81806),i(76460),i(87990)),u=i(17707),h=i(37546),c=i(65215),d=i(56611);let v=n=class extends r.o{constructor(e){super(e),this.geometry=null,this.type="clip"}writeGeometry(e,t,i,n){var s;if(null!==(s=n.layer)&&void 0!==s&&s.spatialReference&&!n.layer.spatialReference.equals(this.geometry.spatialReference)){if(!(0,d.canProjectWithoutEngine)(e.spatialReference,n.layer.spatialReference))return void((null===n||void 0===n?void 0:n.messages)&&n.messages.push(new a.A("scenemodification:unsupported","Scene modifications with incompatible spatial references are not supported",{modification:this,spatialReference:n.layer.spatialReference,context:n})));const s=new c.A;(0,d.projectPolygon)(e,s,n.layer.spatialReference),t[i]=s.toJSON(n)}else t[i]=e.toJSON(n)}clone(){return new n({geometry:(0,o.o8)(this.geometry),type:this.type})}};(0,s.Cg)([(0,l.MZ)({type:c.A}),(0,h.P)()],v.prototype,"geometry",void 0),(0,s.Cg)([(0,u.K)(["web-scene","portal-item"],"geometry")],v.prototype,"writeGeometry",null),(0,s.Cg)([(0,l.MZ)({type:["clip","mask","replace"],nonNullable:!0}),(0,h.P)()],v.prototype,"type",void 0),v=n=(0,s.Cg)([(0,p.$)("esri.layers.support.SceneModification")],v)},21479:(e,t,i)=>{i.d(t,{f:()=>a});var n=i(20664),s=i(482),r=i(14556),o=i(80963);function a(e,t,i,a){const l=(0,s.Tp)(t,a);if(null==l)return!1;const p=l.source.spatialReferenceId,u=l.dest.spatialReferenceId;if(p===u&&0!==p||(0,o.aI)(t,a))return i[0]=1,i[1]=1,i[2]=1,!0;if(1===p){const t=(0,n.b)(e),o=t/Math.sqrt(e[0]*e[0]+e[1]*e[1]),a=t/r.$O.radius;if(3===u)return i[0]=o*a,i[1]=o*a,i[2]=1,!0;if(2===u||5===u){const e=s.iE;return i[0]=e*o*a,i[1]=e*a,i[2]=1,!0}}else if(11===p){if(2===u||5===u)return i[0]=s.iE,i[1]=s.iE,i[2]=1,!0;if(3===u){const t=e[1]/r.$O.radius;return i[0]=1,i[1]=1/Math.cos(t),i[2]=1,!0}}return!1}},35493:(e,t,i)=>{i.d(t,{e:()=>m});var n=i(6326),s=i(54099),r=i(76460),o=i(46053),a=(i(81806),i(47249),i(87990)),l=i(34761),p=i(13191),u=i(20664),h=i(9392),c=i(79115),d=i(2413),v=i(78315),g=i(95225),y=i(89801),f=i(96342);let m=class extends s.nJ{constructor(e){super(e),this._tmpEvent=new y.p,this._renderCoordsHelper=e.view.renderCoordsHelper,this._renderSR=this._renderCoordsHelper.spatialReference,this._layerElevationSource=e.layerElevationSource}initialize(){this._intersector=new f.n(this.view.state.viewingMode),this._intersector.options.store=0,this._intersector.options.normalRequired=!1,this._tmpEvent.context=this.intersectionHandler.isGround?"ground":"scene"}get spatialReference(){var e;return null===(e=this.view)||void 0===e||null===(e=e.elevationProvider)||void 0===e?void 0:e.spatialReference}getElevation(e,t,i,n){const s=this._renderCoordsHelper,o=(0,u.j)(E,e,t,i);if(!s.toRenderCoords(o,n,o))return r.A.getLogger(this).error("could not project point to compute elevation"),null;const{layerElevationSource:a,_intersector:l,intersectionHandler:p}=this,h=a.fullExtent,c=null!=h&&Number.isFinite(h.xmin)&&Number.isFinite(h.xmax)&&Number.isFinite(h.ymin)&&Number.isFinite(h.ymax)&&Number.isFinite(h.zmin)&&Number.isFinite(h.zmax)?new g.H(h.zmin,h.zmax):a.elevationRange;if(null==c)return null;const d=a.elevationOffset,v=c.elevationRangeMin+d,y=c.elevationRangeMax+d,f=s.setAltitude(R,y,o),m=s.setAltitude(w,v,o);return l.reset(f,m,this.view.state.camera),p.intersect(l,null,f,m,null,!0),l.results.min.getIntersectionPoint(o)?s.getAltitude(o):null}getSphereElevationBounds(e,t){return(0,c.z)(e,t,b,this._renderSR),this._layerElevationSource.getElevationRange(b)}getRootElevationBounds(){const e=this.layerElevationSource.fullExtent;return null!==e&&void 0!==e&&e.hasZ?new g.H(e.zmin,e.zmax):null}notifyObjectsChanged(e){this.spatialReference&&(this._computeLayerExtent(t=>{for(const i of e)t(i)},this._tmpEvent.extent),this._tmpEvent.spatialReference=this.spatialReference,this.emit("elevation-change",this._tmpEvent))}notifyObjectsChangedFunctional(e){this.spatialReference&&(this._computeLayerExtent(e,this._tmpEvent.extent),this._tmpEvent.spatialReference=this.spatialReference,this.emit("elevation-change",this._tmpEvent))}notifyObjectChanged(e){this.spatialReference&&(this._computeObjectExtent(e,this._tmpEvent.extent),this._tmpEvent.spatialReference=this.spatialReference,this.emit("elevation-change",this._tmpEvent))}_computeObjectExtent(e,t){(0,d.Ie)(t),this._expandExtent(e,t)}_computeLayerExtent(e,t){(0,d.Ie)(t),e(e=>{this._expandExtent(e,t)})}_expandExtent(e,t){const i=this.spatialReference;if(null==i)return;if(null==e)return;(0,l.I0)(C,e.quaternion),C[12]=e.center[0],C[13]=e.center[1],C[14]=e.center[2];const n=e.halfSize;for(let s=0;s<8;++s)E[0]=1&s?n[0]:-n[0],E[1]=2&s?n[1]:-n[1],E[2]=4&s?n[2]:-n[2],(0,u.t)(E,E,C),this._renderCoordsHelper.fromRenderCoords(E,E,i),(0,d.fT)(t,E,t)}};(0,n.Cg)([(0,o.MZ)({constructOnly:!0})],m.prototype,"layerElevationSource",void 0),(0,n.Cg)([(0,o.MZ)({constructOnly:!0})],m.prototype,"intersectionHandler",void 0),(0,n.Cg)([(0,o.MZ)({constructOnly:!0})],m.prototype,"view",void 0),(0,n.Cg)([(0,o.MZ)()],m.prototype,"spatialReference",null),m=(0,n.Cg)([(0,a.$)("esri.views.3d.layers.i3s.LayerElevationProvider")],m);const C=(0,p.vt)(),b=(0,v.f)(0,0,0,0),E=(0,h.vt)(),R=(0,h.vt)(),w=(0,h.vt)()},55002:(e,t,i)=>{i.d(t,{d:()=>n});class n{constructor(e,t){this.position=e,this.rotationScale=t,this.origin=void 0}}},83491:(e,t,i)=>{i.d(t,{w:()=>u});var n=i(6326),s=i(54901),r=i(50346),o=i(68134),a=i(46053),l=(i(81806),i(76460),i(47249),i(87990)),p=i(47700);const u=e=>{const t=e;let i=class extends t{constructor(){super(...arguments),this.slicePlaneEnabled=!1,this.supportsHeightUnitConversion=!1}postscript(){super.postscript(),(0,p.jI)(this.layer)&&this.addResolvingPromise(this._validateHeightModelInfo())}async _validateHeightModelInfo(){const e=new AbortController,t=e.signal;this.addHandles((0,s.hA)(()=>e.abort())),await(0,o.C_)(()=>{var e;return null===(e=this.view.defaultsFromMap)||void 0===e?void 0:e.heightModelInfoReady},t),(0,r.Te)(t);const i=(0,p.Hu)(this.layer,this.view.heightModelInfo,this.supportsHeightUnitConversion);if(i)throw i}};return(0,n.Cg)([(0,a.MZ)()],i.prototype,"view",void 0),(0,n.Cg)([(0,a.MZ)()],i.prototype,"slicePlaneEnabled",void 0),i=(0,n.Cg)([(0,l.$)("esri.views.3d.layers.LayerView3D")],i),i}},91196:(e,t,i)=>{i.d(t,{A:()=>d});var n=i(6326),s=i(54099),r=i(5632),o=i(76460),a=i(30726),l=i(91291),p=i(46053),u=(i(81806),i(47249),i(87990)),h=i(19451),c=i(90992);let d=class extends((0,r.sA)((0,l.g)(s.nJ))){get spatialReferenceSupported(){return!0}constructor(e){super(e),this._updatingHandles=new h.U,this.layer=null,this.parent=null}initialize(){this.when().catch(e=>{if("layerview:create-error"!==e.name){var t;const i=this.layer&&this.layer.id||"no id",n=(null===(t=this.layer)||void 0===t?void 0:t.title)||"no title";o.A.getLogger(this).error("#resolve()","Failed to resolve layer view (layer title: '".concat(n,"', id: '").concat(i,"')"),e)}})}destroy(){this._updatingHandles=(0,a.pR)(this._updatingHandles),this._set("parent",null)}get fullOpacity(){var e,t,i,n;return(null!==(e=null===(t=this.layer)||void 0===t?void 0:t.opacity)&&void 0!==e?e:1)*(null!==(i=null===(n=this.parent)||void 0===n?void 0:n.fullOpacity)&&void 0!==i?i:1)}get suspended(){return this.destroyed||!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){var e;return!this.suspended&&!0===(null===(e=this.layer)||void 0===e?void 0:e.legendEnabled)}get updating(){var e;return!((null===(e=this._updatingHandles)||void 0===e||!e.updating)&&!this.isUpdating())}get updatingProgress(){return this.updating?0:1}get updateSuspended(){return this.suspended}get visible(){var e;return!0===(null===(e=this.layer)||void 0===e?void 0:e.visible)}set visible(e){this._overrideIfSome("visible",e)}get visibleAtCurrentScale(){return!0}get visibleAtCurrentTimeExtent(){var e;const t=this.view.timeExtent,i=null===(e=this.layer)||void 0===e?void 0:e.visibilityTimeExtent;return!t||!i||!t.intersection(i).isEmpty}canResume(){var e,t;const i=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return this.visible&&(null===(e=this.layer)||void 0===e?void 0:e.loaded)&&this.parent&&!this.parent.suspended&&(null===(t=this.view)||void 0===t?void 0:t.ready)&&(0,c.g7)(i)&&this.visibleAtCurrentScale&&this.visibleAtCurrentTimeExtent||!1}getSuspendInfo(){var e,t;const i=null!==(e=this.parent)&&void 0!==e&&e.suspended?this.parent.suspendInfo:{};null!==(t=this.view)&&void 0!==t&&t.ready||(i.viewNotReady=!0),this.layer&&this.layer.loaded||(i.layerNotLoaded=!0);const n=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return(0,c.g7)(n)&&this.visibleAtCurrentScale||(i.outsideScaleRange=!0),this.visibleAtCurrentTimeExtent||(i.outsideVisibilityTimeExtent=!0),this.visible||(i.layerInvisible=!0),i}isUpdating(){return!1}};(0,n.Cg)([(0,p.MZ)({readOnly:!0})],d.prototype,"spatialReferenceSupported",null),(0,n.Cg)([(0,p.MZ)()],d.prototype,"view",void 0),(0,n.Cg)([(0,p.MZ)()],d.prototype,"fullOpacity",null),(0,n.Cg)([(0,p.MZ)()],d.prototype,"layer",void 0),(0,n.Cg)([(0,p.MZ)()],d.prototype,"parent",void 0),(0,n.Cg)([(0,p.MZ)({readOnly:!0})],d.prototype,"suspended",null),(0,n.Cg)([(0,p.MZ)({readOnly:!0})],d.prototype,"suspendInfo",null),(0,n.Cg)([(0,p.MZ)({readOnly:!0})],d.prototype,"legendEnabled",null),(0,n.Cg)([(0,p.MZ)({type:Boolean,readOnly:!0})],d.prototype,"updating",null),(0,n.Cg)([(0,p.MZ)({readOnly:!0})],d.prototype,"updatingProgress",null),(0,n.Cg)([(0,p.MZ)()],d.prototype,"updateSuspended",null),(0,n.Cg)([(0,p.MZ)()],d.prototype,"visible",null),(0,n.Cg)([(0,p.MZ)({readOnly:!0})],d.prototype,"visibleAtCurrentScale",null),(0,n.Cg)([(0,p.MZ)({readOnly:!0})],d.prototype,"visibleAtCurrentTimeExtent",null),d=(0,n.Cg)([(0,u.$)("esri.views.layers.LayerView")],d)},97048:(e,t,i)=>{i.d(t,{Ir:()=>v,_b:()=>p,sQ:()=>u,xb:()=>h});var n=i(76460),s=i(68930),r=i(9392),o=i(12016),a=i(56611),l=i(14487);class p{constructor(e,t,i,n,s,r){this.layout=e,this.interleavedVertexData=t,this.indices=i,this.hasColors=n,this.hasModifications=s,this.positionData=r}}class u{constructor(e,t,i,n,s,r,o){this.componentOffsets=e,this.featureIds=t,this.anchorIds=i,this.anchors=n,this.transformedGeometry=s,this.globalTrafo=r,this.obb=o}}class h extends o.B{constructor(e){super("SceneLayerWorker","process",{process:e=>[e.geometryBuffer],project:e=>[e.positions.buffer],transformNormals:e=>[e.normals.buffer]},e,{hasInitialize:!0})}setModifications(e,t,i){const n={context:e,modifications:t,isGeodetic:i};return this.broadcast(n,"setModifications")}setLegacySchema(e,t){const i=JSON.stringify(t);return this.broadcast({context:e,jsonSchema:i},"setLegacySchema")}destroyContext(e){return this.broadcast(e,"destroyContext")}async destroyContextAndSelf(e){await this.destroyContext(e),this.destroy()}project(e,t){return this.invokeMethod("project",e,t)}transformNormals(e,t){return this.invokeMethod("transformNormals",e,t)}}const c=new s.A({deallocator:null}),d=(0,r.vt)();function v(e,t,i){c.clear();let s=1/0,r=1/0,o=-1/0,p=-1/0,u=!1;for(const v of t){const e="clip"===v.type?2:"mask"===v.type?1:0,t=v.geometry;let h=e=>e;if(t.spatialReference){if(!(0,a.canProjectWithoutEngine)(t.spatialReference,i)){n.A.getLogger("esri.views.3d.layers.I3SMeshWorkerHandle").warn("im-modification-projection-failed","Can't project modification polygon into layer spatial reference, ignoring modification",{polygon:t});continue}h=e=>((0,l.F)(e,t.spatialReference,d,i),d)}else t.hasZ||(d[2]=0,h=e=>(d[0]=e[0],d[1]=e[1],d));u=u||1===e;const g=t.rings.length,y=t.rings.some(e=>e.length<3);if(0===g||y)n.A.getLogger("esri.views.3d.layers.I3SMeshWorkerHandle").warn("im-modification-invalid-polygon","Ignoring invalid modification polygon (no rings or rings with less than 3 vertices).",{polygon:t});else{c.push(e),c.push(g);for(const e of t.rings){c.push(e.length);for(const t of e){const e=h(t);c.push(e[0]),c.push(e[1]),c.push(e[2]),s=Math.min(s,e[0]),r=Math.min(r,e[1]),o=Math.max(o,e[0]),p=Math.max(p,e[1])}}}}if(null!=e)if(u){const t=1e-4;c.push(2),c.push(2),c.push(4),c.push(s-t),c.push(r-t),c.push(0),c.push(o+t),c.push(r-t),c.push(0),c.push(o+t),c.push(p+t),c.push(0),c.push(s-t),c.push(p+t),c.push(0),c.push(4),c.push(e[0]),c.push(e[1]),c.push(0),c.push(e[2]),c.push(e[1]),c.push(0),c.push(e[2]),c.push(e[3]),c.push(0),c.push(e[0]),c.push(e[3]),c.push(0)}else c.push(1),c.push(1),c.push(4),c.push(e[0]),c.push(e[1]),c.push(0),c.push(e[2]),c.push(e[1]),c.push(0),c.push(e[2]),c.push(e[3]),c.push(0),c.push(e[0]),c.push(e[3]),c.push(0);c.push(3);const h=new Float64Array(c.length);for(let n=0;n<c.length;++n)h[n]=c.at(n);return h}}}]);
//# sourceMappingURL=4838.f17a4921.chunk.js.map