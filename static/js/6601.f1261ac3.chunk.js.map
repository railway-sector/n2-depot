{"version":3,"file":"static/js/6601.f1261ac3.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/views/3d/layers/support/ImageHighlightHelper3D.js","../node_modules/@arcgis/core/views/layers/support/highlightUtils.js","../node_modules/@arcgis/core/views/3d/layers/ImagerySubView3D.js","../node_modules/@arcgis/core/views/3d/support/flow/FlowSubViewExtent3D.js","../node_modules/@arcgis/core/views/layers/ImageryLayerView.js","../node_modules/@arcgis/core/views/3d/layers/ImageryLayerView3D.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as i}from\"tslib\";import e from\"../../../../Color.js\";import t from\"../../../../core/Accessor.js\";import{isSome as r}from\"../../../../core/arrayUtils.js\";import{makeHandle as s,destroyHandle as o}from\"../../../../core/handleUtils.js\";import{watch as h,syncAndInitial as p}from\"../../../../core/reactiveUtils.js\";import{property as a}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/has.js\";import\"../../../../core/Logger.js\";import{subclass as l}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{initializeProjection as n,project as c}from\"../../../../geometry/projectionUtils.js\";import{GraphicsCollection as g}from\"../../../../support/GraphicsCollection.js\";import m from\"../../../../symbols/SimpleFillSymbol.js\";import d from\"../../../../symbols/SimpleLineSymbol.js\";import u from\"../../../../symbols/SimpleMarkerSymbol.js\";import{getHighlightGraphics as y}from\"../../../layers/support/highlightUtils.js\";let w=class extends t{get updating(){return this.graphicsView?.updating??!1}constructor(i){super(i),this._highlightCounts=new Map,this._graphicsViewLoader=null,this.graphics=new g,this.graphicsView=null,this.suspended=!1;const t=new e([255,255,255,1/255]);this._symbols=new Map([[\"point\",new u({size:\"2px\",style:\"square\",color:t})],[\"polyline\",new d({width:\"2px\",color:t})],[\"polygon\",new m({outline:null,color:t})]])}highlight(i,e){const t=y(i);if(0===t.length)return s();let r,o=!1;return this.updatingHandles.addPromise(Promise.all([this._createHighlightGraphics(t),this._ensureGraphicsView3D()]).then(([i,t])=>{!o&&t&&(r=this._addHighlightGraphics(t,i,e))})),s(()=>{o=!0,r?.remove()})}preload(){this._ensureGraphicsView3D()}_addHighlightGraphics(i,e,t){for(const s of e)this._highlightCounts.set(s,(this._highlightCounts.get(s)??0)+1);this.graphics.addMany(e);const r=i.highlight(e,t);return s(()=>{this._removeHighlightGraphics(e),r.remove()})}_removeHighlightGraphics(i){this.graphics.removeMany(i.filter(i=>{const e=Math.max(0,(this._highlightCounts.get(i)??0)-1);return 0===e?(this._highlightCounts.delete(i),!0):(this._highlightCounts.set(i,e),!1)}))}async _ensureGraphicsView3D(){if(this.graphicsView)return this.graphicsView;this._graphicsViewLoader||(this._graphicsViewLoader=import(\"../GraphicsView3D.js\"));const{default:i}=await this._graphicsViewLoader;if(this.destroyed)return null;const e=new i({view:this.view,layer:{type:\"graphics-view-3d-dummy\",id:this.layer.id,uid:this.layer.uid,elevationInfo:{mode:\"on-the-ground\"}},getGraphics:()=>this.graphics,drapeSourcePriorityOffset:.5});return this._set(\"graphicsView\",e),this.addHandles([o(this.graphicsView),h(()=>this.suspended,i=>{e.suspended=i},p)]),e}async _createHighlightGraphics(i){const e=i.map(({geometry:i})=>i?.spatialReference).filter(r).reduce((i,e)=>(0!==i.length&&i.at(-1)?.equals(e)||i.push(e),i),[]),t=this.view.spatialReference,s=e.map(i=>({source:i,dest:t}));try{await n(s)}catch{return[]}return i.map(i=>{const{geometry:e}=i;try{const r=e?c(e,t):null,s=i.cloneShallow();return s.geometry=r,s.symbol=this._symbols.get(r?.type),s}catch{return i}})}};i([a()],w.prototype,\"graphics\",void 0),i([a()],w.prototype,\"graphicsView\",void 0),i([a()],w.prototype,\"view\",void 0),i([a()],w.prototype,\"layer\",void 0),i([a()],w.prototype,\"updatingHandles\",void 0),i([a()],w.prototype,\"suspended\",void 0),i([a()],w.prototype,\"updating\",null),w=i([l(\"esri.views.3d.layers.support.ImageHighlightHelper3D\")],w);export{w as ImageHighlightHelper3D};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{isSome as r}from\"../../../core/arrayUtils.js\";import o from\"../../../core/Collection.js\";import{isGraphic as t}from\"../../../support/guards.js\";function i(i){if(!i)return[];let e=t(i)?[i]:o.isCollection(i)?i.toArray():Array.isArray(i)?i:[];return e=e?.filter(r),0===(e?.length??0)?[]:e}export{i as getHighlightGraphics};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as e}from\"tslib\";import{debounce as a}from\"../../../core/promiseUtils.js\";import{when as i}from\"../../../core/reactiveUtils.js\";import\"../../../core/Logger.js\";import\"../../../core/has.js\";import\"../../../core/RandomLCG.js\";import\"../../../core/Error.js\";import{subclass as t}from\"../../../core/accessorSupport/decorators/subclass.js\";import r from\"./DrapedSubView3D.js\";let s=class extends r{constructor(e){super(e),this.redrawDebounced=a(async e=>{this.redraw((e,a)=>this._redrawImage(e,a),e)},2e3)}initialize(){this.addHandles([i(()=>this.view.basemapTerrain.ready,()=>this._initializeMaximumDataResolution(),{once:!0,initial:!0}),this.layer.on(\"redraw\",()=>this.updatingHandles.addPromise(this.redrawDebounced()))])}_initializeMaximumDataResolution(){this.maximumDataResolution=this.layer.loaded?this.layer.serviceRasterInfo.pixelSize:null}async processResult(e,a,i){a.imageOrCanvasElement?e.image=a.imageOrCanvasElement:(e.image=document.createElement(\"canvas\"),e.pixelData=a.pixelData,await this._redrawImage(e,i))}async _redrawImage(e,a){if(!(e.image instanceof HTMLCanvasElement)||null==e.pixelData)throw new Error;const i=e.image,t=i.getContext(\"2d\"),r=await this.layer.applyRenderer(e.pixelData,{signal:a}),s=this.layer.applyFilter(r).pixelBlock;if(null==s)throw new Error;i.width=s.width,i.height=s.height;const o=t.createImageData(s.width,s.height);o.data.set(s.getAsRGBA()),t.putImageData(o,0,0)}};s=e([t(\"esri.views.3d.layers.ImagerySubView3D\")],s);export{s as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as e}from\"tslib\";import{makeHandle as t}from\"../../../../core/handleUtils.js\";import\"../../../../core/Logger.js\";import\"../../../../core/has.js\";import\"../../../../core/RandomLCG.js\";import\"../../../../core/Error.js\";import{subclass as r}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{loadImagery as s}from\"../../../2d/engine/flow/dataUtils.js\";import o from\"../../layers/FlowSubView3D.js\";let i=class extends o{constructor(e){super(e)}initialize(){this.updatingHandles.add(()=>this.renderedTiles,()=>this.triggerLoad()),this.updatingHandles.add(()=>this.elevationInfo.mode,e=>this._updatePopupDrapeSource(e),{initial:!0})}_updatePopupDrapeSource(e){if(\"on-the-ground\"===e)return void this.removeHandles(a);if(this.hasHandles(a))return;const r={destroyed:!1,drapeSourceType:2,updatePolicy:0,layer:this.layer},s=this.layerView.view.overlayManager;s.registerGeometryDrapeSource(r),this.addHandles(t(()=>s.unregisterDrapeSource(r)),a)}async fetchDataAndGenerateStreamlines(e,t){const{needsMagnitude:r,workerHandle:o}=this,i=this.getSimulationSettings(e),{size:a,extent:n,timeExtent:l}=e;if(null==i||null==o)return;const d=await s(this.layer,n,a[0],a[1],l,t);if(null==d)return null;const u={simulationSettings:i,flowExtentInfo:e.flowExtentInfo,flowData:d,needsMagnitude:r,startPositions:this.startPositions(e)},{streamlines:p}=await o.generateStreamlines(u,t);return p}};i=e([r(\"esri.views.3d.support.flow.FlowSubViewExtent3D\")],i);const a=Symbol(\"popupDrapeSource\");export{i as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as e}from\"tslib\";import t from\"../../core/Error.js\";import{throwIfAborted as r}from\"../../core/promiseUtils.js\";import{property as o}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/RandomLCG.js\";import{subclass as s}from\"../../core/accessorSupport/decorators/subclass.js\";import i from\"../../geometry/Point.js\";import a from\"../../layers/support/FieldsIndex.js\";import{rasterFieldPrefix as p}from\"../../layers/support/rasterFieldUtils.js\";import{combineTimeExtent as n}from\"../../layers/support/timeSupport.js\";import{load as l,getSourceScale as m}from\"../../layers/support/rasterFunctions/rasterProjectionHelper.js\";import u from\"../../rest/support/Query.js\";import{getFetchPopupTemplate as c}from\"./support/popupUtils.js\";const y=y=>{const d=y;let f=class extends d{constructor(...e){super(...e),this.view=null}get timeExtent(){return n(this.layer,this.view?.timeExtent,this._get(\"timeExtent\"))}async fetchPopupFeaturesAtLocation(e,o){const{layer:s}=this;if(!e)throw new t(\"imagerylayerview:fetchPopupFeatures\",\"Nothing to fetch without area\",{layer:s});const{popupEnabled:n}=s,l=c(s,o);if(!n||null==l)return[];const m=await l.getRequiredFields(null,{index:new a(s.rasterFields),partitions:new Map([[\"$pixel\",s.rasterFields.filter(e=>e.name.startsWith(p)).map(e=>e.name)],[\"$imageCollectionItem\",s.fields.map(e=>e.name)]])});r(o);const y=new u;y.timeExtent=this.timeExtent,y.geometry=e,y.outFields=m,y.outSpatialReference=e.spatialReference;const{resolution:d,spatialReference:f}=this.view,h=\"2d\"===this.view.type?new i(d,d,f):new i(.5*d,.5*d,f),{returnTopmostRaster:w,showNoDataRecords:R}=l.layerOptions||{returnTopmostRaster:!0,showNoDataRecords:!1},j={returnDomainValues:!0,returnTopmostRaster:w,pixelSize:h,showNoDataRecords:R,signal:o?.signal};return s.queryVisibleRasters(y,j)}async getSourceScale(){return await l(),await this.layer.load(),m(this.layer.serviceRasterInfo,this.view.spatialReference)}canResume(){return!!super.canResume()&&!this.timeExtent?.isEmpty}};return e([o()],f.prototype,\"layer\",void 0),e([o()],f.prototype,\"suspended\",void 0),e([o({readOnly:!0})],f.prototype,\"timeExtent\",null),e([o()],f.prototype,\"view\",void 0),f=e([s(\"esri.views.layers.ImageryLayerView\")],f),f};export{y as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as e}from\"tslib\";import{destroyHandle as t}from\"../../../core/handleUtils.js\";import{watch as i,syncAndInitial as r,initial as s}from\"../../../core/reactiveUtils.js\";import{property as o}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/Logger.js\";import\"../../../core/RandomLCG.js\";import{subclass as a}from\"../../../core/accessorSupport/decorators/subclass.js\";import h from\"./DynamicLayerView3D.js\";import l from\"./ImagerySubView3D.js\";import{ImageHighlightHelper3D as p}from\"./support/ImageHighlightHelper3D.js\";import n from\"../support/flow/FlowSubViewExtent3D.js\";import d from\"../../layers/ImageryLayerView.js\";let g=class extends(d(h)){constructor(){super(...arguments),this.type=\"imagery-3d\"}get highlightOptions(){return null}get pixelData(){return null}initialize(){const e=()=>this._updatingHandles.addPromise(this.refreshDebounced());this._updatingHandles.add(()=>this.layer?.exportImageServiceParameters?.version,e),this._updatingHandles.add(()=>this.layer?.renderer,e),this._updatingHandles.add(()=>this.timeExtent,e),this._highlightHelper=new p({view:this.view,layer:this.layer,updatingHandles:this._updatingHandles}),this.addHandles([t(this._highlightHelper),i(()=>this.suspended,e=>this._highlightHelper.suspended=e,r)])}_initSubView(){this.addHandles([i(()=>this.layer.renderer,e=>this._recreateSubView(e),s)])}_recreateSubView(e){const t=\"flow\"===e?.type,i=\"flow\"===this.subView?.type,r=this.subView;r&&t===i||(this.subView=t?new n({layerView:this}):new l({layerView:this}),r?.destroy())}getFetchOptions(){return{timeExtent:this.timeExtent}}highlight(e,t){return this._highlightHelper.highlight(e,t)}isUpdating(){return super.isUpdating()||this._highlightHelper.updating}};e([o()],g.prototype,\"highlightOptions\",null),e([o()],g.prototype,\"pixelData\",null),g=e([a(\"esri.views.3d.layers.ImageryLayerView3D\")],g);const m=g;export{m as default};\n"],"names":["w","t","updating","_this$graphicsView$up","_this$graphicsView","this","graphicsView","constructor","i","super","_highlightCounts","Map","_graphicsViewLoader","graphics","g","suspended","e","_symbols","u","size","style","color","d","width","m","outline","highlight","_e","_e$length","_e2","o","isCollection","toArray","Array","isArray","filter","r","length","y","s","updatingHandles","addPromise","Promise","all","_createHighlightGraphics","_ensureGraphicsView3D","then","_ref","_addHighlightGraphics","_r","remove","preload","_this$_highlightCount","set","get","addMany","_removeHighlightGraphics","removeMany","_this$_highlightCount2","Math","max","delete","default","destroyed","view","layer","type","id","uid","elevationInfo","mode","getGraphics","drapeSourcePriorityOffset","_set","addHandles","h","p","map","_ref2","geometry","spatialReference","reduce","_i$at","at","equals","push","source","dest","n","_unused","c","cloneShallow","symbol","_unused2","a","prototype","l","redrawDebounced","async","redraw","_redrawImage","initialize","basemapTerrain","ready","_initializeMaximumDataResolution","once","initial","on","maximumDataResolution","loaded","serviceRasterInfo","pixelSize","processResult","imageOrCanvasElement","image","document","createElement","pixelData","HTMLCanvasElement","Error","getContext","applyRenderer","signal","applyFilter","pixelBlock","height","createImageData","data","getAsRGBA","putImageData","add","renderedTiles","triggerLoad","_updatePopupDrapeSource","removeHandles","hasHandles","drapeSourceType","updatePolicy","layerView","overlayManager","registerGeometryDrapeSource","unregisterDrapeSource","fetchDataAndGenerateStreamlines","needsMagnitude","workerHandle","getSimulationSettings","extent","timeExtent","simulationSettings","flowExtentInfo","flowData","startPositions","streamlines","generateStreamlines","Symbol","f","arguments","_this$view","_get","fetchPopupFeaturesAtLocation","popupEnabled","getRequiredFields","index","rasterFields","partitions","name","startsWith","fields","outFields","outSpatialReference","resolution","returnTopmostRaster","showNoDataRecords","R","layerOptions","j","returnDomainValues","queryVisibleRasters","getSourceScale","load","canResume","_this$timeExtent","isEmpty","readOnly","highlightOptions","_updatingHandles","refreshDebounced","_this$layer","exportImageServiceParameters","version","_this$layer2","renderer","_highlightHelper","_initSubView","_recreateSubView","_this$subView","subView","destroy","getFetchOptions","isUpdating"],"sourceRoot":""}