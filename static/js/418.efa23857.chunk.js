"use strict";(self.webpackChunkn2_depot=self.webpackChunkn2_depot||[]).push([[418],{46533:(t,e,n)=>{n.d(e,{CW:()=>m,DE:()=>x,GA:()=>w,S1:()=>g,pH:()=>y});var o=n(89379),i=n(81806),r=n(76460),s=n(15941),l=n(50346),a=n(47249),c=n(76797),f=n(80963);const u=()=>r.A.getLogger("esri.views.2d.engine.flow.dataUtils"),h=10;async function m(t,e,n,o){const r=performance.now(),s=x(e,n),c=performance.now(),f=g(e,s,n.width,n.height),m=performance.now(),p=function(t,e){const n=new a.A,o=t.reduce((t,e)=>t+e.vertices.length,0),i=new Float32Array(4*o),r=new Array(t.length);let s=0,l=0;for(const{vertices:a}of t){const t=s;for(const e of a)i[4*s]=e.x,i[4*s+1]=e.y,i[4*s+2]=e.t,i[4*s+3]=e.speed,s++;r[l++]={startVertex:t,numberOfVertices:a.length,totalTime:a[a.length-1].t,timeSeed:e?n.getFloat():0}}return{lineVertices:i,lineDescriptors:r}}(f,!0),d=performance.now(),w="Streamlines"===t?function(t,e){const n=9,{lineVertices:o,lineDescriptors:i}=t;let r=0,s=0;for(const m of i)r+=2*m.numberOfVertices,s+=6*(m.numberOfVertices-1);const l=new Float32Array(r*n),a=new Uint32Array(s);let c=0,f=0;function u(){a[f++]=c-2,a[f++]=c,a[f++]=c-1,a[f++]=c,a[f++]=c+1,a[f++]=c-1}function h(t,e,o,i,r,s,a,f){const u=c*n;let h=0;l[u+h++]=t,l[u+h++]=e,l[u+h++]=1,l[u+h++]=o,l[u+h++]=s,l[u+h++]=a,l[u+h++]=i/2,l[u+h++]=r/2,l[u+h++]=f,c++,l[u+h++]=t,l[u+h++]=e,l[u+h++]=-1,l[u+h++]=o,l[u+h++]=s,l[u+h++]=a,l[u+h++]=-i/2,l[u+h++]=-r/2,l[u+h++]=f,c++}for(const m of i){const{totalTime:t,timeSeed:n}=m;let i=null,r=null,s=null,l=null,a=null,c=null;for(let f=0;f<m.numberOfVertices;f++){const x=o[4*(m.startVertex+f)],p=o[4*(m.startVertex+f)+1],d=o[4*(m.startVertex+f)+2],g=o[4*(m.startVertex+f)+3];let w=null,y=null,M=null,v=null;if(f>0){w=x-i,y=p-r;const o=Math.sqrt(w*w+y*y);if(w/=o,y/=o,f>1){let t=w+a,n=y+c;const o=Math.sqrt(t*t+n*n);t/=o,n/=o;const i=Math.min(1/(t*w+n*y),e);t*=i,n*=i,M=-n,v=t}else M=-y,v=w;null!==M&&null!==v&&(h(i,r,s,M,v,t,n,g),u())}i=x,r=p,s=d,a=w,c=y,l=g}h(i,r,s,-c,a,t,n,l)}return{vertexData:l,indexData:a}}(p,h):function(t){const e=16,n=1,o=2,{lineVertices:i,lineDescriptors:r}=t;let s=0,l=0;for(const I of r){const t=I.numberOfVertices-1;s+=4*t*2,l+=6*t*2}const a=new Float32Array(s*e),c=new Uint32Array(l);let f,u,h,m,x,p,d,g,w,y,M,v,A,P,R=0,b=0;function k(){c[b++]=R-8,c[b++]=R-7,c[b++]=R-6,c[b++]=R-7,c[b++]=R-5,c[b++]=R-6,c[b++]=R-4,c[b++]=R-3,c[b++]=R-2,c[b++]=R-3,c[b++]=R-1,c[b++]=R-2}function S(t,i,r,s,l,c,f,u,h,m,x,p,d,g){const w=R*e;let y=0;for(const e of[n,o])for(const n of[1,2,3,4])a[w+y++]=t,a[w+y++]=i,a[w+y++]=r,a[w+y++]=s,a[w+y++]=f,a[w+y++]=u,a[w+y++]=h,a[w+y++]=m,a[w+y++]=e,a[w+y++]=n,a[w+y++]=d,a[w+y++]=g,a[w+y++]=l/2,a[w+y++]=c/2,a[w+y++]=x/2,a[w+y++]=p/2,R++}function G(t,e){let n=w+M,o=y+v;const i=Math.sqrt(n*n+o*o);n/=i,o/=i;const r=w*n+y*o;n/=r,o/=r;let s=M+A,l=v+P;const a=Math.sqrt(s*s+l*l);s/=a,l/=a;const c=M*s+v*l;s/=c,l/=c,S(f,u,h,m,-o,n,x,p,d,g,-l,s,t,e),k()}function T(t,e,n,o,i,r){if(w=M,y=v,M=A,v=P,null==w&&null==y&&(w=M,y=v),null!=x&&null!=p){A=t-x,P=e-p;const n=Math.sqrt(A*A+P*P);A/=n,P/=n}null!=w&&null!=y&&G(i,r),f=x,u=p,h=d,m=g,x=t,p=e,d=n,g=o}function E(t,e){w=M,y=v,M=A,v=P,null==w&&null==y&&(w=M,y=v),null!=w&&null!=y&&G(t,e)}for(const I of r){f=null,u=null,h=null,m=null,x=null,p=null,d=null,g=null,w=null,y=null,M=null,v=null,A=null,P=null;const{totalTime:t,timeSeed:e}=I;for(let n=0;n<I.numberOfVertices;n++)T(i[4*(I.startVertex+n)],i[4*(I.startVertex+n)+1],i[4*(I.startVertex+n)+2],i[4*(I.startVertex+n)+3],t,e);E(t,e)}return{vertexData:a,indexData:c}}(p),y=performance.now();return(0,i.A)("esri-2d-profiler")&&(u().info("I.1","_createFlowFieldFromData (ms)",Math.round(c-r)),u().info("I.2","_getStreamlines (ms)",Math.round(m-c)),u().info("I.3","createAnimatedLinesData (ms)",Math.round(d-m)),u().info("I.4","create{Streamlines|Particles}Mesh (ms)",Math.round(y-d)),u().info("I.5","createFlowMesh (ms)",Math.round(y-r)),u().info("I.6","Mesh size (bytes)",w.vertexData.buffer.byteLength+w.indexData.buffer.byteLength)),await Promise.resolve(),(0,l.Te)(o),w}function x(t,e){const n=function(t,e,n,o){if(0===o)return t;const i=Math.round(3*o),r=new Array(2*i+1);let s=0;for(let c=-i;c<=i;c++){const t=Math.exp(-c*c/(o*o));r[c+i]=t,s+=t}for(let c=-i;c<=i;c++)r[c+i]/=s;const l=new Float32Array(t.length);for(let c=0;c<n;c++)for(let n=0;n<e;n++){let o=0,s=0;for(let l=-i;l<=i;l++){if(n+l<0||n+l>=e)continue;const a=r[l+i];o+=a*t[2*(c*e+(n+l))],s+=a*t[2*(c*e+(n+l))+1]}l[2*(c*e+n)]=o,l[2*(c*e+n)+1]=s}const a=new Float32Array(t.length);for(let c=0;c<e;c++)for(let t=0;t<n;t++){let o=0,s=0;for(let a=-i;a<=i;a++){if(t+a<0||t+a>=n)continue;const f=r[a+i];o+=f*l[2*((t+a)*e+c)],s+=f*l[2*((t+a)*e+c)+1]}a[2*(t*e+c)]=o,a[2*(t*e+c)+1]=s}return a}(e.data,e.width,e.height,t.smoothing);return t.interpolate?(t,o)=>{const i=Math.floor(t),r=Math.floor(o);if(i<0||i>=e.width)return[0,0];if(r<0||r>=e.height)return[0,0];const s=t-i,l=o-r,a=i,c=r,f=i<e.width-1?i+1:i,u=r<e.height-1?r+1:r,h=n[2*(c*e.width+a)],m=n[2*(c*e.width+f)],x=n[2*(u*e.width+a)],p=n[2*(u*e.width+f)],d=n[2*(c*e.width+a)+1],g=n[2*(c*e.width+f)+1];return[(h*(1-l)+x*l)*(1-s)+(m*(1-l)+p*l)*s,(d*(1-l)+n[2*(u*e.width+a)+1]*l)*(1-s)+(g*(1-l)+n[2*(u*e.width+f)+1]*l)*s]}:(t,o)=>{const i=Math.round(t),r=Math.round(o);return i<0||i>=e.width||r<0||r>=e.height?[0,0]:[n[2*(r*e.width+i)],n[2*(r*e.width+i)+1]]}}function p(t,e,n,o,i,r,l,a){const c=[],{raster:f,width:u,height:h,resolutionFactor:m}=a;let x=o,p=i,d=0,[g,w]=n(x,p);g*=e.velocityScale,w*=e.velocityScale;const y=Math.sqrt(g*g+w*w);let M,v;c.push({x:x,y:p,t:d,speed:y});for(let A=0;A<e.verticesPerLine;A++){let[o,i]=n(x,p);o*=e.velocityScale,i*=e.velocityScale;const a=Math.sqrt(o*o+i*i);if(a<e.minSpeedThreshold)return c;const g=t*o/a,w=t*i/a;if(x+=g*e.segmentLength,p+=w*e.segmentLength,e.wrapAround&&(x=(0,s.OS)(x,r[0])),d+=t*e.segmentLength/a,Math.acos(g*M+w*v)>e.maxTurnAngle)return c;if(e.collisions){let t=Math.round(x*m);const n=Math.round(p*m);if(e.wrapAround&&(t=(0,s.OS)(t,u)),t<0||t>u-1||n<0||n>h-1)return c;const o=f[n*u+t];if(-1!==o&&o!==l)return c;f[n*u+t]=l}c.push({x:x,y:p,t:d,speed:a}),M=g,v=w}return c}function d(t,e,n,i,r,s,l,a){const c=Math.round((.2+.6*l.getFloat())*t.verticesPerLine),f=t.verticesPerLine-c,u=p(-1,(0,o.A)((0,o.A)({},t),{},{verticesPerLine:f}),e,n,i,r,s,a),h=p(1,(0,o.A)((0,o.A)({},t),{},{verticesPerLine:c}),e,n,i,r,s,a),m=u.reverse();return m.splice(-1,1),m.concat(h)}function g(t,e,n,o){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{positions:[]};if(t.density<=0)return[];const{positions:r}=i,s=[],l=new a.A,c=1/Math.max(t.lineCollisionWidth,1),f=Math.round(n*c),u=Math.round(o*c),h=new Int32Array(f*u);for(let a=0;a<h.length;a++)h[a]=-1;const m={raster:h,width:f,height:u,resolutionFactor:c},x={},g=t.lineSpacing/Math.sqrt(t.density),w=Math.floor(o/g),y=Math.floor(n/g);for(let a=0;a<w;a++){const t=a*g;for(let e=0;e<y;e++){const n=e*g;x["".concat(e,"-").concat(a)]={x:n,y:t,positions:[]}}}for(const{x:a,y:p}of r){const t=x["".concat(Math.floor(a/g),"-").concat(Math.floor(p/g))];t&&t.positions.push([a,p])}const M=[];for(const a in x){const t=x[a];if(0===t.positions.length)M.push({x:t.x+g/2,y:t.y+g/2,sort:.66+.33*l.getFloat(),stage:0});else{const[e]=t.positions.splice(0,1);M.push({x:e[0],y:e[1],sort:.33*l.getFloat(),stage:1});for(const[n,o]of t.positions)M.push({x:n,y:o,sort:.33+.33*l.getFloat(),stage:2})}}M.sort((t,e)=>t.sort-e.sort);for(const{x:a,y:v,stage:A}of M){const i=t.onlyForwardTracing?p(1,t,e,a,v,[n,o],s.length,m):d(t,e,a,v,[n,o],s.length,l,m);i.length<2||s.push({stage:A,vertices:i})}return s}function w(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.width,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.height,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const l=e.pixels,a=n*o,c=new Float32Array(2*a),f=e.width,u=(t,e)=>t+i+(e+r)*f,h=(t,e)=>t+e*n;let m;if(null!=e.mask)if(n!==e.width||o!==e.height||0!==i||0!==r){m=new Uint8Array(2*a);const t=e.mask;for(let e=0;e<o;++e)for(let o=0;o<n;++o){const n=u(o,e),i=h(o,e);m[2*i]=t[2*n],m[2*i+1]=t[2*n+1]}}else m=e.mask;else m=new Uint8Array(2*a),m.fill(255);if("vector-uv"===t)for(let s=0;s<o;++s)for(let t=0;t<n;++t){const e=u(t,s),n=h(t,s);c[2*n]=l[0][e],c[2*n+1]=-l[1][e]}else if("vector-magdir"===t){const{cos:t,sin:e}=Math;for(let i=0;i<o;++i)for(let o=0;o<n;++o){const n=u(o,i),r=h(o,i),a=l[0][n],f=(0,s.kU)(l[1][n]),m=t(f-Math.PI/2),x=e(f-Math.PI/2);c[2*r]=m*a,c[2*r+1]=x*a}}return{data:c,mask:m,width:n,height:o}}async function y(t,e,n,o,r,s){const l=performance.now(),a=(0,f.Vp)(e.spatialReference);if(!a){const a=await M(t,e,n,o,r,s);return(0,i.A)("esri-2d-profiler")&&u().info("I.7","loadImagery, early exit (ms)",Math.round(performance.now()-l)),(0,i.A)("esri-2d-profiler")&&u().info("I.9","Number of parts",1),a}const[h,m]=a.valid,x=m-h,p=Math.ceil(e.width/x),d=e.width/p,g=Math.round(n/p);let w=e.xmin;const y=[],v=performance.now();for(let i=0;i<p;i++){const n=new c.A({xmin:w,xmax:w+d,ymin:e.ymin,ymax:e.ymax,spatialReference:e.spatialReference});y.push(M(t,n,g,o,r,s)),w+=d}const A=await Promise.all(y);if((0,i.A)("esri-2d-profiler")&&u().info("I.8","All calls to _fetchPart (ms)",Math.round(performance.now()-v)),(0,i.A)("esri-2d-profiler")&&u().info("I.9","Number of parts",A.length),1===A.length)return(0,i.A)("esri-2d-profiler")&&u().info("I.10","loadImagery, general exit without stitching back (ms)",Math.round(performance.now()-l)),A[0];const P={data:new Float32Array(n*o*2),mask:new Uint8Array(n*o),width:n,height:o};let R=0;for(const i of A){for(let t=0;t<i.height;t++)for(let e=0;e<i.width;e++)R+e>=n||(P.data[2*(t*n+R+e)]=i.data[2*(t*i.width+e)],P.data[2*(t*n+R+e)+1]=i.data[2*(t*i.width+e)+1],P.mask[t*n+R+e]=i.mask[t*i.width+e]);R+=i.width}return(0,i.A)("esri-2d-profiler")&&u().info("I.10","loadImagery, general exit (ms)",Math.round(performance.now()-l)),P}async function M(t,e,n,o,i,r){const s={requestProjectedLocalDirections:!0,signal:r};if(null!=i&&(s.timeExtent=i),"imagery"===t.type){var l;await t.load({signal:r});const i=await t.internalFetchImage(e,n,o,s);return null==(null===i||void 0===i||null===(l=i.pixelData)||void 0===l?void 0:l.pixelBlock)?{data:new Float32Array(n*o*2),mask:new Uint8Array(n*o),width:n,height:o}:w(t.rasterInfo.dataType,i.pixelData.pixelBlock)}await t.load({signal:r});const a=await t.fetchPixels(e,n,o,s);return null==(null===a||void 0===a?void 0:a.pixelBlock)?{data:new Float32Array(n*o*2),mask:new Uint8Array(n*o),width:n,height:o}:w(t.serviceRasterInfo.dataType,a.pixelBlock)}},59844:(t,e,n)=>{n.d(e,{DO:()=>Z,FT:()=>H,Hh:()=>E,OM:()=>Q,OO:()=>C,Ps:()=>ot,Wo:()=>N,_I:()=>V,_l:()=>Y,eh:()=>rt,l0:()=>tt,t$:()=>it,uk:()=>J,vI:()=>I});var o=n(89379),i=n(18690),r=n(50076),s=n(50346),l=n(31633),a=n(76797),c=n(7724),f=n(19247),u=n(65215),h=n(56611),m=n(13312),x=n(80963);function p(){if(!T)throw new r.A("rasterprojectionhelper-project","projection operator is not loaded")}const d=function(t,e,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(1===n[0])return[0,0];let i=1,r=-1,s=1,l=-1;for(let d=0;d<t.length;d+=2)isNaN(t[d])||(i=i>t[d]?t[d]:i,r=r>t[d]?r:t[d],s=s>t[d+1]?t[d+1]:s,l=l>t[d+1]?l:t[d+1]);const{cols:a,rows:c}=e,f=(r-i)/a/n[0],u=(l-s)/c/n[1],h=2*o;let m=0,x=!1,p=[0,0];for(let d=0;d<a-3;d++){for(let e=0;e<c-3;e++){const n=d*c*2+2*e,o=(t[n]+t[n+4]+t[n+4*c]+t[n+4*c+4])/4,i=(t[n+1]+t[n+5]+t[n+4*c+1]+t[n+4*c+5])/4,r=Math.abs((o-t[n+2*c+2])/f),s=Math.abs((i-t[n+2*c+3])/u);if(r+s>m&&(m=r+s,p=[r,s]),h&&m>h){x=!0;break}}if(x)break}return p},g={3395:20037508.342789244,3410:17334193.943686873,3857:20037508.342788905,3975:17367530.445161372,4087:20037508.342789244,4088:20015108.787169147,6933:17367530.445161372,32662:20037508.342789244,53001:20015086.79602057,53002:10007543.39801029,53003:20015086.79602057,53004:20015086.79602057,53016:14152803.599503474,53017:17333573.624304302,53034:20015086.79602057,53079:20015114.352186374,53080:20015114.352186374,54001:20037508.342789244,54002:10018754.171394624,54003:20037508.342789244,54004:20037508.342789244,54016:14168658.027268292,54017:17367530.44516137,54034:20037508.342789244,54079:20037508.342789244,54080:20037508.342789244,54100:20037508.342789244,54101:20037508.342789244},w=32,y=4,M=y,v=new Map,A=new Map,P=500,R=39.37,b=96;let k,S,G,T=!1;async function E(){return k||(k=(0,s.Tw)(),S=await n.e(8974).then(n.bind(n,48974)),G=await n.e(7512).then(n.bind(n,67512)),S.isLoaded()||await S.load(),G.isLoaded()||await G.load(),T=!0,k.resolve()),k.promise}function I(t,e,n){if(p(),n){const n=S.execute(t,e);return G.getTransformation(e,t.spatialReference,n)}return G.getTransformation(t.spatialReference,e,t)}function N(t,e,n,o){const i=t.spatialReference;if(!i||!e||i.equals(e))return t;p();const r=n.center,s=new a.A({xmin:r.x-t.x/2,xmax:r.x+t.x/2,ymin:r.y-t.y/2,ymax:r.y+t.y/2,spatialReference:i}),l=S.execute(s,e,{geographicTransformation:o}),c=H(e);return null==l||null!=c&&l.width>=c?_(t,i,e):{x:l.width,y:l.height}}function _(t,e,n){const o=(0,l.GA)(e)/(0,l.GA)(n);return{x:t.x*o,y:t.y*o}}function F(t,e,n){const{spatialReference:o}=n;if(!o||!e||o.equals(e))return t;if(o.isGeographic&&e.isGeographic)return _(t,o,e);if(p(),!T)throw new r.A("raster-projection-helper:project-dataset-resolution","geometry engine is not loaded");let{x:i,y:s}=t;const a=(i+s)/2*(0,l.GA)(o);let c=1;a>30&&(c=30/a,i*=c,s*=c);const f=256,h=i*f/2,m=s*f/2,{x:x,y:d}=n.center,g=[];for(let r=0;r<=f;r++)g.push([x-h,d-m+r*s]);for(let r=1;r<=f;r++)g.push([x-h+r*i,d+m]);for(let r=1;r<=f;r++)g.push([x+h,d+m-r*s]);for(let r=1;r<f;r++)g.push([x+h-r*i,d-m]);g.push(g[0]);const w=new u.A({rings:[g],spatialReference:o}),y=S.execute(w,e);if(!y)return _(t,o,e);const M=y.extent,v=H(e);if(null==M||null!=v&&M.width>=v)return _(t,o,e);const A=function(t){let e=0;for(const n of t){const t=n.length;let o=n[0][0]*(n[1][1]-n[t-2][1]);for(let e=1;e<t-1;e++)o+=n[e][0]*(n[e+1][1]-n[e-1][1]);e+=o/2}return Math.abs(e)}(y.rings),P=i*s*f*f,R=Math.sqrt(A/P)/c,b={x:M.width/c/f,y:M.height/c/f},k={x:i*R,y:s*R},G=b.x*b.y;return Math.abs(G-k.x*k.y)/G<.1?b:k}function L(t,e){return("number"==typeof t?t:(t.x+t.y)/2)*(0,l.GA)(e)*b*R}function C(t,e){const{pixelSize:n,extent:o}=t;return L(F(n,e,o),e)}function O(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.01;return(0,l.GA)(t)?e/(0,l.GA)(t):0}function V(t,e,n){let o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const i=t.spatialReference;if(i.equals(e))return t;p();const r=S.execute(t,e,{geographicTransformation:n});return o&&r?(W([t],[r],i,e),r):r}function W(t,e,n,o){const i=K(n,!0),r=K(o,!0),s=O(n,P),l=O(o,P);if(s&&null!=i&&null!=r)for(let a=0;a<t.length;a++){const n=e[a];if(!n)continue;const{x:o}=t[a],{x:c}=n;c>=r[1]-l&&Math.abs(o-i[0])<s?n.x-=r[1]-r[0]:c<=r[0]+l&&Math.abs(o-i[1])<s&&(n.x+=r[1]-r[0])}}function q(t){const{inSR:e,outSR:n,preferPE:o}=t;if(e.equals(n)){const{points:e}=B(t,null);return e}if(e.isWebMercator&&n.isWGS84||e.isWGS84&&n.isWebMercator)return function(t){const{cols:e,rows:n,xres:o,yres:i,usePixelCenter:r,inSR:s,outSR:l}=t;let{xmin:a,ymax:c}=t;r&&(a+=o/2,c-=i/2);const u=[],m=[],x=Math.max(e,n);for(let d=0;d<x;d++){const t=a+o*Math.min(e,d),r=c-i*Math.min(n,d),x=(0,h.projectWithoutEngine)(new f.A({x:t,y:r,spatialReference:s}),s,l);d<=e&&u.push(x.x),d<=n&&m.push(x.y)}const p=[];for(let f=0;f<e;f++)for(let t=0;t<n;t++)p.push([u[f],m[t]]);return p}(t);if(o){if(e.isGeographic)return z(t);if(null!=D(e))return z(t)}return function(t){const{points:e}=B(t,null),{inSR:n,outSR:o,datumTransformation:i}=t,r=e.map(t=>new f.A(t[0],t[1],n)),s=S.executeMany(r,o,{geographicTransformation:i});return i&&W(r,s,n,o),s.map(t=>t?[t.x,t.y]:[NaN,NaN])}(t)}function z(t){const{inSR:e,outSR:n,datumTransformation:o}=t,i=D(e),{points:r,mask:s}=B(t,i);if(!e.isGeographic){const t=e.wkid?c.P.coordsys(e.wkid):c.P.fromString(e.isGeographic?c.a.PE_TYPE_GEOGCS:c.a.PE_TYPE_PROJCS,e.wkt2||e.wkt);c.h.projToGeog(t,r.length,r)}if(null!=o&&o.steps.length){let t;const e=179.9955;if(n.isGeographic&&(t=r.map(t=>{let[n]=t;return n>e?1:n<-e?-1:0})),o.steps.forEach(t=>{const e=t.wkid?c.P.geogtran(t.wkid):c.P.fromString(c.a.PE_TYPE_GEOGTRAN,t.wkt);c.j.geogToGeog(e,r.length,r,null,t.isInverse?c.a.PE_TRANSFORM_2_TO_1:c.a.PE_TRANSFORM_1_TO_2)}),t)for(let n=0;n<r.length;n++){const o=t[n],i=r[n][0],s=i>e?1:i<-e?-1:0;o&&s&&o!==s&&(r[n][0]=o>0?i+360:i-360)}}if(!n.isGeographic){const t=D(n,!0),e=null!=t&&t.isEnvelope?[t.bbox[1],t.bbox[3]]:[-90,90];!function(t,e){const[n,o]=e;for(let i=0;i<t.length;i++){const e=t[i][1];(e<n||e>o)&&(t[i]=[NaN,NaN])}}(r,e);const o=n.wkid?c.P.coordsys(n.wkid):c.P.fromString(n.isGeographic?c.a.PE_TYPE_GEOGCS:c.a.PE_TYPE_PROJCS,n.wkt2||n.wkt);c.h.geogToProj(o,r.length,r)}let l=r;if(s&&r.length!==s.length){l=[];for(let t=0,e=0;t<s.length;t++)s[t]?l.push(r[e++]):l.push([NaN,NaN])}return l}function D(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.wkid||t.wkt2||t.wkt;if(!n||t.isGeographic)return null;if(n=String(n),v.has(n)){const t=v.get(n);return e?null===t||void 0===t?void 0:t.gcs:null===t||void 0===t?void 0:t.pcs}const o=t.wkid?c.P.coordsys(t.wkid):c.P.fromString(t.isGeographic?c.a.PE_TYPE_GEOGCS:c.a.PE_TYPE_PROJCS,t.wkt2||t.wkt),i=j(o,O(t,1e-4)),r=j(o,0,!0);return v.set(n,{pcs:i,gcs:r}),e?r:i}function j(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o=c.g.generate(t),i=n?t.horizonGcsGenerate():t.horizonPcsGenerate();if(!o||null===i||void 0===i||!i.length)return null;let r=!1,s=i.find(t=>1===t.getInclusive()&&1===t.getKind());if(!s){if(s=i.find(t=>1===t.getInclusive()&&0===t.getKind()),!s)return null;r=!0}const l=n?0:(2===o.getNorthPoleLocation()?1:0)|(2===o.getSouthPoleLocation()?2:0),a=o.isPannableRectangle(),f=s.getCoord();if(r)return{isEnvelope:r,isPannable:a,vertices:f,coef:null,bbox:[f[0][0]-e,f[0][1]-e,f[1][0]+e,f[1][1]+e],poleLocation:l};let u=0;const h=[];let[m,x]=f[0],[p,d]=f[0];for(let c=0,g=f.length;c<g;c++){u++,u===g&&(u=0);const[t,e]=f[c],[n,o]=f[u];if(o===e)h.push([t,n,e,o,2]);else{const i=(n-t)/(o-e||1e-4),r=t-i*e;e<o?h.push([i,r,e,o,0]):h.push([i,r,o,e,1])}m=m<t?m:t,x=x<e?x:e,p=p>t?p:t,d=d>e?d:e}return{isEnvelope:!1,isPannable:a,vertices:f,coef:h,bbox:[m,x,p,d],poleLocation:l}}function B(t,e){const n=[],{cols:o,rows:i,xres:r,yres:s,usePixelCenter:l}=t;let{xmin:a,ymax:c}=t;if(l&&(a+=r/2,c-=s/2),null==e){for(let t=0;t<o;t++)for(let e=0;e<i;e++)n.push([a+r*t,c-s*e]);return{points:n}}const f=new Uint8Array(o*i);if(e.isEnvelope){const{bbox:[t,l,u,h]}=e;for(let m=0,x=0;m<o;m++){const o=a+r*m,p=e.isPannable||o>=t&&o<=u;for(let t=0;t<i;t++,x++){const e=c-s*t;p&&e>=l&&e<=h&&(n.push([o,e]),f[x]=1)}}return{points:n,mask:f}}const u=e.coef,h=[];for(let m=0;m<i;m++){const t=c-s*m,e=[],n=[];for(let i=0;i<u.length;i++){const[o,r,s,l,a]=u[i];if(t===s&&s===l)e.push(o),e.push(r),n.push(2),n.push(2);else if(t>=s&&t<=l){const i=o*t+r;e.push(i),n.push(a)}}let o=e;if(e.length>2){let t=2===n[0]?0:n[0],i=e[0];o=[];for(let r=1;r<n.length;r++)2===n[r]&&r!==n.length-1||(n[r]!==t&&(o.push(0===t?Math.min(i,e[r-1]):Math.max(i,e[r-1])),t=n[r],i=e[r]),r===n.length-1&&o.push(0===n[r]?Math.min(i,e[r]):Math.max(i,e[r])));o.sort((t,e)=>t-e)}else e[0]>e[1]&&(o=[e[1],e[0]]);h.push(o)}for(let m=0,x=0;m<o;m++){const t=a+r*m;for(let e=0;e<i;e++,x++){const o=c-s*e,i=h[e];if(2===i.length)t>=i[0]&&t<=i[1]&&(n.push([t,o]),f[x]=1);else if(i.length>2){let e=!1;for(let n=0;n<i.length;n+=2)if(t>=i[n]&&t<=i[n+1]){e=!0;break}e&&(n.push([t,o]),f[x]=1)}}}return{points:n,mask:f}}function U(t,e){const n=H(t[0].spatialReference);if(t.length<2||null==n)return t[0];if(e=null!==e&&void 0!==e?e:O(t[0].spatialReference),1===(t=t.filter(t=>t.width>e)).length)return t[0];let{xmin:o,xmax:i,ymin:r,ymax:s}=t[0];for(let l=1;l<t.length;l++){const e=t[l];i=e.xmax+n*l,r=Math.min(r,e.ymin),s=Math.max(s,e.ymax)}return new a.A({xmin:o,xmax:i,ymin:r,ymax:s,spatialReference:t[0].spatialReference})}function Y(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const r=t.spatialReference;if(r.equals(e)||!e)return t;const s=Q(t),l=H(r,!0),c=H(e);if(0===s||null==l||null==c){const i=X(t,e,n,o);if(i&&null==l&&null!=c&&Math.abs(i.width-c)<O(e)&&S.isLoaded()){const n=D(r);if(null!=n&&0===n.poleLocation&&t.width<(n.bbox[2]-n.bbox[0])/2)return function(t,e){const n=H(e);if(null==n)return null;let{xmin:o,ymin:i,xmax:r,ymax:s}=t;const l=t.spatialReference,c=new u.A({spatialReference:l,rings:[[[o,i],[r,i],[r,s],[o,s],[o,i]]]}),f=S.execute(c,e);if(2!==f.rings.length||!f.rings[0].length||!f.rings[1].length)return null;const{rings:h}=f,m=O(l),x=new a.A({spatialReference:e});for(let a=0;a<2;a++){o=r=h[a][0][0],i=s=h[a][0][1];for(let t=0;t<h[a].length;t++)o=o>h[a][t][0]?h[a][t][0]:o,r=r<h[a][t][0]?h[a][t][0]:r,i=i>h[a][t][1]?h[a][t][1]:i,s=s<h[a][t][1]?h[a][t][1]:s;if(0===a)x.ymin=i,x.ymax=s,x.xmin=o,x.xmax=r;else if(x.ymin=Math.min(x.ymin,i),x.ymax=Math.max(x.ymax,s),Math.abs(r-n/2)<m)x.xmin=o,x.xmax=x.xmax+n;else{if(!(Math.abs(o+n/2)<m))return null;x.xmax=r+n}}return x}(t,e)||i}return i}const f=t.clone().normalize();if(1===f.length&&t.xmax<l&&t.xmax-l/2>O(r)){const{xmin:e,xmax:n}=t;for(let o=0;o<=s;o++){const i=0===o?e:-l/2,c=o===s?n-l*o:l/2;f[o]=new a.A({xmin:i,xmax:c,ymin:t.ymin,ymax:t.ymax,spatialReference:r})}}const h=f.map(t=>X(t,e,n,o)).filter(i.Ru);return 0===h.length?null:U(h)}function J(t,e,n){if("extent"===t.type){const{xmin:e,ymin:n,xmax:o,ymax:i,spatialReference:r}=t;t=new u.A({rings:[[[e,i],[o,i],[o,n],[e,n],[e,i]]],spatialReference:r})}return t.spatialReference.equals(e)?t:(p(),S.execute(t,e,{geographicTransformation:n}))}function X(t,e,n){let o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];const r=t.spatialReference;if(r.equals(e)||!e)return t;p();const s=S.execute(t,e,{geographicTransformation:n});if(i&&e.isWebMercator&&s&&(s.ymax=Math.min(20037508.342787,s.ymax),s.ymin=Math.max(-20037508.342787,s.ymin),s.ymin>=s.ymax))return null;if(!o||!s)return s;const l=K(r,!0),a=K(e,!0);if(null==l||null==a)return s;const c=O(r,.001),u=O(r,P),h=O(e,.001);if(Math.abs(s.xmin-a[0])<h&&Math.abs(s.xmax-a[1])<h){const o=Math.abs(t.xmin-l[0]),i=Math.abs(l[1]-t.xmax);if(o<c&&i>u){s.xmin=a[0];const o=[];o.push(new f.A(t.xmax,t.ymin,r)),o.push(new f.A(t.xmax,(t.ymin+t.ymax)/2,r)),o.push(new f.A(t.xmax,t.ymax,r));const i=o.map(t=>V(t,e,n)).filter(t=>!isNaN(null===t||void 0===t?void 0:t.x)).map(t=>t.x);s.xmax=Math.max.apply(null,i)}if(i<c&&o>u){s.xmax=a[1];const o=[];o.push(new f.A(t.xmin,t.ymin,r)),o.push(new f.A(t.xmin,(t.ymin+t.ymax)/2,r)),o.push(new f.A(t.xmin,t.ymax,r));const i=o.map(t=>V(t,e,n)).filter(t=>!isNaN(null===t||void 0===t?void 0:t.x)).map(t=>t.x);s.xmin=Math.min.apply(null,i)}}else{const t=O(e,.001);Math.abs(s.xmin-a[0])<t&&(s.xmin=a[0]),Math.abs(s.xmax-a[1])<t&&(s.xmax=a[1])}return s}function H(t){if(!t)return null;const e=arguments.length>1&&void 0!==arguments[1]&&arguments[1]?20037508.342787:20037508.342788905;return t.isWebMercator?2*e:t.wkid&&t.isGeographic?360:2*g[t.wkid]||null}function K(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t.isGeographic)return[-180,180];const n=H(t,e);return null!=n?[-n/2,n/2]:null}function $(t,e,n,o){let i=(t-e)/n;return i-Math.floor(i)!==0?i=Math.floor(i):o&&(i-=1),i}function Q(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=H(t.spatialReference);if(null==n)return 0;const o=e?0:-n/2,i=O(t.spatialReference),r=!e&&Math.abs(t.xmax-n/2)<i?n/2:t.xmax,s=!e&&Math.abs(t.xmin+n/2)<i?-n/2:t.xmin;return $(r,o,n,!0)-$(s,o,n,!1)}function Z(t){const e=t.storageInfo.origin.x,n=H(t.spatialReference,!0);if(null==n)return{originX:e,halfWorldWidth:null,pyramidsInfo:null};const o=n/2,{nativePixelSize:i,storageInfo:r,extent:s}=t,{maximumPyramidLevel:l,blockWidth:a,pyramidScalingFactor:c}=r;let f=i.x;const u=[],h=null!=t.transform&&"gcs-shift"===t.transform.type,m=e+(h?0:o),x=h?n-e:o-e;for(let p=0;p<=l;p++){const t=(s.xmax-e)/f/a,n=t-Math.floor(t)===0?t:Math.ceil(t),o=x/f/a,i=o-Math.floor(o)===0?o:Math.ceil(o),r=Math.floor(m/f/a),l=Math.round(m/f)%a,h=(a-Math.round(x/f)%a)%a;u.push({resolutionX:f,blockWidth:a,datasetColumnCount:n,worldColumnCountFromOrigin:i,leftMargin:l,rightPadding:h,originColumnOffset:r}),f*=c}return{originX:e,halfWorldWidth:o,pyramidsInfo:u,hasGCSSShiftTransform:h}}function tt(t){const e=t.isAdaptive&&null==t.spacing;let n=t.spacing||[w,w],i=et(t),r={cols:i.size[0]+1,rows:i.size[1]+1};const s=i.outofBoundPointCount>0&&i.outofBoundPointCount<i.offsets.length/2;let l=i.outofBoundPointCount===i.offsets.length/2||e&&s?[0,0]:d(i.offsets,r,n,M);const a=(l[0]+l[1])/2,f=t.projectedExtent.spatialReference,u=t.srcBufferExtent.spatialReference;if(e&&(s||a>M)&&(f.isGeographic||D(f),n=[y,y],i=et((0,o.A)((0,o.A)({},t),{},{spacing:n})),r={cols:i.size[0]+1,rows:i.size[1]+1},l=d(i.offsets,r,n,M)),i.error=l,n[0]>1&&(i.coefficients=nt(i.offsets,r,s)),t.includeGCSGrid&&!f.isGeographic&&!f.isWebMercator)if(u.isGeographic)i.gcsGrid={offsets:i.offsets,coefficients:i.coefficients,spacing:n};else{const e=D(f);if(null!=e&&!e.isEnvelope){const e=function(t){if(!t||t.isGeographic)return t;const e=String(t.wkid||t.wkt2||t.wkt);let n;return A.has(e)?n=A.get(e):(n=(t.wkid?c.P.coordsys(t.wkid):c.P.fromString(c.a.PE_TYPE_PROJCS,t.wkt2||t.wkt)).getGeogcs().getCode(),A.set(e,n)),new m.A({wkid:n})}(f),l=Y(t.projectedExtent,e),{offsets:a}=et((0,o.A)((0,o.A)({},t),{},{srcBufferExtent:l,spacing:n})),u=nt(a,r,s);i.gcsGrid={offsets:a,coefficients:u,spacing:n}}}return i}function et(t){const{projectedExtent:e,srcBufferExtent:n,pixelSize:o,datumTransformation:i,rasterTransform:r}=t,s=e.spatialReference,l=n.spatialReference;p();const{xmin:a,ymin:c,xmax:u,ymax:h}=e,m=H(l),x=null!=m&&(t.hasWrapAround||"gcs-shift"===(null===r||void 0===r?void 0:r.type)),d=t.spacing||[w,w],g=d[0]*o.x,M=d[1]*o.y,v=1===d[0],A=Math.ceil((u-a)/g-.1/d[0])+(v?0:1),R=Math.ceil((h-c)/M-.1/d[1])+(v?0:1),b=q({cols:A,rows:R,xmin:a,ymax:h,xres:g,yres:M,inSR:s,outSR:l,datumTransformation:i,preferPE:d[0]<=y,usePixelCenter:v}),k=[];let S,G=0;const T=v?-1:NaN,{xmin:E,xmax:I,ymax:N,width:_,height:F}=n,L=O(l,P),C=null!=m&&E>0&&I>m/2,V=D(s),W=null!=V&&V.poleLocation>0;for(let p=0;p<A;p++){const t=[];for(let e=0;e<R;e++){let n=b[p*R+e];if(x&&n[0]>I&&n[0]>m/2-L?n[0]-=m:x&&0===p&&n[0]<0&&C&&!r&&(n[0]+=m),!n||isNaN(n[0])||isNaN(n[1]))k.push(T),k.push(T),t.push(null),G++;else{if(r){const t=r.inverseTransform(new f.A({x:n[0],y:n[1],spatialReference:l}));n=[t.x,t.y]}t.push(n),p>0&&x&&S[e]&&n[0]<S[e][0]&&(n[0]+=m,W&&n[0]>I&&n[0]>m&&(n[0]-=m)),k.push((n[0]-E)/_),k.push((N-n[1])/F)}}S=t}return{offsets:k,error:null,coefficients:null,outofBoundPointCount:G,spacing:d,size:v?[A,R]:[A-1,R-1]}}function nt(t,e,n){const{cols:o,rows:i}=e,r=new Float32Array((o-1)*(i-1)*2*6),s=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),l=new Float32Array([-1,1,0,0,-1,1,1,0,0]);for(let a=0;a<o-1;a++){for(let e=0;e<i-1;e++){let n=a*i*2+2*e;const c=t[n],f=t[n+1],u=t[n+2],h=t[n+3];n+=2*i;const m=t[n],x=t[n+1],p=t[n+2],d=t[n+3];let g=0,w=12*(e*(o-1)+a);for(let t=0;t<3;t++)r[w++]=s[g++]*c+s[g++]*u+s[g++]*p;g=0;for(let t=0;t<3;t++)r[w++]=s[g++]*f+s[g++]*h+s[g++]*d;g=0;for(let t=0;t<3;t++)r[w++]=l[g++]*c+l[g++]*m+l[g++]*p;g=0;for(let t=0;t<3;t++)r[w++]=l[g++]*f+l[g++]*x+l[g++]*d}if(n)for(let t=0;t<r.length;t++)isNaN(r[t])&&(r[t]=-1)}return r}function ot(t){const{spatialReference:e}=t,n=(0,x.Vp)(e);if(!n)return t;const[o,i]=n.valid,r=i-o;let s=0;if(t.xmin<o){const e=o-t.xmin;s=Math.ceil(e/r)}else if(t.xmin>i){const e=t.xmin-i;s=-Math.ceil(e/r)}return new a.A({spatialReference:t.spatialReference,xmin:t.xmin+s*r,ymin:t.ymin,xmax:t.xmax+s*r,ymax:t.ymax})}function it(t,e,n){var o;const{storageInfo:i,pixelSize:r}=e;let s=0,a=!1;const{pyramidResolutions:c}=i,u="mixed"===(null===(o=i.tileInfo.format)||void 0===o?void 0:o.toLowerCase())?Math.max(1,Math.min(3,i.tileInfo.dpi/96)):1,h=(t.x+t.y)/2/u;if(null!=c&&c.length){const t=c[c.length-1],o=(t.x+t.y)/2,i=(r.x+r.y)/2;if(h<=i)s=0;else if(h>=o)s=c.length,a=h/o>8;else{let t,e=i;for(let o=1;o<=c.length;o++){if(t=(c[o-1].x+c[o-1].y)/2,h<=t){h===t?s=o:"down"===n?(s=o-1,a=h/e>8):s="up"===n||h-e>t-h||h/e>2?o:o-1;break}e=t}}const u=0===s?r:c[s-1];return a&&Math.min(u.x,u.y)*(0,l.GA)(e.spatialReference)>19567&&(a=!1),{pyramidLevel:s,pyramidResolution:new f.A({x:u.x,y:u.y,spatialReference:e.spatialReference}),excessiveReading:a}}const m=Math.log(t.x/r.x)/Math.LN2,x=Math.log(t.y/r.y)/Math.LN2,p=e.storageInfo.maximumPyramidLevel||0;s="down"===n?Math.floor(Math.min(m,x)):"up"===n?Math.ceil(Math.max(m,x)):Math.round((m+x)/2),s<0?s=0:s>p&&(a=s>p+3,s=p);const d=2**s;return{pyramidLevel:s,pyramidResolution:new f.A({x:d*e.nativePixelSize.x,y:d*e.nativePixelSize.y,spatialReference:e.spatialReference}),excessiveReading:a}}function rt(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{pixelSize:o,extent:i}=t,r=I(i,e,!1),s=Y(function(t,e){const n=t.clone().normalize();return 1===n.length?n[0]:U(n,e)}(i,(o.x+o.y)/16),e,r);return!s||n||0===Q(s)?s:X(i,e,r)}}}]);
//# sourceMappingURL=418.efa23857.chunk.js.map