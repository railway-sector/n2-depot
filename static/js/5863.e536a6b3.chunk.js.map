{"version":3,"file":"static/js/5863.e536a6b3.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/views/3d/layers/graphics/StreamController.js","../node_modules/@arcgis/core/views/3d/layers/graphics/StreamGraphics3DGraphicsPipeline.js","../node_modules/@arcgis/core/views/layers/StreamLayerView.js","../node_modules/@arcgis/core/views/3d/layers/StreamLayerView3D.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as e}from\"tslib\";import t from\"../../../../Graphic.js\";import s from\"../../../../core/Accessor.js\";import{makeHandle as r}from\"../../../../core/handleUtils.js\";import{destroyMaybe as i}from\"../../../../core/maybe.js\";import{EsriPromiseMixin as o}from\"../../../../core/Promise.js\";import{watch as a,initial as n}from\"../../../../core/reactiveUtils.js\";import{property as c}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/has.js\";import\"../../../../core/Logger.js\";import\"../../../../core/RandomLCG.js\";import{subclass as d}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{featureGeometryTypeKebabDictionary as p}from\"../../../../geometry/support/typeUtils.js\";import{StreamFeatureManager as h}from\"../../../../layers/graphics/data/StreamFeatureManager.js\";import{createConnection as l}from\"../../../../layers/graphics/sources/connections/createConnection.js\";import{EventedSet as u}from\"../../support/EventedSet.js\";import{TaskPriority as m}from\"../../../support/Scheduler.js\";import{Yield as y}from\"../../../support/Yield.js\";const g=2500;let f=class extends t{constructor(e){super(e)}getObjectId(){return this.objectId}};e([c({type:Number,json:{read:!0}})],f.prototype,\"objectId\",void 0),f=e([d(\"esri.views.3d.layers.graphics.StreamController.StreamGraphic\")],f);class _{constructor(e){this.onUpdate=e,this._idToGraphic=new Map}destroy(){this._idToGraphic.clear()}add(e){this._idToGraphic.set(e.objectId,e)}get(e){return this._idToGraphic.get(e)}forEach(e){this._idToGraphic.forEach(e)}removeById(e){const t=this._idToGraphic.get(e);return t?(t.sourceLayer=t.layer=t.origin=null,this._idToGraphic.delete(e),t):null}update(e,t){this.onUpdate(e,t)}get size(){return this._idToGraphic.size}}const v=Symbol(\"startup-watches\"),R=Symbol(\"update-interval\");let j=class extends(o(s)){constructor(){super(...arguments),this.isPaused=!1,this.graphics=new u,this._updateInfo={websocket:0,client:0},this._updateRequested=!1,this._lastUpdateRateTime=0,this._outSpatialReference=null}initialize(){this.addResolvingPromise(this.layer.when(()=>this._startup()))}destroy(){this.clear()}clear(){this._shutdown(),this.graphics.clear()}get updating(){return!this.connection||this.readyToRun}get readyToRun(){return!this.isPaused&&null!=this.connection&&this._updateRequested}get _graphicOrigin(){return this.layer.graphicOrigin}runTask(){if(this._updateRequested=!1,this._emitUpdateRate(),!this.featuresManager.checkForUpdates())return y}_emitUpdateRate(){const e=performance.now(),t=e-this._lastUpdateRateTime;if(t<g)return;this._lastUpdateRateTime=e;const s=Math.round(this._updateInfo.client/(t/1e3)),r=Math.round(this._updateInfo.websocket/(t/1e3));this._updateInfo.client=0,this._updateInfo.websocket=0,this.layerView.emit(\"update-rate\",{client:s,websocket:r})}_shutdown(){this.connection=i(this.connection),this.store=i(this.store),this.removeAllHandles()}_startup(){const{layer:e,layerView:t}=this,{spatialReference:s,definitionExpression:i,geometryDefinition:o,timeInfo:c,purgeOptions:d,maxReconnectionAttempts:u,maxReconnectionInterval:y,customParameters:g}=e,f=e.geometryType?p.toJSON(e.geometryType):null,j=s,w=t.view.spatialReference,b={type:\"object-id\",fieldName:e.objectIdField};this.clear(),this._set(\"connection\",l(e.parsedUrl,j,w,f,i,o,u,y,g??void 0)),this._outSpatialReference=w.toJSON(),this.store=new _(this._onUpdate.bind(this)),this.featuresManager=new h(this.store,b,c.toJSON(),d),this.removeHandles(v),this.removeHandles(R),this.addHandles([e.on(\"send-message-to-socket\",e=>this.connection.sendMessageToSocket(e)),e.on(\"send-message-to-client\",e=>this.connection.sendMessageToClient(e)),this.connection.on(\"data-received\",e=>this._onFeature(e)),this.connection.on(\"message-received\",e=>this._onWebSocketMessage(e)),a(()=>[e.definitionExpression,e.geometryDefinition,e.purgeOptions],()=>this._startup()),a(()=>this.isPaused?null:this.layer.updateInterval,e=>{if(this.removeHandles(R),null==e)return;const t=setInterval(()=>{this._updateRequested=!0},e);this.addHandles(r(()=>clearInterval(t)),R)},n),this.layerView.view.resourceController.scheduler.registerTask(m.STREAM_CONTROLLER,this)],v),this._updateRequested=!0}_onWebSocketMessage(e){if(this.layerView.emit(\"message-received\",e),\"type\"in e)switch(e.type){case\"delete\":if(e.objectIds)for(const t of e.objectIds)this.featuresManager.removeById(t);if(e.trackIds)for(const t of e.trackIds)this.featuresManager.removeByTrackId(t);break;case\"clear\":this.store.forEach(e=>this.featuresManager.removeById(e.objectId))}}_onFeature(e){this._updateInfo.websocket++,this.layerView.hasEventListener(\"data-received\")&&this.layerView.emit(\"data-received\",{attributes:e.attributes,centroid:e.centroid,geometry:e.geometry});try{null==e.geometry||e.geometry.spatialReference||(e.geometry.spatialReference=this._outSpatialReference);const t=f.fromJSON(e);t.sourceLayer=t.layer=this.layer,t.origin=this._graphicOrigin,this.featuresManager.add(t)}catch{}}_onUpdate(e,t){null!=t&&this.graphics.removeMany(t),null!=e&&(this._updateInfo.client+=e.length,this.graphics.addMany(e))}pauseStream(){this.isPaused=!0}resumeStream(){this.isPaused=!1}disconnect(){this._shutdown()}connect(){null==this.connection&&this._startup()}clearGraphics(){this.graphics.clear()}};e([c()],j.prototype,\"isPaused\",void 0),e([c({constructOnly:!0})],j.prototype,\"layer\",void 0),e([c({constructOnly:!0})],j.prototype,\"layerView\",void 0),e([c()],j.prototype,\"connection\",void 0),e([c({readOnly:!0})],j.prototype,\"updating\",null),e([c()],j.prototype,\"readyToRun\",null),e([c()],j.prototype,\"_updateRequested\",void 0),e([c()],j.prototype,\"_graphicOrigin\",null),j=e([d(\"esri.views.3d.layers.graphics.StreamController\")],j);export{j as StreamController,f as StreamGraphic};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as r}from\"tslib\";import{property as e}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/has.js\";import\"../../../../core/Logger.js\";import\"../../../../core/RandomLCG.js\";import{subclass as o}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{Graphics3DGraphicsPipeline as t}from\"./Graphics3DGraphicsPipeline.js\";import{StreamController as s}from\"./StreamController.js\";let c=class extends t{constructor(r){super(r),this.suspendResumeExtentMode=\"computed\"}get connection(){return this.controller?.connection}createController(){return new s({layer:this.layer,layerView:this.layerView})}beforeSetController(){}pause(){this.controller?.pauseStream()}resume(){this.controller?.resumeStream()}disconnect(){this.controller?.disconnect()}connect(){this.controller?.connect()}clear(){this.controller?.clearGraphics()}};r([e()],c.prototype,\"controller\",void 0),r([e()],c.prototype,\"connection\",null),r([e()],c.prototype,\"suspendResumeExtentMode\",void 0),c=r([o(\"esri.views.3d.layers.graphics.StreamGraphics3DGraphicsPipeline\")],c);export{c as StreamGraphics3DGraphicsPipeline};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as s}from\"tslib\";import{property as e}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/RandomLCG.js\";import{subclass as t}from\"../../core/accessorSupport/decorators/subclass.js\";import o from\"../../layers/support/FeatureFilter.js\";const r=r=>{const i=r;let n=class extends i{resume(){this._isUserPaused=!1,this.suspended||this._doResume()}pause(){this._isUserPaused=!0,this.suspended||this._doPause()}disconnect(){this._doDisconnect()}connect(){this._doConnect()}clear(){this._doClear()}constructor(...s){super(...s),this._isUserPaused=!1,this.filter=null}get connectionStatus(){return(this._isUserPaused||this.suspended)&&\"connected\"===this._streamConnectionStatus?\"paused\":this._streamConnectionStatus}_onSuspendedChange(s){s?this._doPause():this._isUserPaused||this._doResume()}};return s([e()],n.prototype,\"_isUserPaused\",void 0),s([e({readOnly:!0})],n.prototype,\"connectionStatus\",null),s([e({type:o})],n.prototype,\"filter\",void 0),n=s([t(\"esri.views.layers.StreamLayerView\")],n),n};export{r as StreamLayerView};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as e}from\"tslib\";import r from\"../../../core/Error.js\";import{watch as t}from\"../../../core/reactiveUtils.js\";import{property as i}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/Logger.js\";import\"../../../core/RandomLCG.js\";import{subclass as s}from\"../../../core/accessorSupport/decorators/subclass.js\";import o from\"../../../rest/support/Query.js\";import{isNumber as a}from\"../../../support/guards.js\";import{FeatureLikeLayerView3D as n}from\"./FeatureLikeLayerView3D.js\";import{LayerView3D as p}from\"./LayerView3D.js\";import{StreamController as c}from\"./graphics/StreamController.js\";import{StreamGraphics3DGraphicsPipeline as l}from\"./graphics/StreamGraphics3DGraphicsPipeline.js\";import u from\"../../layers/LayerView.js\";import{StreamLayerView as h}from\"../../layers/StreamLayerView.js\";let m=class extends(h(n(p(u)))){constructor(){super(...arguments),this.type=\"stream-3d\",this.updatePolicy=0,this.hasZ=!0,this.hasM=!1,this.featureEffect=null}initialize(){this.addHandles(t(()=>this.suspended,e=>{this.graphicsPipeline&&this._onSuspendedChange(e)}))}get connectionError(){const e=this.graphicsPipeline?.connection?.errorString;return e?new r(\"stream-controller\",e):null}get graphicOrigin(){return this.layer.graphicOrigin}createQuery(){return new o({outFields:[\"*\"],returnGeometry:!0,outSpatialReference:this.view.spatialReference})}queryLatestObservations(e,r){return this.graphicsPipeline.graphicsQuery.executeQueryForLatestObservations(this._ensureQuery(e),r?.signal)}async queryObjectIds(e,r){return(await super.queryObjectIds(e,r)).filter(a)}get _streamConnectionStatus(){return this.graphicsPipeline?.connection?.connectionStatus??\"disconnected\"}async createGraphicsPipeline(){return new l({layerView:this})}createController(){return new c({layer:this.layer,layerView:this})}beforeSetController(){}_doPause(){this.graphicsPipeline?.pause()}_doResume(){this.graphicsPipeline?.resume()}_doDisconnect(){this.graphicsPipeline?.disconnect(),this._doPause()}_doConnect(){this.graphicsPipeline?.connect(),this.resume()}_doClear(){this.graphicsPipeline?.clear()}};e([i({readOnly:!0})],m.prototype,\"updatePolicy\",void 0),e([i({readOnly:!0})],m.prototype,\"connectionError\",null),e([i()],m.prototype,\"graphicsPipeline\",void 0),e([i({readOnly:!0})],m.prototype,\"hasZ\",void 0),e([i({readOnly:!0})],m.prototype,\"hasM\",void 0),e([i()],m.prototype,\"featureEffect\",void 0),e([i()],m.prototype,\"graphicOrigin\",null),e([i({readOnly:!0})],m.prototype,\"_streamConnectionStatus\",null),m=e([s(\"esri.views.3d.layers.StreamLayerView3D\")],m);const y=m;export{y as default};\n"],"names":["f","t","constructor","e","super","getObjectId","this","objectId","c","type","Number","json","read","prototype","d","_","onUpdate","_idToGraphic","Map","destroy","clear","add","set","get","forEach","removeById","sourceLayer","layer","origin","delete","update","size","v","Symbol","R","j","o","s","arguments","isPaused","graphics","u","_updateInfo","websocket","client","_updateRequested","_lastUpdateRateTime","_outSpatialReference","initialize","addResolvingPromise","when","_startup","_shutdown","updating","connection","readyToRun","_graphicOrigin","graphicOrigin","runTask","_emitUpdateRate","featuresManager","checkForUpdates","y","performance","now","Math","round","r","layerView","emit","i","store","removeAllHandles","spatialReference","definitionExpression","geometryDefinition","timeInfo","purgeOptions","maxReconnectionAttempts","maxReconnectionInterval","customParameters","g","geometryType","p","toJSON","w","view","b","fieldName","objectIdField","_set","l","parsedUrl","_onUpdate","bind","h","removeHandles","addHandles","on","sendMessageToSocket","sendMessageToClient","_onFeature","_onWebSocketMessage","a","updateInterval","setInterval","clearInterval","n","resourceController","scheduler","registerTask","m","STREAM_CONTROLLER","objectIds","trackIds","removeByTrackId","hasEventListener","attributes","centroid","geometry","fromJSON","_unused","removeMany","length","addMany","pauseStream","resumeStream","disconnect","connect","clearGraphics","constructOnly","readOnly","suspendResumeExtentMode","_this$controller","controller","createController","beforeSetController","pause","_this$controller2","resume","_this$controller3","_this$controller4","_this$controller5","_this$controller6","_isUserPaused","suspended","_doResume","_doPause","_doDisconnect","_doConnect","_doClear","filter","connectionStatus","_streamConnectionStatus","_onSuspendedChange","updatePolicy","hasZ","hasM","featureEffect","graphicsPipeline","connectionError","_this$graphicsPipelin","errorString","createQuery","outFields","returnGeometry","outSpatialReference","queryLatestObservations","graphicsQuery","executeQueryForLatestObservations","_ensureQuery","signal","queryObjectIds","_this$graphicsPipelin2","_this$graphicsPipelin3","createGraphicsPipeline","_this$graphicsPipelin4","_this$graphicsPipelin5","_this$graphicsPipelin6","_this$graphicsPipelin7","_this$graphicsPipelin8"],"sourceRoot":""}